/*!
 * The MIT License (MIT)
 * 
 * Copyright (c) 2016 Telerik AD
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.y distributed under the MIT license.
 * 
 * Everlive SDK 
 *     Version: 1.9.1
 *     Commit: 45f5b9cb96fcad6097f25f0a90ff0ec99c5ab1ed
 */
!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b(require("http"),function(){try{return require("application-settings")}catch(a){}}(),function(){try{return require("file-system")}catch(a){}}(),function(){try{return require("https")}catch(a){}}(),function(){try{return require("local-settings")}catch(a){}}(),function(){try{return require("nativescript-push-notifications")}catch(a){}}(),function(){try{return require("nativescript-sqlite")}catch(a){}}(),function(){try{return require("node-localstorage")}catch(a){}}(),function(){try{return require("platform")}catch(a){}}(),function(){try{return require("url")}catch(a){}}(),function(){try{return require("zlib")}catch(a){}}()):"function"==typeof define&&define.amd?define(["http","application-settings","file-system","https","local-settings","nativescript-push-notifications","nativescript-sqlite","node-localstorage","platform","url","zlib"],b):"object"==typeof exports?exports.Everlive=b(require("http"),function(){try{return require("application-settings")}catch(a){}}(),function(){try{return require("file-system")}catch(a){}}(),function(){try{return require("https")}catch(a){}}(),function(){try{return require("local-settings")}catch(a){}}(),function(){try{return require("nativescript-push-notifications")}catch(a){}}(),function(){try{return require("nativescript-sqlite")}catch(a){}}(),function(){try{return require("node-localstorage")}catch(a){}}(),function(){try{return require("platform")}catch(a){}}(),function(){try{return require("url")}catch(a){}}(),function(){try{return require("zlib")}catch(a){}}()):a.Everlive=b(a.http,a["application-settings"],a["file-system"],a.https,a["local-settings"],a["nativescript-push-notifications"],a["nativescript-sqlite"],a["node-localstorage"],a.platform,a.url,a.zlib)}(this,function(__WEBPACK_EXTERNAL_MODULE_139__,__WEBPACK_EXTERNAL_MODULE_212__,__WEBPACK_EXTERNAL_MODULE_213__,__WEBPACK_EXTERNAL_MODULE_214__,__WEBPACK_EXTERNAL_MODULE_215__,__WEBPACK_EXTERNAL_MODULE_216__,__WEBPACK_EXTERNAL_MODULE_217__,__WEBPACK_EXTERNAL_MODULE_218__,__WEBPACK_EXTERNAL_MODULE_219__,__WEBPACK_EXTERNAL_MODULE_220__,__WEBPACK_EXTERNAL_MODULE_221__){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}(function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))switch(typeof a[b]){case"function":break;case"object":a[b]=function(b){var c=b.slice(1),d=a[b[0]];return function(a,b,e){d.apply(this,[a,b,e].concat(c))}}(a[b]);break;default:a[b]=a[a[b]]}return a}([function(a,b,c){a.exports=c(151)},function(a,b){var c,d;
//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){function e(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=w(d,f,4);var g=!B(c)&&v.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function f(a){return function(b,c,d){c=x(c,d);for(var e=null!=b&&b.length,f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function g(a,b){var c=G.length,d=a.constructor,e=v.isFunction(d)&&d.prototype||k,f="constructor";for(v.has(a,f)&&!v.contains(b,f)&&b.push(f);c--;)f=G[c],f in a&&a[f]!==e[f]&&!v.contains(b,f)&&b.push(f)}var h=this,i=h._,j=Array.prototype,k=Object.prototype,l=Function.prototype,m=j.push,n=j.slice,o=k.toString,p=k.hasOwnProperty,q=Array.isArray,r=Object.keys,s=l.bind,t=Object.create,u=function(){},v=function(a){return a instanceof v?a:this instanceof v?void(this._wrapped=a):new v(a)};"undefined"!=typeof a&&a.exports&&(b=a.exports=v),b._=v,v.VERSION="1.8.2";var w=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},x=function(a,b,c){return null==a?v.identity:v.isFunction(a)?w(a,b,c):v.isObject(a)?v.matcher(a):v.property(a)};v.iteratee=function(a,b){return x(a,b,1/0)};var y=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},z=function(a){if(!v.isObject(a))return{};if(t)return t(a);u.prototype=a;var b=new u;return u.prototype=null,b},A=Math.pow(2,53)-1,B=function(a){var b=a&&a.length;return"number"==typeof b&&b>=0&&A>=b};v.each=v.forEach=function(a,b,c){b=w(b,c);var d,e;if(B(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=v.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},v.map=v.collect=function(a,b,c){b=x(b,c);for(var d=!B(a)&&v.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},v.reduce=v.foldl=v.inject=e(1),v.reduceRight=v.foldr=e(-1),v.find=v.detect=function(a,b,c){var d;return d=B(a)?v.findIndex(a,b,c):v.findKey(a,b,c),void 0!==d&&-1!==d?a[d]:void 0},v.filter=v.select=function(a,b,c){var d=[];return b=x(b,c),v.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},v.reject=function(a,b,c){return v.filter(a,v.negate(x(b)),c)},v.every=v.all=function(a,b,c){b=x(b,c);for(var d=!B(a)&&v.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},v.some=v.any=function(a,b,c){b=x(b,c);for(var d=!B(a)&&v.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},v.contains=v.includes=v.include=function(a,b,c){return B(a)||(a=v.values(a)),v.indexOf(a,b,"number"==typeof c&&c)>=0},v.invoke=function(a,b){var c=n.call(arguments,2),d=v.isFunction(b);return v.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},v.pluck=function(a,b){return v.map(a,v.property(b))},v.where=function(a,b){return v.filter(a,v.matcher(b))},v.findWhere=function(a,b){return v.find(a,v.matcher(b))},v.max=function(a,b,c){var d,e,f=-(1/0),g=-(1/0);if(null==b&&null!=a){a=B(a)?a:v.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=x(b,c),v.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-(1/0)&&f===-(1/0))&&(f=a,g=e)});return f},v.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=B(a)?a:v.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=x(b,c),v.each(a,function(a,c,d){e=b(a,c,d),(g>e||e===1/0&&f===1/0)&&(f=a,g=e)});return f},v.shuffle=function(a){for(var b,c=B(a)?a:v.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=v.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},v.sample=function(a,b,c){return null==b||c?(B(a)||(a=v.values(a)),a[v.random(a.length-1)]):v.shuffle(a).slice(0,Math.max(0,b))},v.sortBy=function(a,b,c){return b=x(b,c),v.pluck(v.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={};return c=x(c,d),v.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};v.groupBy=C(function(a,b,c){v.has(a,c)?a[c].push(b):a[c]=[b]}),v.indexBy=C(function(a,b,c){a[c]=b}),v.countBy=C(function(a,b,c){v.has(a,c)?a[c]++:a[c]=1}),v.toArray=function(a){return a?v.isArray(a)?n.call(a):B(a)?v.map(a,v.identity):v.values(a):[]},v.size=function(a){return null==a?0:B(a)?a.length:v.keys(a).length},v.partition=function(a,b,c){b=x(b,c);var d=[],e=[];return v.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},v.first=v.head=v.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:v.initial(a,a.length-b)},v.initial=function(a,b,c){return n.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},v.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:v.rest(a,Math.max(0,a.length-b))},v.rest=v.tail=v.drop=function(a,b,c){return n.call(a,null==b||c?1:b)},v.compact=function(a){return v.filter(a,v.identity)};var D=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=a&&a.length;h>g;g++){var i=a[g];if(B(i)&&(v.isArray(i)||v.isArguments(i))){b||(i=D(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};v.flatten=function(a,b){return D(a,b,!1)},v.without=function(a){return v.difference(a,n.call(arguments,1))},v.uniq=v.unique=function(a,b,c,d){if(null==a)return[];v.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=x(c,d));for(var e=[],f=[],g=0,h=a.length;h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?v.contains(f,j)||(f.push(j),e.push(i)):v.contains(e,i)||e.push(i)}return e},v.union=function(){return v.uniq(D(arguments,!0,!0))},v.intersection=function(a){if(null==a)return[];for(var b=[],c=arguments.length,d=0,e=a.length;e>d;d++){var f=a[d];if(!v.contains(b,f)){for(var g=1;c>g&&v.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},v.difference=function(a){var b=D(arguments,!0,!0,1);return v.filter(a,function(a){return!v.contains(b,a)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(a){for(var b=a&&v.max(a,"length").length||0,c=Array(b),d=0;b>d;d++)c[d]=v.pluck(a,d);return c},v.object=function(a,b){for(var c={},d=0,e=a&&a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},v.indexOf=function(a,b,c){var d=0,e=a&&a.length;if("number"==typeof c)d=0>c?Math.max(0,e+c):c;else if(c&&e)return d=v.sortedIndex(a,b),a[d]===b?d:-1;if(b!==b)return v.findIndex(n.call(a,d),v.isNaN);for(;e>d;d++)if(a[d]===b)return d;return-1},v.lastIndexOf=function(a,b,c){var d=a?a.length:0;if("number"==typeof c&&(d=0>c?d+c+1:Math.min(d,c+1)),b!==b)return v.findLastIndex(n.call(a,0,d),v.isNaN);for(;--d>=0;)if(a[d]===b)return d;return-1},v.findIndex=f(1),v.findLastIndex=f(-1),v.sortedIndex=function(a,b,c,d){c=x(c,d,1);for(var e=c(b),f=0,g=a.length;g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},v.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var E=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=z(a.prototype),g=a.apply(f,e);return v.isObject(g)?g:f};v.bind=function(a,b){if(s&&a.bind===s)return s.apply(a,n.call(arguments,1));if(!v.isFunction(a))throw new TypeError("Bind must be called on a function");var c=n.call(arguments,2),d=function(){return E(a,d,b,this,c.concat(n.call(arguments)))};return d},v.partial=function(a){var b=n.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===v?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return E(a,c,this,this,f)};return c},v.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=v.bind(a[c],a);return a},v.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return v.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},v.delay=function(a,b){var c=n.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},v.defer=v.partial(v.delay,v,1),v.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:v.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=v.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},v.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=v.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=v.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},v.wrap=function(a,b){return v.partial(b,a)},v.negate=function(a){return function(){return!a.apply(this,arguments)}},v.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},v.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},v.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},v.once=v.partial(v.before,2);var F=!{toString:null}.propertyIsEnumerable("toString"),G=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];v.keys=function(a){if(!v.isObject(a))return[];if(r)return r(a);var b=[];for(var c in a)v.has(a,c)&&b.push(c);return F&&g(a,b),b},v.allKeys=function(a){if(!v.isObject(a))return[];var b=[];for(var c in a)b.push(c);return F&&g(a,b),b},v.values=function(a){for(var b=v.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},v.mapObject=function(a,b,c){b=x(b,c);for(var d,e=v.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},v.pairs=function(a){for(var b=v.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},v.invert=function(a){for(var b={},c=v.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},v.functions=v.methods=function(a){var b=[];for(var c in a)v.isFunction(a[c])&&b.push(c);return b.sort()},v.extend=y(v.allKeys),v.extendOwn=v.assign=y(v.keys),v.findKey=function(a,b,c){b=x(b,c);for(var d,e=v.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},v.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;v.isFunction(b)?(e=v.allKeys(g),d=w(b,c)):(e=D(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},v.omit=function(a,b,c){if(v.isFunction(b))b=v.negate(b);else{var d=v.map(D(arguments,!1,!1,1),String);b=function(a,b){return!v.contains(d,b)}}return v.pick(a,b,c)},v.defaults=y(v.allKeys,!0),v.clone=function(a){return v.isObject(a)?v.isArray(a)?a.slice():v.extend({},a):a},v.tap=function(a,b){return b(a),a},v.isMatch=function(a,b){var c=v.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var H=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof v&&(a=a._wrapped),b instanceof v&&(b=b._wrapped);var e=o.call(a);if(e!==o.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(v.isFunction(g)&&g instanceof g&&v.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if(i=a.length,i!==b.length)return!1;for(;i--;)if(!H(a[i],b[i],c,d))return!1}else{var j,k=v.keys(a);if(i=k.length,v.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!v.has(b,j)||!H(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};v.isEqual=function(a,b){return H(a,b)},v.isEmpty=function(a){return null==a?!0:B(a)&&(v.isArray(a)||v.isString(a)||v.isArguments(a))?0===a.length:0===v.keys(a).length},v.isElement=function(a){return!(!a||1!==a.nodeType)},v.isArray=q||function(a){return"[object Array]"===o.call(a)},v.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){v["is"+a]=function(b){return o.call(b)==="[object "+a+"]"}}),v.isArguments(arguments)||(v.isArguments=function(a){return v.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(v.isFunction=function(a){return"function"==typeof a||!1}),v.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},v.isNaN=function(a){return v.isNumber(a)&&a!==+a},v.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===o.call(a)},v.isNull=function(a){return null===a},v.isUndefined=function(a){return void 0===a},v.has=function(a,b){return null!=a&&p.call(a,b)},v.noConflict=function(){return h._=i,this},v.identity=function(a){return a},v.constant=function(a){return function(){return a}},v.noop=function(){},v.property=function(a){return function(b){return null==b?void 0:b[a]}},v.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},v.matcher=v.matches=function(a){return a=v.extendOwn({},a),function(b){return v.isMatch(b,a)}},v.times=function(a,b,c){var d=Array(Math.max(0,a));b=w(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},v.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},v.now=Date.now||function(){return(new Date).getTime()};var I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},J=v.invert(I),K=function(a){var b=function(b){return a[b]},c="(?:"+v.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};v.escape=K(I),v.unescape=K(J),v.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),v.isFunction(d)?d.call(a):d};var L=0;v.uniqueId=function(a){var b=++L+"";return a?a+b:b},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\u2028|\u2029/g,P=function(a){return"\\"+N[a]};v.template=function(a,b,c){!b&&c&&(b=c),b=v.defaults({},b,v.templateSettings);var d=RegExp([(b.escape||M).source,(b.interpolate||M).source,(b.evaluate||M).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(O,P),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(h){throw h.source=f,h}var i=function(a){return g.call(this,a,v)},j=b.variable||"obj";return i.source="function("+j+"){\n"+f+"}",i},v.chain=function(a){var b=v(a);return b._chain=!0,b};var Q=function(a,b){return a._chain?v(b).chain():b};v.mixin=function(a){v.each(v.functions(a),function(b){var c=v[b]=a[b];v.prototype[b]=function(){var a=[this._wrapped];return m.apply(a,arguments),Q(this,c.apply(v,a))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=j[a];v.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],Q(this,c)}}),v.each(["concat","join","slice"],function(a){var b=j[a];v.prototype[a]=function(){return Q(this,b.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},c=[],d=function(){return v}.apply(b,c),!(void 0!==d&&(a.exports=d))}).call(this)},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(8);b.DataQueryOperation=e.DataQueryOperation;var f=function(a){function b(){a.apply(this,arguments)}return d(b,a),b.idField="Id",b.guidEmpty="00000000-0000-0000-0000-000000000000",b.cloudFuncsEndpoint="Functions",b.sqlProceduresEndpoint="Invoke/SqlProcedures",b.everliveUrl="//api.everlive.com/v1/",b.DataQueryOperation=e.DataQueryOperation,b.ConflictResolutionStrategy={ClientWins:"clientWins",ServerWins:"serverWins",Custom:"custom"},b.ConflictResolution={KeepServer:"keepServer",KeepClient:"keepClient",Custom:"custom",Skip:"skip"},b.StorageProvider={LocalStorage:"localStorage",FileSystem:"fileSystem",SQLite:"sqlite",Custom:"custom"},b.DefaultStoragePath="el_store",b.DefaultFilesStoragePath="el_file_store",b.DefaultFilesMetadataPath="el_file_mapping",b.EncryptionProvider={Default:"default",Custom:"custom"},b.Headers={ContentType:"content-type",filter:"x-everlive-filter",select:"x-everlive-fields",sort:"x-everlive-sort",skip:"x-everlive-skip",take:"x-everlive-take",expand:"x-everlive-expand",singleField:"x-everlive-single-field",includeCount:"x-everlive-include-count",powerFields:"x-everlive-power-fields",debug:"x-everlive-debug",overrideSystemFields:"x-everlive-override-system-fields",sdk:"x-everlive-sdk",sync:"x-everlive-sync",aggregate:"x-everlive-aggregate",customParameters:"x-everlive-custom-parameters"},b.Platform={WindowsPhone:1,Windows:2,Android:3,iOS:4,OSX:5,Blackberry:6,Nokia:7,Unknown:100},b.OperatorType={query:1,where:100,filter:101,and:110,or:111,not:112,equal:120,not_equal:121,lt:122,lte:123,gt:124,gte:125,isin:126,notin:127,all:128,size:129,regex:130,contains:131,startsWith:132,endsWith:133,nearShpere:140,withinBox:141,withinPolygon:142,withinShpere:143,select:200,exclude:201,order:300,order_desc:301,skip:400,take:401,expand:402},b.AuthStatus={unauthenticated:"unauthenticated",masterKey:"masterKey",invalidAuthentication:"invalidAuthentication",authenticated:"authenticated",expiredAuthentication:"expiredAuthentication",authenticating:"authenticating"},b.offlineItemStates={created:"create",modified:"update",deleted:"delete"},b.HttpMethod={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"},b.maxDistanceConsts={radians:"$maxDistance",km:"$maxDistanceInKilometers",miles:"$maxDistanceInMiles"},b.radiusConsts={radians:"radius",km:"radiusInKilometers",miles:"radiusInMiles"},b.offlineItemsStateMarker="__everlive_offline_state",b.SyncErrors={generalError:"generalError",itemSyncError:"itemSyncError"},b.syncBatchSize=10,b.AuthStoreKey="__everlive_auth_key",b.CachingStoreKey="__everlive_cache",b.defaultSyncInterval=6e5,b.fileUploadKey="fileUpload",b.fileUploadDelimiter="_",b.FilesTypeNameLegacy="system.files",b.FilesTypeName="Files",b.MaxConcurrentDownloadTasks=3,b.DefaultFilesystemStorageQuota=10485760,b.Events={SyncStart:"syncStart",SyncEnd:"syncEnd",Processed:"processed",ItemProcessed:"itemProcessed",BeforeExecute:"beforeExecute"},b.Aggregation={MaxDocumentsCount:1e5},b.Push={NotificationsType:"Push/Notifications",DevicesType:"Push/Devices"},b.EncodableHeaders=[b.Headers.filter,b.Headers.expand,b.Headers.powerFields,b.Headers.customParameters],b.SqliteTypes={Text:"TEXT",Number:"INT",Float:"FLOAT"},b.SqliteUnsupportedTypes={ARRAY:"ARRAY",OBJECT:"OBJECT",DATE:"DATE",BOOLEAN:"BOOLEAN",NULL:"NULL"},b}(e.Constants);b.Constants=f},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(105),f=function(a){function b(){a.apply(this,arguments)}return d(b,a),b.itemNotFound={code:801,message:"Item not found."},b.syncConflict={code:10001,message:"A conflict occurred while syncing data."},b.syncError={code:10002,message:"Synchronization failed for item."},b.syncInProgress={code:10003,message:"Cannot perform operation while synchronization is in progress."},b.syncCancelledByUser={code:10004,message:"Synchronization cancelled by user."},b.syncErrorUnknown={code:10005,message:"An unknown error occurred while synchronizing. Please make sure there is internet connectivity."},b.operationNotSupportedOffline={code:2e4},b.invalidId={code:20001,message:"Invalid or missing Id in model."},b.bodyWithGetRequestNotSupported={code:601,message:'Sending a request body is not supported for "GET" requests.'},b.invalidOrMissingFunctionName={code:601,message:"Invalid or missing cloud function name."},b.invalidOrMissingProcedureName={code:601,message:"Invalid or missing procedure name."},b.generalDatabaseError={code:107,message:"General database error."},b.invalidToken={code:301,message:"Invalid access token."},b.expiredToken={code:302,message:"Expired access token."},b.invalidExpandExpression={code:618,message:"Invalid expand expression."},b.invalidRequest={code:601,message:"Invalid request."},b.queryCancelled={code:700,message:"Query cancelled."},b.missingContentType={code:701,message:"ContentType not specified."},b.missingOrInvalidFileContent={code:702,message:"Missing or invalid file content."},b.customFileSyncNotSupported={code:703,message:"Custom ConflictResolution for files is not allowed."},b.cannotDownloadOffline={code:704,message:"Cannot download a file while offline."},b.cannotForceCacheWhenDisabled={code:705,message:"Cannot use forceCache while the caching is disabled."},b.filesNotSupportedInBrowser={code:706,message:"Create and Update operations are not supported for Files in browsers while in offline mode."},b.pushNotSupportedOffline={code:707,message:"Push is not supported in offline mode."},b.noOfflineSupport={code:708,message:"You have instantiated the SDK without support for offline storage."},b.cacheDisabled={code:709},b.singleValueExpected={code:710},b}(e.Errors);b.EverliveErrors=f;var g=function(){function a(){}return a.buildCacheDisabledErrorMessage=function(a){return"Cannot use "+a+" while the caching is disabled."},a.buildSingleValueExpectedErrorMessage=function(a){return"A single value is expected in "+a+" query modifier."},a}();b.EverliveErrorHelper=g;var h=function(a){function b(b){a.call(this,b.message),this.name="EverliveError",this.message=b.message,this.code=b.code,this._err=new Error}return d(b,a),Object.defineProperty(b.prototype,"stack",{get:function(){return this._err.stack},enumerable:!0,configurable:!0}),b.prototype.toJSON=function(){return{name:this.name,message:this.message,code:this.code,stack:this.stack}},b}(Error);b.EverliveError=h,function(a){a[a.EverliveError=1]="EverliveError",a[a.PluginError=2]="PluginError"}(b.DeviceRegistrationErrorType||(b.DeviceRegistrationErrorType={}));var i=b.DeviceRegistrationErrorType,j=function(a){function b(b,c,d){a.call(this,{message:c,code:d&&d.code}),this.errorType=b,this.additionalInformation=d}return d(b,a),b.fromEverliveError=function(a){return new b(i.EverliveError,a.message,a)},b.fromPluginError=function(a){var c="A plugin error occurred";return a&&("string"==typeof a.error?c=a.error:"string"==typeof a.message&&(c=a.message)),new b(i.PluginError,c,a)},b}(h);b.DeviceRegistrationError=j},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(9),g=c(5),h=c(2),i=c(44),j=["$geoWithin","$geoIntersects","$near","$within","$nearSphere"],k=function(){function a(a){this.token=a}return a}();b.DeviceRegistrationResult=k;var l=function(a){function b(){a.apply(this,arguments)}return d(b,a),b.normalizeKeys=function(a){var b={};return e.each(a,function(a,c){var d=c.toLowerCase();b.hasOwnProperty(d)||(b[d]=a)}),b},b.buildAuthHeader=function(a,b){var c=null;return b&&b.authHeaders===!1?c:(a.token?c=(a.tokenType||"bearer")+" "+a.token:a.masterKey&&(c="masterkey "+a.masterKey),c?{authorization:c}:null)},b.buildUrl=function(a){var b="";return"string"==typeof a.scheme&&(b+=a.scheme+":"),b+=a.url,a.appId&&(b+=a.appId+"/"),b},b.getDbOperators=function(a,c){var d=[];if("string"==typeof a||"number"==typeof a)return d;var f=Object.keys(a||{});return e.each(f,function(e){0===e.indexOf("$")?d.push(e):"object"!=typeof a[e]||c||(d=d.concat(b.getDbOperators(a[e])))}),d},b.disableRequestCache=function(a,b){if("GET"===b){var c=(new Date).getTime(),d=a.indexOf("?")>-1?"&":"?";a+=d+"_el="+c}return a},b.getUnsupportedOperators=function(a){var c=b.getDbOperators(a);return e.intersection(c,j)},b.isQuerySupportedOffline=function(a){var c=a.getQueryParameters(),d=!e.isEmptyObject(c.expand),f=b.getUnsupportedOperators(c.filter),g=0!==f.length,h=d||g;return!h},b.b64toBlob=function(a,b,c){void 0===b&&(b=""),void 0===c&&(c=512);for(var d=atob(a),e=[],f=0;f<d.length;f+=c){for(var g=d.slice(f,f+c),h=new Array(g.length),i=0;i<g.length;i++)h[i]=g.charCodeAt(i);var j=new Uint8Array(h);e.push(j)}var k=new Blob(e,{type:b});return k},b.arrayBufferToBase64=function(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;d>e;e++)b+=String.fromCharCode(c[e]);return btoa(b)},b.transformPlatformPath=function(a){return a?(g.isWindowsPhone?"/"===a.charAt(0)&&"/"!==a.charAt(1)&&(a="/"+a):-1!==a.indexOf("file:/")&&-1===a.indexOf("file:///")&&(a=a.replace("file:/","file:///")),a):""},b._stringCompare=function(a,b){return a.toLowerCase()===b},b.startsWith=function(a,b){return 0===a.lastIndexOf(b,0)},b.endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)},b.joinPath=function(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];var d=[].slice.apply(a).map(function(a){return a||""}),e=f.join.apply(f,d);return b.transformPlatformPath(e)},b.getId=function(a){return a.Id||a._id||a.id},b._inAppBuilderSimulator=function(){return"undefined"!=typeof window&&window.navigator&&window.navigator.simulator},b.isValidId=function(a){var b="string"==typeof a&&""!==a,c="number"==typeof a&&!e.isNaN(a);return b||c},b.modelHasValidId=function(a){var c="object"==typeof a&&null!==a?a.Id:a;return b.isValidId(c)},b.callbackAndPromiseErrorResponse=function(a,c){return c=c||e.noop,c(a),b.rejectedPromise(a)},b.toQueryString=function(a){var b="",c=encodeURIComponent,d=function(a,d){b+=c(a)+"="+c(d)+"&"};if(e.isArray(a))for(var f=0;a&&f<a.length;f++)d(a[f].name,a[f].value);else for(var g in a)if(a.hasOwnProperty(g)){var h=a[g];if(e.isArray(h))for(f=0;f<h.length;f++)d(g,h[f]);else d(g,a[g])}return b.replace(/&$/,"").replace(/%20/g,"+")},b.lazyRequire=function(a,b){b=b||a;var d={};return Object.defineProperty(d,b,{get:function(){return c(206)(a)}}),d},b.promiseHash=function(a){return b._mapPromises(a,!0).then(function(a){var b={};return e.each(a,function(a,c){"fulfilled"===a.state&&(b[c]=a.value)}),Promise.resolve(b)},function(a){return Promise.reject(a)})},b.promiseHashSettled=function(a){return b._mapPromises(a)},b.promisesAllSettled=function(a){return b._mapPromises(a)},b._mapPromises=function(a,b){void 0===b&&(b=!1);var c=e.size(a),d=Array.isArray(a)?[]:{};return 0===c?Promise.resolve(d):new Promise(function(f,g){var h=!1,i=0,j=function(a,b,e){if(void 0===e&&(e=!1),!h){var g;g=e?{state:"rejected",reason:a}:{state:"fulfilled",value:a},d[b]=g,i++,i===c&&f(d)}};e.each(a,function(a,c){a.then(function(a){return j(a,c),Promise.resolve(a)},function(a){return b&&(g(a),h=!0),j(a,c,!0),Promise.reject(a)})})})},b.isOfflineStorageEnabled=function(a){var b=a.offlineStorage||a.offline;return b&&b.enabled!==!1},b.existsAndIsNotEmpty=function(a){return!!a&&e.size(a)>0},b.isContentType={files:function(a){return b._stringCompare(a,"files")},users:function(a){return b._stringCompare(a,"users")},pushNotifications:function(a){return b._stringCompare(a,h.Constants.Push.NotificationsType.toLowerCase())},pushDevices:function(a){return b._stringCompare(a,h.Constants.Push.DevicesType.toLowerCase())}},b.isElement={_isElement:function(a,c){var d=a;return"string"!=typeof d&&a instanceof HTMLElement&&(d=a.tagName),b._stringCompare(d,c)},image:function(a){return b.isElement._isElement(a,"img")},anchor:function(a){return b.isElement._isElement(a,"a")}},b}(i.Utils);b.Utils=l},function(a,b,c){"use strict";var d=Boolean("undefined"!=typeof android&&android&&android.widget&&android.widget.Button||"undefined"!=typeof UIButton&&UIButton);b.isNativeScript=d;var e;b.platform=e;var f=!1;b.isCordova=f;var g=!1;b.isWindowsPhone=g;var h=!1;b.isAndroid=h,"undefined"==typeof window||d||(b.isCordova=f=/^file:\/{3}[^\/]|x-wmapp/i.test(window.location.href)&&/ios|iphone|ipod|ipad|android|iemobile/i.test(navigator.userAgent),b.isWindowsPhone=g=f&&/iemobile/i.test(navigator.userAgent),b.isAndroid=h=f&&"android"===cordova.platformId);var i="object"==typeof b&&"undefined"==typeof window;b.isNodejs=i;var j=!0&&c(192);b.isRequirejs=j;var k=!d&&!f&&!i;b.isDesktop=k,d?b.platform=e="ns":i?b.platform=e="nodejs":k?b.platform=e="desktop":f&&(b.platform=e="cordova");var l=function(){return"undefined"!=typeof window&&window.navigator&&window.navigator.simulator};b.isInAppBuilderSimulator=l},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(19),f=c(2),g=c(74),h=c(22),i=c(43),j=f.Constants.OperatorType,k=function(a){function b(b,c,d,f,g,h){a.call(this),this.filter=b,this.fields=c,this.sort=d,this.toskip=f,this.totake=g,this.expandExpression=h,this.expr=new e.Expression(j.query)}return d(b,a),b.prototype.where=function(a){return a?this._simple(j.filter,[a]):new g.WhereQuery(this)},b.prototype.select=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this._simple(j.select,a)},b.prototype.order=function(a){return this._simple(j.order,[a])},b.prototype.orderDesc=function(a){return this._simple(j.order_desc,[a])},b.prototype.skip=function(a){return this._simple(j.skip,[a])},b.prototype.take=function(a){return this._simple(j.take,[a])},b.prototype.expand=function(a){return this._simple(j.expand,[a])},b.prototype.build=function(){return new h.QueryBuilder(this).build()},b.prototype._simple=function(a,b){var c=[].slice.call(b);return this.expr.addOperand(new e.Expression(a,c)),this},b}(i.Query);b.Query=k},function(a){function b(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function d(a){if(j===setTimeout)return setTimeout(a,0);if((j===b||!j)&&setTimeout)return j=setTimeout,setTimeout(a,0);try{return j(a,0)}catch(c){try{return j.call(null,a,0)}catch(c){return j.call(this,a,0)}}}function e(a){if(k===clearTimeout)return clearTimeout(a);if((k===c||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(a);try{return k(a)}catch(b){try{return k.call(null,a)}catch(b){return k.call(this,a)}}}function f(){o&&m&&(o=!1,m.length?n=m.concat(n):p=-1,n.length&&g())}function g(){if(!o){var a=d(f);o=!0;for(var b=n.length;b;){for(m=n,n=[];++p<b;)m&&m[p].run();p=-1,b=n.length}m=null,o=!1,e(a)}}function h(a,b){this.fun=a,this.array=b}function i(){}var j,k,l=a.exports={};!function(){try{j="function"==typeof setTimeout?setTimeout:b}catch(a){j=b}try{k="function"==typeof clearTimeout?clearTimeout:c}catch(a){k=c}}();var m,n=[],o=!1,p=-1;l.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];n.push(new h(a,b)),1!==n.length||o||d(g)},h.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=i,l.addListener=i,l.once=i,l.off=i,l.removeListener=i,l.removeAllListeners=i,l.emit=i,l.binding=function(){throw new Error("process.binding is not supported");

},l.cwd=function(){return"/"},l.chdir=function(){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(a,b){"use strict";!function(a){a[a.Read=0]="Read",a[a.Create=1]="Create",a[a.Update=2]="Update",a[a.Delete=3]="Delete",a[a.DeleteById=4]="DeleteById",a[a.ReadById=5]="ReadById",a[a.Count=6]="Count",a[a.RawUpdate=7]="RawUpdate",a[a.SetAcl=8]="SetAcl",a[a.SetOwner=9]="SetOwner",a[a.UpdateById=10]="UpdateById",a[a.UserLogin=11]="UserLogin",a[a.UserLogout=12]="UserLogout",a[a.UserChangePassword=13]="UserChangePassword",a[a.UserLoginWithProvider=14]="UserLoginWithProvider",a[a.UserLinkWithProvider=15]="UserLinkWithProvider",a[a.UserUnlinkFromProvider=16]="UserUnlinkFromProvider",a[a.UserResetPassword=17]="UserResetPassword",a[a.UserSetPassword=18]="UserSetPassword",a[a.FilesUpdateContent=19]="FilesUpdateContent",a[a.FilesGetDownloadUrlById=20]="FilesGetDownloadUrlById",a[a.Aggregate=21]="Aggregate",a[a.InvokeCloudFunction=22]="InvokeCloudFunction",a[a.InvokeStoredProcedure=23]="InvokeStoredProcedure"}(b.DataQueryOperation||(b.DataQueryOperation={}));var c=(b.DataQueryOperation,function(){function a(){}return a}());b.Constants=c},function(a,b,c){(function(a){// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
function c(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};b.resolve=function(){for(var b="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(b=g+"/"+b,e="/"===g.charAt(0))}return b=c(d(b.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+b||"."},b.normalize=function(a){var e=b.isAbsolute(a),f="/"===g(a,-1);return a=c(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},b.isAbsolute=function(a){return"/"===a.charAt(0)},b.join=function(){var a=Array.prototype.slice.call(arguments,0);return b.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},b.relative=function(a,c){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=b.resolve(a).substr(1),c=b.resolve(c).substr(1);for(var e=d(a.split("/")),f=d(c.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},b.sep="/",b.delimiter=":",b.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},b.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},b.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(b,c(7))},function(a,b,c){"use strict";var d=c(1),e=c(4),f=c(23),g=c(2),h=c(5),i=c(6),j=g.Constants.Headers,k=g.Constants.EncodableHeaders,l=e.Utils.buildAuthHeader,m=e.Utils.parseUtilities,n=e.Utils.guardUnset,o=function(){function a(a,b){this.setup=a,this.options=b,n(a,"setup"),n(b,"options"),this.method=null,this.endpoint=null,this.data=null,this._headers={},d.extend(this,b),this._init(b)}return a.sendRequest=function(a){var b=a.buildUrl();b=e.Utils.disableRequestCache(b,a.method),a.method=a.method||g.Constants.HttpMethod.GET;var c=a.method===g.Constants.HttpMethod.GET?a.data:JSON.stringify(a.data);a.headers.Accept="*/*";var d={url:b,method:a.method,data:c,headers:a.headers,contentType:"application/json",crossOrigin:!1};return h.isNodejs||(d.crossOrigin=!0),new Promise(function(a,b){return f.reqwest(d).then(function(b){a(b)},function(a){b(a)})})},Object.defineProperty(a.prototype,"headers",{get:function(){return this._headers},set:function(a){this._headers=e.Utils.normalizeKeys(a)},enumerable:!0,configurable:!0}),a.buildAuthHeader=function(a,b){return l(a,b)},a.prototype.send=function(){return a.sendRequest(this)},a.prototype.buildUrl=function(){var a=e.Utils.buildUrl(this.setup)+this.endpoint;return d.size(this.queryStringParams)&&(a=a+"?"+e.Utils.toQueryString(this.queryStringParams)),a},a.buildQueryHeaders=function(b){return b?b instanceof i.Query?a._buildQueryHeaders(b):a._buildFilterHeader(b.filter):{}},a.prototype._init=function(b){d.extend(this.headers,a.buildAuthHeader(this.setup,b),a.buildQueryHeaders(b.query)),this.encodeHeaders()},a._buildQueryHeaders=function(a){a=a.build();var b={};return null!==a.$where&&(b[j.filter]=JSON.stringify(a.$where)),null!==a.$select&&(b[j.select]=JSON.stringify(a.$select)),null!==a.$sort&&(b[j.sort]=JSON.stringify(a.$sort)),null!==a.$skip&&(b[j.skip]=a.$skip),null!==a.$take&&(b[j.take]=a.$take),null!==a.$expand&&(b[j.expand]=JSON.stringify(a.$expand)),null!==a.$aggregate&&(b[j.aggregate]=JSON.stringify(a.$aggregate)),b},a._buildFilterHeader=function(a){var b={};return b[j.filter]=JSON.stringify(a),b},a.prototype.encodeHeaders=function(){var a=this.headers;d.each(k,function(b){void 0!==a[b]&&(a[b]=encodeURIComponent(a[b]))})},a.reviver=m.getReviver(),a.parsers={simple:{result:m.parseResult.bind(null,a.reviver),error:m.parseXhrError.bind(null,a.reviver)},single:{result:m.parseSingleResult.bind(null,a.reviver),error:m.parseXhrError.bind(null,a.reviver)},update:{result:m.parseUpdateResult.bind(null,a.reviver),error:m.parseXhrError.bind(null,a.reviver)},customRequest:{result:d.identity,error:m.parseXhrResponse}},a}();b.Request=o},function(a,b,c){"use strict";var d=c(10),e=c(4),f=c(36),g=c(3),h=c(2),i=c(5);b.RequestService={buildRequest:function(a,b){var c=f.RequestOptionsBuilder[a.operation],e=c(a);return this.setAdditionalHeaders(a,e),new d.Request(b.sdk.setup,e)},setAdditionalHeaders:function(a,b){a.isSync&&(b.headers[h.Constants.Headers.sync]=!0);var c={sdk:"js",platform:i.platform.platform};b.headers[h.Constants.Headers.sdk]=JSON.stringify(c)},handleRequestProcessing:function(a,b,c){return void 0===c&&(c=this.buildRequest(a,b)),new Promise(function(d,e){var f;c.send().then(function(c){return f=c,a.applyOffline?b.applyQueryOffline(a,f):f},function(a){e(a)}).then(function(){d(f)},function(b){var c=g.EverliveErrors.operationNotSupportedOffline.code,h=g.EverliveErrors.itemNotFound.code,i=!a.canUseOffline||!a.useCache;!i||b.code!==c&&b.code!==h?e(b):d(f)})})},sendRequest:function(a){return new Promise(function(b,c){a.send().then(function(a){var c=a.Result||a,d=e.Utils.parseUtilities.getReviver();e.Utils.parseUtilities.parseResult(d,c),b(c)},function(a){c(a)})})}}},function(a,b){/*
	CryptoJS v3.1.2
	code.google.com/p/crypto-js
	(c) 2009-2013 by Jeff Mott. All rights reserved.
	code.google.com/p/crypto-js/wiki/License
	*/
var c=c||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;e>f;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else if(c.length>65535)for(var f=0;e>f;f+=4)b[d+f>>>2]=c[f>>>2];else b.push.apply(b,c);return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw new Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=4*g,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*g,k=a.min(4*j,e);if(j){for(var l=0;j>l;l+=g)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new f.init(m,k)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),l=(d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}}),c.algo={});return c}(Math);b.CryptoJS=c},function(a,b,c){(function(b){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||b.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
a.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=c(26);h.inherits=c(27);var i=c(137),j=c(98);h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(b,c(7))},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(103),g=c(8),h=c(5),i=c(43),j=c(2),k=c(4),l=c(6),m=j.Constants.Headers,n=function(a){function b(b){a.call(this,b),this.headers=b.headers||{},this.useOffline=b.useOffline,this.applyOffline=b.applyOffline,this.noRetry=b.noRetry,this.skipAuth=b.skipAuth,this._normalizedHeaders=null,this.isSync=b.isSync,this.preserveState=b.preserveState,this.query=b.query;var c=b.meta||b.config.meta||{};c.collectionName&&(this.collectionName=c.collectionName)}return d(b,a),Object.defineProperty(b.prototype,"canUseOffline",{get:function(){var a=null;if(k.Utils.isContentType.files(this.collectionName)&&h.isDesktop){var b=this.operation;a=this.useOffline&&(b===g.DataQueryOperation.Read||b===g.DataQueryOperation.ReadById||b===g.DataQueryOperation.FilesGetDownloadUrlById||b===g.DataQueryOperation.Delete||b===g.DataQueryOperation.DeleteById)}else a=this.useOffline;return a},enumerable:!0,configurable:!0}),b.prototype._normalizeHeaders=function(){this._normalizedHeaders=k.Utils.normalizeKeys(this.headers)},b.prototype.getHeader=function(a){this._normalizeHeaders();var b=a.toLowerCase();return this._normalizedHeaders[b]},b.prototype.getHeaders=function(){this._normalizeHeaders();var a=e.deepExtend(this._normalizedHeaders);return a},b.prototype.getHeaderAsJSON=function(a){this._normalizeHeaders();var b;if(a&&(b=this._normalizedHeaders[a.toLowerCase()]),e.isObject(b))return b;if(!e.isString(b))return b;try{return JSON.parse(b)}catch(c){return b}},b.prototype.getQueryParameters=function(){var a={};if(this.operation===b.operations.ReadById)a.expand=this.getHeaderAsJSON(m.expand),a.select=this.getHeaderAsJSON(m.select);else if(!this.additionalOptions||void 0===this.additionalOptions.id){var c=this.getHeaderAsJSON(m.sort),d=this.getHeaderAsJSON(m.take),e=this.getHeaderAsJSON(m.skip),f=this.getHeaderAsJSON(m.select),g=this.getHeaderAsJSON(m.filter),h=this.getHeaderAsJSON(m.expand),j=this.getHeaderAsJSON(m.aggregate);if(this.query instanceof i.Query){var k=this.query.build();a.filter=k.$where||g||{},a.sort=k.$sort||c,a.limit=k.$take||d,a.skip=k.$skip||e,a.select=k.$select||f,a.expand=k.$expand||h,a.aggregate=k.$aggregate||j}else a.filter=this.filter||g||this.config.filter||{},a.sort=c,a.limit=d,a.skip=e,a.select=f,a.expand=h,a.aggregate=j}return a},b.prototype.applyEventQuery=function(a){this._applyCustomHeaders(a),this._applyEventQueryHeaders(a),this._applyEventQueryParams(a),this.additionalOptions=this.additionalOptions||{},this.additionalOptions.id=a.itemId,this.data=a.data,this._applyEventQuerySettings(a)},b.prototype._applyCustomHeaders=function(a){this.headers=a.headers,this._normalizeHeaders()},b.prototype._applyEventQueryHeaders=function(a){this._applyEventHeader(m.filter,a.filter),this._applyEventHeader(m.select,a.fields),this._applyEventHeader(m.sort,a.sort),this._applyEventHeader(m.skip,a.skip),this._applyEventHeader(m.take,a.take),this._applyEventHeader(m.expand,a.expand),this._applyEventHeader(m.aggregate,a.aggregate),this._applyEventHeader(m.powerFields,a.powerfields)},b.prototype._applyEventQueryParams=function(a){a.filter&&(this.query=this.query||new l.Query,this.query.filter=a.filter),a.aggregate&&(this.query=this.query||new l.Query,this.query.aggregateExpression=a.aggregate),this.fields=a.select,this.sort=a.sort,this.skip=a.skip,this.take=a.take,this.expand=a.expand},b.prototype._applyEventQuerySettings=function(a){this.useOffline=a.settings.useOffline,this.forceCache=a.settings.forceCache,this.ignoreCache=a.settings.ignoreCache,this.applyOffline=a.settings.applyOffline},b.prototype._applyEventHeader=function(a,b){if(b&&"string"!=typeof b){var c=a.toLowerCase();this.headers[c]=JSON.stringify(b)}},b.operations=g.DataQueryOperation,b}(f.DataQuery);b.DataQuery=n},function(a,b,c){"use strict";var d=c(1),e=c(2),f=function(a,b,c){return d.isArray(a)?d.map(a,function(a){return b(a,c)}):b(a,c)},g=function(a){return"object"==typeof a&&a._id&&!a.Id&&(a.Id=a._id,delete a._id),a},h=function(a,b){var c=b.verifyStateCreated,d=c?a[e.Constants.offlineItemsStateMarker]===e.Constants.offlineItemStates.created:!0;return"object"==typeof a&&(a._id||a.Id)&&d&&(delete a._id,delete a.Id),a},i=function(a){return delete a[e.Constants.offlineItemsStateMarker],a};b.offlineTransformations={removeIdTransform:function(a,b){return f(a,h,{verifyStateCreated:b})},idTransform:function(a){return f(a,g)},singleFieldTransform:function(a,b){return"undefined"==typeof b||null===b?null:b[a]},traverseAndTransformFilterId:function(a){a&&a.Id&&(a._id=a.Id,delete a.Id);for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];"object"==typeof d&&b.offlineTransformations.traverseAndTransformFilterId(d)}},removeMarkersTransform:function(a){return f(a,i)},removeFieldsTransform:function(a,b){return d.each(b,function(b){delete a[b]}),a}}},function(a,b,c){"use strict";var d=c(1),e=c(3),f=c(4),g=function(){function a(a,b){this.key=a,this.options=b,this.contentTypesStoreKey=this.key+"@ContentTypes"}return a.prototype.getAllData=function(a,b){var c=this,e={};this._getContentTypes(function(g){d.each(g,function(a){e[a]=new Promise(function(b,d){c.getData(a,b,d)})}),f.Utils.promiseHash(e).then(a)["catch"](b)},b)},a.prototype.getData=function(){throw new e.EverliveError({message:"The method getData is not implemented"})},a.prototype.saveData=function(){throw new e.EverliveError({message:"The method saveData is not implemented"})},a.prototype.purge=function(){throw new e.EverliveError({message:"The method purge is not implemented"})},a.prototype.purgeAll=function(){throw new e.EverliveError({message:"The method purgeAll is not implemented"})},a.prototype.purgeById=function(){throw new e.EverliveError({message:"The method purgeById is not implemented"})},a.prototype.count=function(){throw new e.EverliveError({message:"The method count is not implemented"})},a.prototype.queryData=function(){throw new e.EverliveError({message:"The method queryData is not implemented"})},a.prototype.removeData=function(){throw new e.EverliveError({message:"The method removeData is not implemented"})},a.prototype.updateData=function(){throw new e.EverliveError({message:"The method updateData is not implemented"})},a.prototype._getKey=function(a){return this.key+"_"+a},a.prototype._getContentTypes=function(){throw new e.EverliveError({message:"The method _getContentTypes is not implemented"})},a}();b.BasePersister=g},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(4),g=c(2),h=c(14),i=c(3),j=c(141),k=function(a){function b(b,c){a.call(this,b,c),this.collectionName=c,this.setup=this.sdk.setup,this.options=null}return d(b,a),Object.defineProperty(b.prototype,"offlineStorage",{get:function(){return this.sdk.offlineStorage},enumerable:!0,configurable:!0}),b.prototype._isOnline=function(){return this.offlineStorage?this.offlineStorage.isOnline():!0},b.prototype._getOfflineCreateData=function(a,b){var c;if(e.isArray(a.data)){c=[];for(var d=0;d<a.data.length;d++){var f=e.extend(a.data[d],b.Result[d]);c.push(f)}}else c=e.extend(a.data,b.Result);return c},b.prototype._destroy=function(a,b,c,d,e){var f=c?g.DataQueryOperation.DeleteById:g.DataQueryOperation.Delete,h=a&&"object"==typeof a?a[g.Constants.idField]:a,i=this.buildDataQuery({additionalOptions:{id:c?h:void 0},query:b},f);return this.processDataQuery(i,d,e)},b.prototype._setOption=function(a,b){return this.options=this.options||{},this.options[a]=e.isObject(b)?e.extend({},this.options[a],b):b,this},b.prototype._update=function(a,b,c,d,e,f){var h=this.buildDataQuery({updateObject:(i={},i[d?"$replace":"$set"]=a,i),additionalOptions:{id:c?a[g.Constants.idField]:void 0},query:b},g.DataQueryOperation.Update);return this.processDataQuery(h,e,f);var i},b.prototype._invalidIdErrorResponse=function(a){var b=new i.EverliveError(i.EverliveErrors.invalidId);return f.Utils.callbackAndPromiseErrorResponse(b,a)},b.prototype.applyQueryOffline=function(a,b){var c=this.offlineStorage&&this.offlineStorage.options.autoSync;if(c)switch(a.operation){case g.DataQueryOperation.Read:case g.DataQueryOperation.ReadById:case g.DataQueryOperation.FilesGetDownloadUrlById:var d=new h.DataQuery(e.defaults({data:b.Result,isSync:!0,operation:g.DataQueryOperation.Create},a));return this.offlineStorage.processQuery(d);case g.DataQueryOperation.Create:var f=this._getOfflineCreateData(a,b),i=new h.DataQuery(e.defaults({data:f,isSync:!0},a));return this.offlineStorage.processQuery(i);case g.DataQueryOperation.Update:case g.DataQueryOperation.RawUpdate:return a.isSync=!0,a.ModifiedAt=b.ModifiedAt,this.offlineStorage.processQuery(a);default:return a.isSync=!0,this.offlineStorage.processQuery(a)}return new Promise(function(a){a()})},b.prototype.useOffline=function(a){if(1!==arguments.length){var b=i.EverliveErrorHelper.buildSingleValueExpectedErrorMessage("useOffline()");throw new i.EverliveError({message:b,code:i.EverliveErrors.singleValueExpected.code})}var c=this.sdk._isOfflineStorageEnabled();if(a===!0&&!c)throw new i.EverliveError(i.EverliveErrors.noOfflineSupport);return this._setOption("useOffline",a)},b.prototype.ignoreCache=function(){return this._setOption("ignoreCache",!0)},b.prototype.forceCache=function(){return this._setOption("forceCache",!0)},b.prototype.maxAge=function(a){var b=1e3*a*60;return this._setOption("maxAge",b)},b.prototype.isSync=function(a){if(1!==arguments.length){var b=i.EverliveErrorHelper.buildSingleValueExpectedErrorMessage("isSync()");throw new i.EverliveError({message:b,code:i.EverliveErrors.singleValueExpected.code})}return this._setOption("isSync",a)},b.prototype.skipAuth=function(a){if(1!==arguments.length){var b=i.EverliveErrorHelper.buildSingleValueExpectedErrorMessage("skipAuth()");throw new i.EverliveError({message:b,code:i.EverliveErrors.singleValueExpected.code})}return this._setOption("skipAuth",a)},b.prototype.applyOffline=function(a){if(1!==arguments.length){var b=i.EverliveErrorHelper.buildSingleValueExpectedErrorMessage("applyOffline()");throw new i.EverliveError({message:b,code:i.EverliveErrors.singleValueExpected.code})}return this._setOption("applyOffline",a)},b.prototype.withHeaders=function(a){return this._setOption("headers",a)},b.prototype.expand=function(a){var b={"X-Everlive-Expand":JSON.stringify(a)};return this.withHeaders(b)},b.prototype.buildDataQuery=function(b,c){return a.prototype.buildDataQuery.call(this,b,c,{collectionName:this.collectionName})},b.prototype.get=function(a,b,c){var d=this.buildDataQuery(a,g.DataQueryOperation.Read);return this.processDataQuery(d,b,c)},b.prototype.getById=function(a,b,c){if(!f.Utils.modelHasValidId(a))return this._invalidIdErrorResponse(c);var d=this.buildDataQuery({additionalOptions:{id:a}},g.DataQueryOperation.ReadById);return this.processDataQuery(d,b,c)},b.prototype.aggregate=function(a,b,c){var d=this.buildDataQuery(a,g.DataQueryOperation.Aggregate);return this.processDataQuery(d,b,c)},b.prototype.count=function(a,b,c){var d=this.buildDataQuery(a,g.DataQueryOperation.Count);return this.processDataQuery(d,b,c)},b.prototype.create=function(a,b,c){var d=this.buildDataQuery(a,g.DataQueryOperation.Create);return this.processDataQuery(d,b,c)},b.prototype.rawUpdate=function(a,b,c,d){var e=this,h="string"==typeof b||"number"==typeof b;if(h&&!f.Utils.modelHasValidId(b))return e._invalidIdErrorResponse(d);var i=h?b:this.sdk.dataQueryBuilder._buildQuery(b),j={id:h?b:void 0},k=this.buildDataQuery({query:i,additionalOptions:j,updateObject:a},g.DataQueryOperation.RawUpdate);return this.processDataQuery(k,c,d)},b.prototype.updateSingle=function(a,b,c){return f.Utils.modelHasValidId(a)?this._update(a,null,!0,!1,b,c):this._invalidIdErrorResponse(c)},b.prototype.update=function(a,b,c,d){return this._update(a,b,!1,!1,c,d)},b.prototype.destroySingle=function(a,b,c){return f.Utils.modelHasValidId(a)?this._destroy(a,null,!0,b,c):this._invalidIdErrorResponse(c)},b.prototype.destroy=function(a,b,c){return this._destroy(null,a,!1,b,c)},b.prototype.setAcl=function(a,b,c,d){if(!f.Utils.modelHasValidId(b))return this._invalidIdErrorResponse(d);var e={acl:a},h={additionalOptions:e};e.id=b[g.Constants.idField]||b;var i=this.buildDataQuery(h,g.DataQueryOperation.SetAcl);return this.processDataQuery(i,c,d)},b.prototype.setOwner=function(a,b,c,d){if(!f.Utils.modelHasValidId(b))return this._invalidIdErrorResponse(d);var e={updateObject:{Owner:a},additionalOptions:{}};e.additionalOptions.id=b[g.Constants.idField]||b;var h=this.buildDataQuery(e,g.DataQueryOperation.SetOwner);return this.processDataQuery(h,c,d)},b.prototype.save=function(a,b,c){var d=this;return f.Utils.buildPromise(function(b,c){var e,f=d.isNew(a);e=f?d.create(a):d.updateSingle(a);var g=f?"create":"update";e.then(function(a){a.type=g,b(a)})["catch"](function(a){a.type=g,c(a)})},b,c)},b.prototype.isNew=function(a){return"undefined"==typeof a[g.Constants.idField]},b}(j["default"]);b.Data=k},function(a,b,c){(function(a,d){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function e(){try{var a=new Uint8Array(1);return a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===a.foo()&&"function"==typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(b){return!1}}function f(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function g(b,c){if(f()<c)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(b=new Uint8Array(c),b.__proto__=a.prototype):(null===b&&(b=new a(c)),b.length=c),b}function a(b,c,d){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(b,c,d);if("number"==typeof b){if("string"==typeof c)throw new Error("If encoding is specified then the first argument must be a string");return k(this,b)}return h(this,b,c,d)}function h(a,b,c,d){if("number"==typeof b)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&b instanceof ArrayBuffer?n(a,b,c,d):"string"==typeof b?l(a,b,c):o(a,b)}function i(a){if("number"!=typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative')}function j(a,b,c,d){return i(b),0>=b?g(a,b):void 0!==c?"string"==typeof d?g(a,b).fill(c,d):g(a,b).fill(c):g(a,b)}function k(b,c){if(i(c),b=g(b,0>c?0:0|p(c)),!a.TYPED_ARRAY_SUPPORT)for(var d=0;c>d;++d)b[d]=0;return b}function l(b,c,d){if(("string"!=typeof d||""===d)&&(d="utf8"),!a.isEncoding(d))throw new TypeError('"encoding" must be a valid string encoding');var e=0|r(c,d);b=g(b,e);var f=b.write(c,d);return f!==e&&(b=b.slice(0,f)),b}function m(a,b){var c=b.length<0?0:0|p(b.length);a=g(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function n(b,c,d,e){if(c.byteLength,0>d||c.byteLength<d)throw new RangeError("'offset' is out of bounds");if(c.byteLength<d+(e||0))throw new RangeError("'length' is out of bounds");return c=void 0===d&&void 0===e?new Uint8Array(c):void 0===e?new Uint8Array(c,d):new Uint8Array(c,d,e),a.TYPED_ARRAY_SUPPORT?(b=c,b.__proto__=a.prototype):b=m(b,c),b}function o(b,c){if(a.isBuffer(c)){var d=0|p(c.length);return b=g(b,d),0===b.length?b:(c.copy(b,0,0,d),b)}if(c){if("undefined"!=typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return"number"!=typeof c.length||Y(c.length)?g(b,0):m(b,c);if("Buffer"===c.type&&_(c.data))return m(b,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(a){if(a>=f())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f().toString(16)+" bytes");return 0|a}function q(b){return+b!=b&&(b=0),a.alloc(+b)}function r(b,c){if(a.isBuffer(b))return b.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(b)||b instanceof ArrayBuffer))return b.byteLength;"string"!=typeof b&&(b=""+b);var d=b.length;if(0===d)return 0;for(var e=!1;;)switch(c){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":case void 0:return T(b).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return W(b).length;default:if(e)return T(b).length;c=(""+c).toLowerCase(),e=!0}}function s(a,b,c){var d=!1;if((void 0===b||0>b)&&(b=0),b>this.length)return"";if((void 0===c||c>this.length)&&(c=this.length),0>=c)return"";if(c>>>=0,b>>>=0,b>=c)return"";for(a||(a="utf8");;)switch(a){case"hex":return H(this,b,c);case"utf8":case"utf-8":return D(this,b,c);case"ascii":return F(this,b,c);case"latin1":case"binary":return G(this,b,c);case"base64":return C(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function u(b,c,d,e,f){if(0===b.length)return-1;if("string"==typeof d?(e=d,d=0):d>2147483647?d=2147483647:-2147483648>d&&(d=-2147483648),d=+d,isNaN(d)&&(d=f?0:b.length-1),0>d&&(d=b.length+d),d>=b.length){if(f)return-1;d=b.length-1}else if(0>d){if(!f)return-1;d=0}if("string"==typeof c&&(c=a.from(c,e)),a.isBuffer(c))return 0===c.length?-1:v(b,c,d,e,f);if("number"==typeof c)return c=255&c,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(b,c,d):Uint8Array.prototype.lastIndexOf.call(b,c,d):v(b,[c],d,e,f);throw new TypeError("val must be string, number or Buffer")}function v(a,b,c,d,e){function f(a,b){return 1===g?a[b]:a.readUInt16BE(b*g)}var g=1,h=a.length,i=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return-1;g=2,h/=2,i/=2,c/=2}var j;if(e){var k=-1;for(j=c;h>j;j++)if(f(a,j)===f(b,-1===k?0:j-k)){if(-1===k&&(k=j),j-k+1===i)return k*g}else-1!==k&&(j-=j-k),k=-1}else for(c+i>h&&(c=h-i),j=c;j>=0;j--){for(var l=!0,m=0;i>m;m++)if(f(a,j+m)!==f(b,m)){l=!1;break}if(l)return j}return-1}function w(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new TypeError("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;++g){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))return g;a[c+g]=h}return g}function x(a,b,c,d){return X(T(b,a.length-c),a,c,d)}function y(a,b,c,d){return X(U(b),a,c,d)}function z(a,b,c,d){return y(a,b,c,d)}function A(a,b,c,d){return X(W(b),a,c,d)}function B(a,b,c,d){return X(V(b,a.length-c),a,c,d)}function C(a,b,c){return Z.fromByteArray(0===b&&c===a.length?a:a.slice(b,c))}function D(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return E(d)}function E(a){var b=a.length;if(aa>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=aa));return c}function F(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;++e)d+=String.fromCharCode(127&a[e]);return d}function G(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;++e)d+=String.fromCharCode(a[e]);return d}function H(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;++f)e+=S(a[f]);return e}function I(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function J(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function K(b,c,d,e,f,g){if(!a.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>f||g>c)throw new RangeError('"value" argument is out of bounds');if(d+e>b.length)throw new RangeError("Index out of range")}function L(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;++e)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function M(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;++e)a[c+e]=b>>>8*(d?e:3-e)&255}function N(a,b,c,d){if(c+d>a.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range")}function O(a,b,c,d,e){return e||N(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(a,b,c,d,23,4),c+4}function P(a,b,c,d,e){return e||N(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(a,b,c,d,52,8),c+8}function Q(a){if(a=R(a).replace(ba,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function R(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function S(a){return 16>a?"0"+a.toString(16):a.toString(16)}function T(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;++g){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function U(a){for(var b=[],c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function V(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);++g)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function W(a){return Z.toByteArray(Q(a))}function X(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function Y(a){return a!==a}var Z=c(194),$=c(195),_=c(196);b.Buffer=a,b.SlowBuffer=q,b.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==d.TYPED_ARRAY_SUPPORT?d.TYPED_ARRAY_SUPPORT:e(),b.kMaxLength=f(),a.poolSize=8192,a._augment=function(b){return b.__proto__=a.prototype,b},a.from=function(a,b,c){return h(null,a,b,c)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(a,b,c){return j(null,a,b,c)},a.allocUnsafe=function(a){return k(null,a)},a.allocUnsafeSlow=function(a){return k(null,a)},a.isBuffer=function(a){return!(null==a||!a._isBuffer)},a.compare=function(b,c){if(!a.isBuffer(b)||!a.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(b===c)return 0;for(var d=b.length,e=c.length,f=0,g=Math.min(d,e);g>f;++f)if(b[f]!==c[f]){d=b[f],e=c[f];break}return e>d?-1:d>e?1:0},a.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(b,c){if(!_(b))throw new TypeError('"list" argument must be an Array of Buffers');if(0===b.length)return a.alloc(0);var d;if(void 0===c)for(c=0,d=0;d<b.length;++d)c+=b[d].length;var e=a.allocUnsafe(c),f=0;for(d=0;d<b.length;++d){var g=b[d];if(!a.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(e,f),f+=g.length}return e},a.byteLength=r,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;a>b;b+=2)t(this,b,b+1);return this},a.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;a>b;b+=4)t(this,b,b+3),t(this,b+1,b+2);return this},a.prototype.swap64=function(){var a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;a>b;b+=8)t(this,b,b+7),t(this,b+1,b+6),t(this,b+2,b+5),t(this,b+3,b+4);return this},a.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?D(this,0,a):s.apply(this,arguments)},a.prototype.equals=function(b){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===a.compare(this,b)},a.prototype.inspect=function(){var a="",c=b.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(a+=" ... ")),"<Buffer "+a+">"},a.prototype.compare=function(b,c,d,e,f){if(!a.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(void 0===c&&(c=0),void 0===d&&(d=b?b.length:0),void 0===e&&(e=0),void 0===f&&(f=this.length),0>c||d>b.length||0>e||f>this.length)throw new RangeError("out of range index");if(e>=f&&c>=d)return 0;if(e>=f)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,e>>>=0,f>>>=0,this===b)return 0;for(var g=f-e,h=d-c,i=Math.min(g,h),j=this.slice(e,f),k=b.slice(c,d),l=0;i>l;++l)if(j[l]!==k[l]){g=j[l],h=k[l];break}return h>g?-1:g>h?1:0},a.prototype.includes=function(a,b,c){return-1!==this.indexOf(a,b,c)},a.prototype.indexOf=function(a,b,c){return u(this,a,b,c,!0)},a.prototype.lastIndexOf=function(a,b,c){return u(this,a,b,c,!1)},a.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else{if(!isFinite(b))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0)}var e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var f=!1;;)switch(d){case"hex":return w(this,a,b,c);case"utf8":case"utf-8":return x(this,a,b,c);case"ascii":return y(this,a,b,c);case"latin1":case"binary":return z(this,a,b,c);case"base64":return A(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,a,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var aa=4096;a.prototype.slice=function(b,c){var d=this.length;b=~~b,c=void 0===c?d:~~c,0>b?(b+=d,0>b&&(b=0)):b>d&&(b=d),0>c?(c+=d,0>c&&(c=0)):c>d&&(c=d),b>c&&(c=b);var e;if(a.TYPED_ARRAY_SUPPORT)e=this.subarray(b,c),e.__proto__=a.prototype;else{var f=c-b;e=new a(f,void 0);for(var g=0;f>g;++g)e[g]=this[g+b]}return e},a.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},a.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},a.prototype.readUInt8=function(a,b){return b||J(a,1,this.length),this[a]},a.prototype.readUInt16LE=function(a,b){return b||J(a,2,this.length),this[a]|this[a+1]<<8},a.prototype.readUInt16BE=function(a,b){return b||J(a,2,this.length),this[a]<<8|this[a+1]},a.prototype.readUInt32LE=function(a,b){return b||J(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},a.prototype.readUInt32BE=function(a,b){return b||J(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},a.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},a.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||J(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},a.prototype.readInt8=function(a,b){return b||J(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},a.prototype.readInt16LE=function(a,b){b||J(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt16BE=function(a,b){b||J(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},a.prototype.readInt32LE=function(a,b){return b||J(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},a.prototype.readInt32BE=function(a,b){return b||J(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},a.prototype.readFloatLE=function(a,b){return b||J(a,4,this.length),$.read(this,a,!0,23,4)},a.prototype.readFloatBE=function(a,b){return b||J(a,4,this.length),$.read(this,a,!1,23,4)},a.prototype.readDoubleLE=function(a,b){return b||J(a,8,this.length),$.read(this,a,!0,52,8)},a.prototype.readDoubleBE=function(a,b){return b||J(a,8,this.length),$.read(this,a,!1,52,8)},a.prototype.writeUIntLE=function(a,b,c,d){if(a=+a,b=0|b,c=0|c,!d){var e=Math.pow(2,8*c)-1;K(this,a,b,c,e,0)}var f=1,g=0;for(this[b]=255&a;++g<c&&(f*=256);)this[b+g]=a/f&255;return b+c},a.prototype.writeUIntBE=function(a,b,c,d){if(a=+a,b=0|b,c=0|c,!d){var e=Math.pow(2,8*c)-1;K(this,a,b,c,e,0)}var f=c-1,g=1;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=a/g&255;return b+c},a.prototype.writeUInt8=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,1,255,0),a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),this[c]=255&b,c+1},a.prototype.writeUInt16LE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8):L(this,b,c,!0),c+2},a.prototype.writeUInt16BE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=255&b):L(this,b,c,!1),c+2},a.prototype.writeUInt32LE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=255&b):M(this,b,c,!0),c+4},a.prototype.writeUInt32BE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b):M(this,b,c,!1),c+4},a.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);K(this,a,b,c,e-1,-e)}var f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)0>a&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},a.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);K(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)0>a&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},a.prototype.writeInt8=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,1,127,-128),a.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),0>b&&(b=255+b+1),this[c]=255&b,c+1},a.prototype.writeInt16LE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8):L(this,b,c,!0),c+2},a.prototype.writeInt16BE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=255&b):L(this,b,c,!1),c+2},a.prototype.writeInt32LE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24):M(this,b,c,!0),c+4},a.prototype.writeInt32BE=function(b,c,d){return b=+b,c=0|c,d||K(this,b,c,4,2147483647,-2147483648),0>b&&(b=4294967295+b+1),a.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b):M(this,b,c,!1),c+4},a.prototype.writeFloatLE=function(a,b,c){return O(this,a,b,!0,c)},a.prototype.writeFloatBE=function(a,b,c){return O(this,a,b,!1,c)},a.prototype.writeDoubleLE=function(a,b,c){return P(this,a,b,!0,c)},a.prototype.writeDoubleBE=function(a,b,c){return P(this,a,b,!1,c)},a.prototype.copy=function(b,c,d,e){if(d||(d=0),e||0===e||(e=this.length),c>=b.length&&(c=b.length),c||(c=0),e>0&&d>e&&(e=d),e===d)return 0;if(0===b.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),b.length-c<e-d&&(e=b.length-c+d);var f,g=e-d;if(this===b&&c>d&&e>c)for(f=g-1;f>=0;--f)b[f+c]=this[f+d];else if(1e3>g||!a.TYPED_ARRAY_SUPPORT)for(f=0;g>f;++f)b[f+c]=this[f+d];else Uint8Array.prototype.set.call(b,this.subarray(d,d+g),c);return g},a.prototype.fill=function(b,c,d,e){if("string"==typeof b){if("string"==typeof c?(e=c,c=0,d=this.length):"string"==typeof d&&(e=d,d=this.length),1===b.length){var f=b.charCodeAt(0);256>f&&(b=f)}if(void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e)}else"number"==typeof b&&(b=255&b);if(0>c||this.length<c||this.length<d)throw new RangeError("Out of range index");if(c>=d)return this;c>>>=0,d=void 0===d?this.length:d>>>0,b||(b=0);var g;if("number"==typeof b)for(g=c;d>g;++g)this[g]=b;else{var h=a.isBuffer(b)?b:T(new a(b,e).toString()),i=h.length;for(g=0;d-c>g;++g)this[g+c]=h[g%i]}return this};var ba=/[^+\/0-9A-Za-z-_]/g}).call(b,c(18).Buffer,function(){return this}())},function(a,b){"use strict";var c=function(){function a(a,b){void 0===b&&(b=[]),this.operator=a,this.operands=b}return a.prototype.addOperand=function(a){this.operands.push(a)},a}();b.Expression=c},function(a,b,c){"use strict";function d(a,b){var c,d=b.storage.provider,f=b.storage.implementation;if(e.isObject(f)&&d===j.Constants.StorageProvider.Custom)c=f;else switch(d){case j.Constants.StorageProvider.LocalStorage:c=new g.LocalStoragePersister(a,b);break;case j.Constants.StorageProvider.FileSystem:c=new h.FileSystemPersister(a,b);break;case j.Constants.StorageProvider.SQLite:c=new i.SQLitePersister(a,b);break;case j.Constants.StorageProvider.Custom:throw new k.EverliveError({message:"Custom storage provider requires an implementation object"});default:throw new k.EverliveError({message:"Unsupported storage type "+d})}return c}var e=c(1),f=c(16);b.BasePersister=f.BasePersister;var g=c(66);b.LocalStoragePersister=g.LocalStoragePersister;var h=c(65);b.FileSystemPersister=h.FileSystemPersister;var i=c(67);b.SQLitePersister=i.SQLitePersister;var j=c(2),k=c(3);b.getPersister=d},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(6),g=c(3),h=function(a){function b(b,c,d,e,f,g,h){a.call(this,b,c,d,e,f,g),this.aggregateExpression={GroupBy:[],Aggregate:{}};var i,j,k=h;k&&(i=k.GroupBy,j=k.Aggregate),this.aggregateExpression={GroupBy:i||[],Aggregate:j||{}}}return d(b,a),b.prototype._aggregateFunc=function(a,b,c){if("string"!=typeof b&&"count"!==a)throw new g.EverliveError({message:a+"() accepts only string as parameter."});var d={};return d[a]=b,this.aggregateExpression.Aggregate[c||b]=d,this},b.prototype.groupBy=function(a){if(e.isArray(a))Array.prototype.push.apply(this.aggregateExpression.GroupBy,a);else{if("string"!=typeof a)throw new g.EverliveError({message:"groupBy() accepts only array or string as parameter."});this.aggregateExpression.GroupBy.push(a)}return this},b.prototype.avg=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return Array.prototype.unshift.call(a,"avg"),this._aggregateFunc.apply(this,a)},b.prototype.count=function(a){return this._aggregateFunc("count",null,a||"Count")},b.prototype.max=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return Array.prototype.unshift.call(a,"max"),this._aggregateFunc.apply(this,a)},b.prototype.min=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return Array.prototype.unshift.call(a,"min"),this._aggregateFunc.apply(this,a)},b.prototype.sum=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return Array.prototype.unshift.call(a,"sum"),this._aggregateFunc.apply(this,a)},b.prototype.average=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.avg.apply(this,a)},b.throwNotSupportedException=function(a){throw'Operation "'+a+'" is not supported in an aggregation query'},b.prototype.skip=function(){return b.throwNotSupportedException("skip")},b.prototype.take=function(){return b.throwNotSupportedException("take")},b.prototype.select=function(){return b.throwNotSupportedException("select")},b.prototype.order=function(){return b.throwNotSupportedException("order")},b}(f.Query);b.AggregateQuery=h},function(a,b,c){"use strict";var d=c(1),e=c(2),f=c(31),g=c(3),h=c(19),i=e.Constants.maxDistanceConsts,j=e.Constants.radiusConsts,k=e.Constants.OperatorType,l=function(){function a(a){this.query=a,this.expr=a.expr}return a.prototype.build=function(){var a=this.query;return a.filter||a.fields||a.sort||a.toskip||a.totake||a.expandExpression?{$where:a.filter||null,$select:a.fields||null,$sort:a.sort||null,$skip:a.toskip||null,$take:a.totake||null,$expand:a.expandExpression||null,$aggregate:a.aggregateExpression||null}:{$where:this._buildWhere(),$select:this._buildSelect(),$sort:this._buildSort(),$skip:this._getSkip(),$take:this._getTake(),$expand:this._getExpand(),$aggregate:this._getAggregate()}},a.prototype._getSkip=function(){var a=d.find(this.expr.operands,function(a){return a.operator===k.skip});return a?a.operands[0]:null},a.prototype._getTake=function(){var a=d.find(this.expr.operands,function(a){return a.operator===k.take});return a?a.operands[0]:null},a.prototype._getExpand=function(){var a=d.chain(this.expr.operands).filter(function(a){return a.operator===k.expand}).reduce(function(a,b){return d.extend(a,b.operands[0])},{}).value();return d.isEmpty(a)?null:a},a.prototype._getAggregate=function(){if(!this.query.aggregateExpression)return null;var a=d.extend({},this.query.aggregateExpression);return d.isEmpty(a.GroupBy)&&delete a.GroupBy,d.isEmpty(a.Aggregate)&&delete a.Aggregate,a},a.prototype._buildSelect=function(){var a=d.find(this.expr.operands,function(a){return a.operator===k.select}),b={};return a?(d.reduce(a.operands,function(a,b){return a[b]=1,a},b),b):null},a.prototype._buildSort=function(){var a=d.filter(this.expr.operands,function(a){return a.operator===k.order||a.operator===k.order_desc}),b={};return a.length>0?(d.reduce(a,function(a,b){return a[b.operands[0]]=b.operator===k.order?1:-1,a},b),b):null},a.prototype._buildWhere=function(){var a=d.find(this.expr.operands,function(a){return a.operator===k.where});if(a)return this._build(new h.Expression(k.and,a.operands));var b=d.find(this.expr.operands,function(a){return a.operator===k.filter});return b?b.operands[0]:null},a.prototype._build=function(a){return this._isSimple(a)?this._simple(a):this._isRegex(a)?this._regex(a):this._isGeo(a)?this._geo(a):this._isAnd(a)?this._and(a):this._isOr(a)?this._or(a):this._isNot(a)?this._not(a):void 0},a.prototype._isSimple=function(a){return a.operator>=k.equal&&a.operator<=k.size},a.prototype._simple=function(a){var b={},c={},d=a.operands,e=this._translateoperator(a.operator);return e?b[e]=d[1]:b=d[1],c[d[0]]=b,c},a.prototype._isRegex=function(a){return a.operator>=k.regex&&a.operator<=k.endsWith},a.prototype._regex=function(a){var b={},c=this._getRegex(a),d=this._getRegexValue(c),e=a.operands;return b[e[0]]=d,b},a.prototype._getRegex=function(a){var b=a.operands[1],c=a.operands[2]?a.operands[2]:"";switch(a.operator){case k.regex:return b instanceof RegExp?b:new RegExp(b,c);case k.startsWith:return new RegExp("^"+b,c);case k.endsWith:return new RegExp(b+"$",c);default:throw new g.EverliveError({message:"Unknown operator type."})}},a.prototype._getRegexValue=function(a){var b="";return a.global&&(b+="g"),a.multiline&&(b+="m"),a.ignoreCase&&(b+="i"),{$regex:a.source,$options:b}},a.prototype._isGeo=function(a){return a.operator>=k.nearShpere&&a.operator<=k.withinShpere},a.prototype._geo=function(a){var b={},c=a.operands;return b[c[0]]=this._getGeoTerm(a),b},a.prototype._getGeoTerm=function(a){switch(a.operator){case k.nearShpere:return this._getNearSphereTerm(a);case k.withinBox:return this._getWithinBox(a);case k.withinPolygon:return this._getWithinPolygon(a);case k.withinShpere:return this._getWithinCenterSphere(a);default:throw new g.EverliveError({message:"Unknown operator type."})}},a.prototype._getNearSphereTerm=function(a){var b,c=a.operands,d=this._getGeoPoint(c[1]),e=c[2],f=c[3],g={$nearSphere:d};return"undefined"!=typeof e&&(b=i[f]||i.radians,g[b]=e),g},a.prototype._getWithinBox=function(a){var b=a.operands,c=this._getGeoPoint(b[1]),d=this._getGeoPoint(b[2]);return{$within:{$box:[c,d]}}},a.prototype._getWithinPolygon=function(a){var b=a.operands,c=this._getGeoPoints(b[1]);return{$within:{$polygon:c}}},a.prototype._getWithinCenterSphere=function(a){var b=a.operands,c=this._getGeoPoint(b[1]),d=b[2],e=b[3],f=j[e]||j.radians,g={center:c};return g[f]=d,{$within:{$centerSphere:g}}},a.prototype._getGeoPoint=function(a){return d.isArray(a)?new f.GeoPoint(a[0],a[1]):a},a.prototype._getGeoPoints=function(a){var b=this;return d.map(a,function(a){return b._getGeoPoint(a)})},a.prototype._isAnd=function(a){return a.operator===k.and},a.prototype._and=function(a){var b,c,d,e={},f=a.operands;for(b=0,c=f.length;c>b;b++)d=this._build(f[b]),e=this._andAppend(e,d);return e},a.prototype._andAppend=function(a,b){var c,e,f,g,h,i=d.keys(b);for(c=0,e=i.length;e>c;c++)f=i[c],g=a[f],"undefined"==typeof g?a[f]=b[f]:(h=b[f],g="object"==typeof g&&"object"==typeof h?d.extend(g,h):h,a[f]=g);return a},a.prototype._isOr=function(a){return a.operator===k.or},a.prototype._or=function(a){var b,c,d,e=[],f=a.operands;for(b=0,c=f.length;c>b;b++)d=this._build(f[b]),e.push(d);return{$or:e}},a.prototype._isNot=function(a){return a.operator===k.not},a.prototype._not=function(a){return{$not:this._build(a.operands[0])}},a.prototype._translateoperator=function(a){switch(a){case k.equal:return null;case k.not_equal:return"$ne";case k.gt:return"$gt";case k.lt:return"$lt";case k.gte:return"$gte";case k.lte:return"$lte";case k.isin:return"$in";case k.notin:return"$nin";case k.all:return"$all";case k.size:return"$size"}throw new g.EverliveError({message:"Unknown operator type."})},a}();b.QueryBuilder=l},function(a,b,c){"use strict";var d=c(5),e=d.isNativeScript,f=d.isNodejs;f||e?e?b.reqwest=c(75):f&&(b.reqwest=c(76)):b.reqwest=c(191)},function(a,b,c){"use strict";var d=c(1),e=c(175),f=c(163),g=c(156),h=c(160),i=c(157),j=/\{([a-z0-9]+)\}(.|$)/gi,k=a.exports=function(a){this.builder=a,this.templates=new e,this.blocks=new e,this.operators={comparison:new e,logical:new e,fetching:new e,state:new e},this.modifiers=new e,f(this),g(this),h(this),i(this),this.identifierPartsRegexp=new RegExp("(\\"+this.config.identifierPrefix+"[^\\"+this.config.identifierSuffix+"]*\\"+this.config.identifierSuffix+"|[^\\.]+)","g"),this.wrappedIdentifierPartRegexp=new RegExp("^\\"+this.config.identifierPrefix+".*\\"+this.config.identifierSuffix+"$")};k.prototype.config={identifierPrefix:'"',identifierSuffix:'"'},k.prototype._wrapIdentifier=function(a){if(this.builder.options.wrappedIdentifiers){var b=this,c=a.match(this.identifierPartsRegexp);return d(c).map(function(a){return"*"===a||b.wrappedIdentifierPartRegexp.test(a)||(a=b.config.identifierPrefix+a+b.config.identifierSuffix),a}).join(".")}return a},k.prototype.buildLogicalOperator=function(a){var b=this,c=a.operator,e=a.value;if(d.isObject(e)||(e=d.object([a.defaultFetchingOperator],[e])),d.isEmpty(e))return"";var f;return f=d(e).map(d.isArray(e)?function(d){return b.buildOperator({context:"logical",contextOperator:c,operator:"$and",value:d,states:[],defaultFetchingOperator:a.defaultFetchingOperator})}:function(e,f){return"$"!==f[0]&&((!d.isObject(e)||d.isArray(e))&&(e={$eq:e}),e=d.defaults({name:f},e),f="$field"),b.buildOperator({context:"logical",contextOperator:c,operator:f,value:e,states:[],defaultFetchingOperator:a.defaultFetchingOperator})}),this.operators.logical.get(c).fn(d.compact(f))},k.prototype.buildComparisonOperator=function(a){var b=this,c=a.operator;d(a.states).each(function(a){c=b.operators.state.get(a).getOperator(c)});var e=this.operators.comparison.get(c),f=this.buildEndFetchingOperator({context:"comparison",contextOperator:c,value:a.value,states:a.states,defaultFetchingOperator:e.defaultFetchingOperator||a.defaultFetchingOperator});return e.fn(a.field,f)},k.prototype.buildFetchingOperator=function(a){var b,c=a.operator,e=a.value,f=this.operators.fetching.get(c).fn(e,a.end);return b=a.end||!d.isObject(e)?f:this.buildOperatorsGroup({context:"fetching",contextOperator:c,operator:"$and",field:f,value:e,states:a.states,defaultFetchingOperator:a.defaultFetchingOperator})},k.prototype.buildEndFetchingOperator=function(a){var b,c=this,e=a.value;return d.isObject(e)&&!d.isArray(e)&&(b=d(e).findKey(function(a,b){return"$"===b[0]&&c.operators.fetching.has(b)}),b&&(e=e[b])),this.buildOperator(d.extend({},a,{operator:b||a.defaultFetchingOperator,value:e,end:!0}))},k.prototype.buildStateOperator=function(a){return this.buildOperatorsGroup(d.extend({},a,{context:"state",contextOperator:a.operator,operator:"$and",states:a.states.concat(a.operator)}))},k.prototype.buildOperatorsGroup=function(a){var b,c=this,e=a.value;return d.isObject(e)&&!d.isArray(e)?(b=this.operators.logical.get(a.operator).fn(d(e).chain().map(function(b,e){
return"$"!==e[0]?"":(c.operators.fetching.has(e)&&(b=d.object([e],[b]),e="$eq"),c.buildOperator(d.extend({},a,{operator:e,value:b})))}).compact().value()),b||(b=a.field)):b=this.buildEndFetchingOperator(a),b},k.prototype.buildOperator=function(a){var b,c=function(a,b){return d.contains(a,b)},e=a.context,f=a.operator,g=d(this.operators).mapObject(function(a){return a.has(f)});if(!d(g).some())throw new Error('Unknown operator "'+f+'"');if(g.logical&&c(["null","logical"],e))b=this.buildLogicalOperator(a);else if(g.fetching&&c(["logical","comparison"],e))b=this.buildFetchingOperator(a);else if(g.comparison&&c(["fetching","state"],e))b=this.buildComparisonOperator(a);else{if(!g.state||!c(["fetching","state"],e)){var h='Unexpected operator "'+f+'" at '+("null"===e?"null ":"")+"context";throw a.contextOperator&&(h+=' of operator "'+a.contextOperator+'"'),new Error(h)}b=this.buildStateOperator(a)}return b},k.prototype.buildCondition=function(a){return this.buildOperator({context:"null",operator:"$and",value:a.value,states:[],defaultFetchingOperator:a.defaultFetchingOperator})},k.prototype.buildModifier=function(a){var b=this;return d(a.modifier).chain().map(function(a,c){var e;"$"===c[0]?e=c:(e="$set",a=d.object([c],[a]));var f=b.modifiers.get(e);if(!f)throw new Error('Unknown modifier "'+e+'"');return d(a).map(function(a,c){return c=b._wrapIdentifier(c),a=b.buildBlock("term",{term:a,type:"value"}),f(c,a)})}).flatten().compact().value().join(", ")},k.prototype.buildBlock=function(a,b){var c=this.blocks.get(a);if(!c)throw new Error('Unknown block "'+a+'"');return c(b)},k.prototype.buildTemplate=function(a,b){var c=this,e=this.templates.get(a);if(!e)throw new Error('Unknown template type "'+a+'"');return b=d.defaults({},b,e.defaults),e.validate&&e.validate(a,b),e.pattern.replace(j,function(e,f,g){return d.isUndefined(b[f])?"":(c.blocks.has(a+":"+f)&&(f=a+":"+f),c.buildBlock(f,b)+g)}).trim()}},function(a){var b=Object.prototype.toString;a.exports=function(a){switch(b.call(a)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===a?"null":void 0===a?"undefined":a!==a?"nan":a&&1===a.nodeType?"element":(a=a.valueOf?a.valueOf():Object.prototype.valueOf.apply(a),typeof a)}},function(a,b,c){(function(a){// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
function c(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}b.isArray=c,b.isBoolean=d,b.isNull=e,b.isNullOrUndefined=f,b.isNumber=g,b.isString=h,b.isSymbol=i,b.isUndefined=j,b.isRegExp=k,b.isObject=l,b.isDate=m,b.isError=n,b.isFunction=o,b.isPrimitive=p,b.isBuffer=a.isBuffer}).call(b,c(18).Buffer)},function(a){a.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},function(a,b,c){function d(){e.call(this)}
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
a.exports=d;var e=c(40).EventEmitter,f=c(203);f(d,e),d.Readable=c(200),d.Writable=c(202),d.Duplex=c(197),d.Transform=c(201),d.PassThrough=c(199),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;
// Allow for unix-like usage: A.pipe(B).pipe(C)
return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},function(a,b,c){(function(a,d){function e(a,c){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(c)?d.showHidden=c:c&&b._extend(d,c),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,c,d){if(a.customInspect&&c&&A(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c)){var e=c.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,c);if(f)return f;var g=Object.keys(c),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(c)),z(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(c);if(0===g.length){if(A(c)){var q=c.name?": "+c.name:"";return a.stylize("[Function"+q+"]","special")}if(w(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(y(c))return a.stylize(Date.prototype.toString.call(c),"date");if(z(c))return k(c)}var r="",s=!1,u=["{","}"];if(o(c)&&(s=!0,u=["[","]"]),A(c)){var v=c.name?": "+c.name:"";r=" [Function"+v+"]"}if(w(c)&&(r=" "+RegExp.prototype.toString.call(c)),y(c)&&(r=" "+Date.prototype.toUTCString.call(c)),z(c)&&(r=" "+k(c)),0===g.length&&(!s||0==c.length))return u[0]+r+u[1];if(0>d)return w(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special");a.seen.push(c);var x;return x=s?l(a,c,d,p,g):g.map(function(b){return m(a,c,d,p,b,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
var G=/%[sdj%]/g;b.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},b.deprecate=function(c,e){function f(){if(!g){if(d.throwDeprecation)throw new Error(e);d.traceDeprecation?console.trace(e):console.error(e),g=!0}return c.apply(this,arguments)}if(v(a.process))return function(){return b.deprecate(c,e).apply(this,arguments)};if(d.noDeprecation===!0)return c;var g=!1;return f};var H,I={};b.debuglog=function(a){if(v(H)&&(H=d.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var c=d.pid;I[a]=function(){var d=b.format.apply(b,arguments);console.error("%s %d: %s",a,c,d)}}else I[a]=function(){};return I[a]},b.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},b.isArray=o,b.isBoolean=p,b.isNull=q,b.isNullOrUndefined=r,b.isNumber=s,b.isString=t,b.isSymbol=u,b.isUndefined=v,b.isRegExp=w,b.isObject=x,b.isDate=y,b.isError=z,b.isFunction=A,b.isPrimitive=B,b.isBuffer=c(205);var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];b.log=function(){console.log("%s - %s",E(),b.format.apply(b,arguments))},b.inherits=c(204),b._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(b,function(){return this}(),c(7))},function(a,b,c){"use strict";function d(){if(!this._isOfflineStorageEnabled())throw new q.EverliveError(q.EverliveErrors.noOfflineSupport)}var e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},f=c(1),g=c(48),h=c(17),i=c(84),j=c(83),k=c(2),l=c(4),m=c(47),n=c(49),o=c(32),p=c(10),q=c(3),r=c(56),s=c(51),t=c(85),u=c(86),v=c(88),w=c(90),x=c(87),y=c(91),z=c(92),A=c(89),B=c(77),C=c(78),D=c(54),E=c(22),F=c(53),G=c(6),H=c(21),I=c(31),J=c(23),K=c(20),L=c(61),M=[],N=function(a){function b(c){var d=this;a.call(this,c),this.push=this._getPush(),this.files=this.Files=this._getFiles(),this.users=this.Users=this._getUsers(),this.businessLogic=this._getBusinessLogic();var e=f.pick(this.setup,["appId","apiKey"]),g=f.extend({},c,e);f.each(M,function(a){a.func(g,d)}),null===b.$&&(b.$=this),this.registerDataQueryPreProcessor(new t["default"]),this.registerDataQueryPreProcessor(new u["default"]),this.registerDataQueryProcessor(new v["default"]),this.registerDataQueryProcessor(new w["default"]),this.registerDataQueryProcessor(new x["default"]),this.registerDataQueryProcessor(new y["default"]),this.registerDataQueryProcessor(new z["default"]),this.registerDataQueryProcessor(new A["default"]),this.registerDataQueryPostProcessor(new B.ResponseParserProcessor),this.registerDataQueryPostProcessor(new C["default"])}return e(b,a),b.init=function(a){return b.$=null,new b(a)},b.disableRequestCache=function(){return l.Utils.disableRequestCache()},b.prototype.buildUrl=function(){return l.Utils.buildUrl(this.setup)},b.prototype.buildAuthHeader=function(){return l.Utils.buildAuthHeader(this.setup)},b.prototype.authInfo=function(a,c){var d=this;return l.Utils.buildPromise(function(a,c){var e=d.setup;return e.masterKey?a({status:b.AuthStatus.masterKey}):e.token?d.authentication&&d.authentication.isAuthenticationInProgress()?a({status:b.AuthStatus.authenticating}):void d.users.skipAuth(!0).currentUser().then(function(c){return a({status:b.AuthStatus.authenticated,user:c.result})},function(e){return d.authentication&&d.authentication.isAuthenticationInProgress()?a({status:b.AuthStatus.authenticating}):e.code===q.EverliveErrors.invalidRequest.code||e.code===q.EverliveErrors.expiredToken.code?a({status:b.AuthStatus.invalidAuthentication}):c(e)}):a({status:b.AuthStatus.unauthenticated})},a,c)},b.prototype.request=function(a){return new p.Request(this.setup,a)},b.prototype.offline=function(a){void 0===a&&(a=!0),d.call(this),this.offlineStorage._setOffline(a)},b.prototype.online=function(a){void 0===a&&(a=!0),d.call(this),this.offlineStorage._setOffline(!a)},b.prototype.isOffline=function(){return d.call(this),!this.isOnline()},b.prototype.isOnline=function(){return this.offlineStorage.isOnline()},b.prototype.sync=function(){return d.call(this),this.offlineStorage.sync.apply(this.offlineStorage,arguments)},b.prototype._isOfflineStorageEnabled=function(){return l.Utils.isOfflineStorageEnabled(this.setup)},b.prototype._getData=function(a){return new h.Data(this,a)},b.prototype._getDataQueryBuilder=function(){return new D.DataQueryBuilder},b.prototype._getSetup=function(a){return new g.Setup(a)},b.prototype._getUsers=function(){return new i.Users(this)},b.prototype._getAuthentication=function(){return new n["default"](this)},b.prototype._getPush=function(){return new m.Push(this)},b.prototype._getFiles=function(){return new j.Files(this)},b.prototype._getBusinessLogic=function(){return new s.BusinessLogic(this)},b.$=null,b.PushCallbacks={},b.Offline={},b.Query=G.Query,b.AggregateQuery=H.AggregateQuery,b.QueryBuilder=E.QueryBuilder,b.GeoPoint=I.GeoPoint,b.Constants=k.Constants,b.Request=p.Request,b.EverliveErrors=q.EverliveErrors,b.Data=h.Data,b._utils=l.Utils,b._traverseAndRevive=l.Utils.parseUtilities.traverseAndRevive,b._common={_:f,rsvp:{Promise:Promise,all:Promise.all.bind(Promise),hashSettled:l.Utils.promiseHashSettled,allSettled:l.Utils.promisesAllSettled,hash:l.Utils.promiseHash},Promise:Promise,reqwest:J.reqwest},b.persister={LocalStorage:K.LocalStoragePersister,FileSystem:K.FileSystemPersister},b.version="1.9.1",b.commit="45f5b9cb96fcad6097f25f0a90ff0ec99c5ab1ed",b.idField=k.Constants.idField,b.initializations=M,b.AuthStatus=k.Constants.AuthStatus,b}(L.KendoSdk);b.Everlive=N;var O=function(a,b){b.helpers={},f.each(r.helpers,function(c){var d=a.helpers?a.helpers[c.name]:null;b.helpers[c.name]=new c.ctor(b,d)})};M.push({name:"caching",func:F.initCaching}),M.push({name:"cacheStore",func:F.initStore}),M.push({name:"offlineStorage",func:o.initOfflineStorage}),M.push({name:"helpers",func:O})},function(a,b){"use strict";var c=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this.longitude=a,this.latitude=b}return a}();b.GeoPoint=c},function(a,b,c){"use strict";function d(a){var b,c=a.offline||a.offlineStorage;return c===!0?b=e.defaults({},l):e.isObject(c)?(b=e.defaults(c,l),b.storage=e.defaults(c.storage,l.storage),b.encryption=e.defaults(c.encryption,l.encryption),b.conflicts=e.defaults(c.conflicts,l.conflicts),b.files=e.defaults(c.files,l.files)):(b=e.defaults({},l),b.enabled=!1,c||(a.offlineStorage=b)),b.appId=a.appId,b.cacheEnabled=a.caching&&a.caching.enabled,b}var e=c(1),f=c(2),g=c(20),h=c(64),i=c(3),j=c(5),k=c(55),l={autoSync:!0,enabled:!0,conflicts:{strategy:f.Constants.ConflictResolutionStrategy.ClientWins,implementation:null},offline:!1,storage:{name:"",provider:j.isNativeScript?f.Constants.StorageProvider.FileSystem:f.Constants.StorageProvider.LocalStorage,implementation:null,storagePath:f.Constants.DefaultStoragePath,requestedQuota:f.Constants.DefaultFilesystemStorageQuota},typeSettings:{},encryption:{provider:f.Constants.EncryptionProvider.Default,implementation:null,key:""},files:{storagePath:f.Constants.DefaultFilesStoragePath,metaPath:f.Constants.DefaultFilesMetadataPath,maxConcurrentDownloads:f.Constants.MaxConcurrentDownloadTasks}},m={};m[f.Constants.ConflictResolutionStrategy.ClientWins]=function(a,b){return new Promise(function(a){a(b)})},m[f.Constants.ConflictResolutionStrategy.ServerWins]=function(a,b,c){return new Promise(function(a){a(c)})};var n=function(a,b){var c=a.storage.name||"everliveOfflineStorage_"+b.setup.appId,d=g.getPersister(c,a);return a.storage.implementation=d,d},o=function(a){var b,c=a.encryption.provider,d=a.encryption.implementation;if(e.isObject(d)&&c===f.Constants.EncryptionProvider.Custom)b=d;else switch(c){case f.Constants.EncryptionProvider.Default:b=new k.CryptographicProvider(a);break;case f.Constants.EncryptionProvider.Custom:throw new i.EverliveError({message:"Custom encryption provider requires an implementation object"});default:throw new i.EverliveError({message:"Unsupported encryption provider "+c})}return a.encryption.implementation=b,b};b.buildOfflineStorageOptions=d;var p=function(a,b){var c=d(a),e=n(c,b),f=o(c,b);return new h.OfflineStorageModule(b,c,e,f)},q=function(a,b){b.offlineStorage=p(a,b)};b.initOfflineStorage=q},function(a,b,c){"use strict";function d(a){var b=[h.DataQueryOperation.UserLoginWithProvider,h.DataQueryOperation.UserLinkWithProvider,h.DataQueryOperation.UserUnlinkFromProvider],c=a.operation,d=h.DataQueryOperation[a.operation];if(-1!==b.indexOf(c)){var e=d.substring(0,d.indexOf("Provider"));d=e+(a.data.Provider||a.data.Identity.Provider)}return{message:"The Users operation "+d+" is not supported in offline mode",code:0}}function e(a){var b=h.DataQueryOperation[a];return{message:"The Files operation "+b+" is not supported in offline mode",code:0}}var f=c(1),g=c(3),h=c(2),i=c(4),j=c(15),k=c(46),l=[h.Constants.Headers.powerFields],m=c(134),n=(p={},p[h.DataQueryOperation.Create]=!0,p[h.DataQueryOperation.Update]=!0,p[h.DataQueryOperation.Delete]=!0,p[h.DataQueryOperation.DeleteById]=!0,p[h.DataQueryOperation.RawUpdate]=!0,p[h.DataQueryOperation.SetAcl]=!0,p[h.DataQueryOperation.SetOwner]=!0,p[h.DataQueryOperation.UserLoginWithProvider]=!0,p[h.DataQueryOperation.UserLinkWithProvider]=!0,p[h.DataQueryOperation.UserUnlinkFromProvider]=!0,p[h.DataQueryOperation.UserLogin]=!0,p[h.DataQueryOperation.UserLogout]=!0,p[h.DataQueryOperation.UserChangePassword]=!0,p[h.DataQueryOperation.UserResetPassword]=!0,p),o=function(){function a(a,b,c,d,e){this.persister=a,this._encryptionProvider=b,this.offlineFilesProcessor=c,this.everlive=d,this.setup=e}return a.prototype.processQuery=function(){throw new g.EverliveError({message:"The method processQuery is not implemented"})},a.prototype._persistData=function(){throw new g.EverliveError({message:"The method _persistData is not implemented"})},a.prototype._shouldAutogenerateIdForContentType=function(a){return!(this.setup&&this.setup.typeSettings&&this.setup.typeSettings[a]&&this.setup.typeSettings[a].autoGenerateId===!1)},a.prototype._getAllCollections=function(){throw new g.EverliveError({message:"The method _getAllCollections is not implemented"})},a.prototype.purgeAll=function(a,b){var c=this;return i.Utils.buildPromise(function(a,b){c.persister.purgeAll(function(){var d=c.everlive.setup.caching&&c.everlive.setup.caching.enabled===!0;d?c.everlive.cache.clearAll(a,b):a()},b)},a,b)},a.prototype.purge=function(a,b,c){var d=this;return i.Utils.buildPromise(function(b,c){d.persister.purge(a,function(){var e=d.everlive.setup.caching&&d.everlive.setup.caching.enabled===!0;e?d.everlive.cache.clear(a,b,c):b()},c)},b,c)},a.prototype.purgeById=function(a,b){var c=this;return new Promise(function(d,e){c.persister.purgeById(a,b,d,e)})},a.prototype.checkSupportedQuery=function(a){for(var b=0;b<l.length;b++){var c=l[b];if(a.getHeader(c))return{message:"The header "+c+" is not supported in offline mode",code:0}}if(i.Utils.isContentType.users(a.collectionName)&&n[a.operation])return d(a);var f=a.additionalOptions&&a.additionalOptions.id,j=a.operation===h.DataQueryOperation.Update&&!f,k=a.operation===h.DataQueryOperation.RawUpdate,m=a.operation===h.DataQueryOperation.Create&&Array.isArray(a.data);if(i.Utils.isContentType.files(a.collectionName)){if(m)return g.EverliveErrors.invalidRequest;if(k||j)return e(a.operation)}},a.prototype._setItemDates=function(a,b,c){b.CreatedAt=i.Utils.isDate(a.CreatedAt)?i.Utils.cloneDate(a.CreatedAt):new Date,b.ModifiedAt=i.Utils.cloneDate(i.Utils.isDate(a.ModifiedAt)?a.ModifiedAt:b.CreatedAt),b.CreatedBy=b.CreatedBy||this.everlive.setup.principalId||h.Constants.guidEmpty,b.ModifiedBy=b.ModifiedBy||b.CreatedBy,b.Owner="Users"===c?b._id:b.CreatedBy||h.Constants.guidEmpty},a.prototype._transformPersistedData=function(a,b){var c=[];"Users"===a&&(c=c.concat(["Password","SecretQuestionId","SecretAnswer"])),c.length&&f.each(b,function(a){j.offlineTransformations.removeFieldsTransform(a,c)})},a.prototype._overwriteFile=function(a,b,c){var d=this;return this.everlive.offlineStorage.files.purge(a).then(function(){return d.offlineFilesProcessor.upsertFileFromObject(b,!0,c)})},a.prototype._getCreateResult=function(a,b){if(1===a.length){var c;if(b){var d=f.extend({},a[0]);c=j.offlineTransformations.idTransform(d)}else c={CreatedAt:i.Utils.cloneDate(a[0].CreatedAt),Id:a[0]._id};return{result:c}}var e=[];return f.each(a,function(a){var c;if(b){var d=f.extend({},a);c=j.offlineTransformations.idTransform(d)}else c={CreatedAt:i.Utils.cloneDate(a.CreatedAt),Id:a._id};e.push(c)}),{result:e}},a.prototype._prepareExpand=function(a,b,c){return new Promise(function(d,e){a?k.expandProcessor.prepare(a,b.collectionName,c,b.fields,null,null,function(a,b){return a?("ExpandError"===a.name&&(a.code=g.EverliveErrors.invalidExpandExpression.code),e(a)):void d(b)}):d()})},a.prototype._expandResult=function(a,b){var c=this;return new Promise(function(d,e){a?k.expandProcessor.expand(a.relationsTree,b,{offlineModule:c},function(a,b){return a?("ExpandError"===a.name&&(a.code=g.EverliveErrors.invalidExpandExpression.code),e(a)):void d(b)}):d(b)})},a.prototype.getDownloadUrlById=function(a){var b,c,d=this,e=a.additionalOptions.id;return d.everlive.files.useOffline(!0).isSync(a.isSync).getById(e).then(function(a){var b=a.result;return c=b.Uri,d.everlive.offlineStorage.files._getFileUrlForId(b.Id,b.Filename)}).then(function(a){return b=a,d.everlive.offlineStorage.offlineFilesProcessor.fileStore.getFileByAbsolutePath(a)}).then(function(a){return{result:{Uri:a?b:c}}})},a.prototype._transformOfflineResult=function(a,b,c,d){var e={result:a,count:b||(a||[]).length};(void 0!==b&&null!==b||Array.isArray(a))&&(e.count=b||a.length);var f=[];if(f.push(j.offlineTransformations.idTransform),f.push(j.offlineTransformations.removeMarkersTransform),c){var g=c.getHeader(h.Constants.Headers.includeCount);g===!1&&delete e.count;var i=c.getHeader(h.Constants.Headers.singleField);"string"==typeof i&&f.push(j.offlineTransformations.singleFieldTransform.bind(this,i))}return d&&(f=f.concat(d)),this._applyTransformations(e,f),void 0===e.count&&delete e.count,e},a.prototype._applyTransformations=function(a,b){Array.isArray(a.result)?f.each(b,function(b){a.result.map(function(c,d){a.result[d]=b(c)})}):f.each(b,function(b){a.result=b(a.result)})},a.prototype._getDirtyItems=function(a){var b={};b[h.Constants.offlineItemsStateMarker]={$exists:!0,$ne:null};var c=m.Query(b),d=m.Cursor(a,c);return d.all()},a.prototype._getWithoutDeletedFilter=function(a,b){void 0===b&&(b=!1);var c={$and:[]};c.$and.push(a);var d={};return b?d.$or=[(e={},e[h.Constants.offlineItemsStateMarker]={$ne:h.Constants.offlineItemStates.deleted},e),(f={},f[h.Constants.offlineItemsStateMarker]={$is:null},f)]:d[h.Constants.offlineItemsStateMarker]={$ne:h.Constants.offlineItemStates.deleted},c.$and.push(d),c;var e,f},a}();b.OfflineQueryProcessor=o;var p},function(a,b,c){"use strict";var d=c(133),e=c(1),f=c(3),g=c(2),h=c(4),i=g.Constants.Platform,j=h.Utils.buildPromise,k=function(){function a(a){if(!window.cordova)throw new f.EverliveError({message:"Error: currentDevice() can only be called from within a hybrid mobile app, after 'deviceready' event has been fired."});this._pushHandler=a,this._initSuccessCallback=null,this._initErrorCallback=null,this._globalFunctionSuffix=null,this.pushSettings=null,this.pushToken=null,this.isInitialized=!1,this.isInitializing=!1,this.emulatorMode=!1}return a.ensurePushIsAvailable=function(){var a="undefined"!=typeof window&&window.plugins&&window.plugins.pushNotification;if(!a&&!h.Utils._inAppBuilderSimulator())throw new f.EverliveError({message:"The push notification plugin is not available. Ensure that the pushNotification plugin is included and use after `deviceready` event has been fired."})},a.prototype.enableNotifications=function(a,b,c){return this.pushSettings=this._cleanPlatformsPushSettings(a),j(e.bind(this._initialize,this),b,c)},a.prototype.disableNotifications=function(a,b){var c=this;return this.unregister().then(function(){return j(function(a,b){if(c.emulatorMode)a();else{var d,e=window.plugins.pushNotification,f=c._getPlatformType();f===i.WindowsPhone&&(d={channelName:c.pushSettings.wp8.channelName}),e.unregister(function(){c.isInitialized=!1,a()},b,d)}},a,b)},b)},a.prototype.getRegistration=function(a,b){var c=encodeURIComponent(this._getDeviceId());return this._pushHandler.devices.getById("HardwareId/"+c,a,b)},a.prototype.register=function(a,b,c){var d=this,e={};return void 0!==a&&(e.Parameters=a),this._populateRegistrationObject(e).then(function(){return d._pushHandler.devices.create(e,b,c)},c)},a.prototype.unregister=function(a,b){var c=encodeURIComponent(device.uuid);return this._pushHandler.devices.destroySingle({Id:"HardwareId/"+c},a,b)},a.prototype.updateRegistration=function(a,b,c){var d=this,e={};return void 0!==a&&(e.Parameters=a),this._populateRegistrationObject(e).then(function(){return e.Id="HardwareId/"+encodeURIComponent(e.HardwareId),d._pushHandler.devices.updateSingle(e,b,c)},c)},a.prototype.areNotificationsEnabled=function(a,b,c){a=a||{};var d=window.plugins.pushNotification;return j(function(b,c){d.areNotificationsEnabled(b,c,a)},b,c)},a.prototype.notificationProcessed=function(){var a=window.plugins.pushNotification;a.notificationProcessed()},a.prototype._initializeInteractivePush=function(a,b,c){var d=window.plugins.pushNotification,f=a.interactiveSettings,g=[];a.alert&&g.push(d.UserNotificationTypes.Alert),a.badge&&g.push(d.UserNotificationTypes.Badge),a.sound&&g.push(d.UserNotificationTypes.Sound);var h=function(a){var b=e.find(f.actions,function(b){return b.identifier===a});return b},i=e.map(f.categories,function(a){return{identifier:a.identifier,actionsForDefaultContext:e.map(a.actionsForDefaultContext,h),actionsForMinimalContext:e.map(a.actionsForMinimalContext,h)}});d.registerUserNotificationSettings(b,c,{types:g,categories:i})},a.prototype._initialize=function(a,b){var c=this;if(this.isInitializing)return void b(new f.EverliveError({message:"Push notifications are currently initializing."}));if(!(this.emulatorMode||window.navigator&&window.navigator.globalization))return void b(new f.EverliveError({message:"The globalization plugin is not initialized."}));if(!(this.emulatorMode||window.plugins&&window.plugins.pushNotification))return void b(new f.EverliveError({message:"The push notifications plugin is not initialized."}));if(this._initSuccessCallback=a,this._initErrorCallback=b,this.isInitialized)return void this._deviceRegistrationSuccess(this.pushToken);if(this.emulatorMode)return void setTimeout(function(){c._deviceRegistrationSuccess("fake_push_token")},1e3);this.isInitializing=!0;var d=this._globalFunctionSuffix;d||(d=Date.now().toString(),this._globalFunctionSuffix=d);var g=window.plugins.pushNotification,h=this._getPlatformType();if(h===i.iOS){var j="apnCallback_"+d;Everlive.PushCallbacks[j]=e.bind(this._onNotificationAPN,this);var k=this.pushSettings.iOS;k.ecb="Everlive.PushCallbacks."+j,g.register(e.bind(this._successfulRegistrationAPN,this),e.bind(this._failedRegistrationAPN,this),k)}else if(h===i.Android){var l="gcmCallback_"+d;Everlive.PushCallbacks[l]=e.bind(this._onNotificationGCM,this);var m=this.pushSettings.android;this._validateAndroidSettings(m),m.ecb="Everlive.PushCallbacks."+l,g.register(e.bind(this._successSentRegistrationGCM,this),e.bind(this._errorSentRegistrationGCM,this),m)}else{if(h!==i.WindowsPhone)throw new f.EverliveError({message:"The current platform is not supported: "+device.platform});var n="wp8Callback_"+d,o="wp8RegistrationSuccessCallback_"+d,p="wp8RegistrationErrorCallback_"+d;Everlive.PushCallbacks[n]=e.bind(this._onNotificationWP8,this),Everlive.PushCallbacks[o]=e.bind(this._deviceRegistrationSuccessWP,this),Everlive.PushCallbacks[p]=e.bind(this._deviceRegistrationFailed,this);var q=this.pushSettings.wp8;this._validateWP8Settings(q),q.ecb="Everlive.PushCallbacks."+n,q.uccb="Everlive.PushCallbacks."+o,q.errcb="Everlive.PushCallbacks."+p,g.register(e.bind(this._successSentRegistrationWP8,this),e.bind(this._errorSentRegistrationWP8,this),q)}},a.prototype._deviceRegistrationSuccessWP=function(a){this._deviceRegistrationSuccess(a.uri)},a.prototype._validateAndroidSettings=function(a){if(!a.senderID)throw new f.EverliveError({message:"Sender ID (project number) is not set in the android settings."})},a.prototype._validateWP8Settings=function(a){if(!a.channelName)throw new f.EverliveError({message:"channelName is not set in the WP8 settings."})},a.prototype._cleanPlatformsPushSettings=function(a){var b={};a=a||{};var c=function(b,c,d){if(a[c]){b[c]=b[c]||{};var f=a[c],g=b[c];e.each(d,function(a){f.hasOwnProperty(a)&&(g[a]=f[a])})}};c(b,"iOS",["badge","sound","alert","interactiveSettings"]),c(b,"android",["senderID","projectNumber"]),c(b,"wp8",["channelName"]);var d=["notificationCallbackAndroid","notificationCallbackIOS","notificationCallbackWP8"];return e.each(d,function(c){var d=a[c];if(d){if("function"!=typeof d)throw new f.EverliveError({message:'The "'+c+'" of the push settings should be a function'});b[c]=a[c]}}),a.customParameters&&(b.customParameters=a.customParameters),b},a.prototype._populateRegistrationObject=function(a,b,c){var e=this;return j(function(b,c){if(!e.pushToken)throw new f.EverliveError({message:"Push token is not available."});e._getLocaleName(function(c){var f=e._getDeviceId(),g=device.model,h=e._getPlatformType(),i=d.jstz.determine().name(),j=e.pushToken,k=c.value,l=device.version;a.HardwareId=f,a.HardwareModel=g,a.PlatformType=h,a.PlatformVersion=l,a.TimeZone=i,a.PushToken=j,a.Locale=k,b()},c)},b,c)},a.prototype._getLocaleName=function(a,b){this.emulatorMode?a({value:"en_US"}):(navigator.globalization.getLocaleName(function(b){a(b)},b),navigator.globalization.getLocaleName(function(){},b))},a.prototype._getDeviceId=function(){return device.uuid},a.prototype._getPlatformType=function(){var a=device.platform.toLowerCase();switch(a){case"ios":case"iphone":case"ipad":return i.iOS;case"android":return i.Android;case"wince":return i.WindowsPhone;case"win32nt":return i.WindowsPhone;default:return i.Unknown}},a.prototype._deviceRegistrationFailed=function(a){this.pushToken=null,this.isInitializing=!1,this.isInitialized=!1,this._initErrorCallback&&this._initErrorCallback({error:a})},a.prototype._deviceRegistrationSuccess=function(a){this.pushToken=a,this.isInitializing=!1,this.isInitialized=!0,this._initSuccessCallback&&this._initSuccessCallback({token:a})},a.prototype._successfulRegistrationAPN=function(a){var b=this;this.pushSettings.iOS&&this.pushSettings.iOS.interactiveSettings?this._initializeInteractivePush(this.pushSettings.iOS,function(){b._deviceRegistrationSuccess(a)},function(a){throw new f.EverliveError({message:"The interactive push configuration is incorrect: "+a})}):this._deviceRegistrationSuccess(a)},a.prototype._failedRegistrationAPN=function(a){this._deviceRegistrationFailed(a)},a.prototype._successSentRegistrationGCM=function(){},a.prototype._successSentRegistrationWP8=function(){},a.prototype._errorSentRegistrationWP8=function(a){this._deviceRegistrationFailed(a)},a.prototype._errorSentRegistrationGCM=function(a){this._deviceRegistrationFailed(a)},a.prototype._onNotificationAPN=function(a){this._raiseNotificationEventIOS(a)},a.prototype._onNotificationWP8=function(a){this._raiseNotificationEventWP8(a)},a.prototype._onNotificationGCM=function(a){switch(a.event){case"registered":a.regid.length>0&&this._deviceRegistrationSuccess(a.regid);break;case"message":this._raiseNotificationEventAndroid(a);break;case"error":this.pushToken?this._raiseNotificationEventAndroid(a):this._deviceRegistrationFailed(a);break;default:this._raiseNotificationEventAndroid(a)}},a.prototype._raiseNotificationEventAndroid=function(a){this.pushSettings.notificationCallbackAndroid&&this.pushSettings.notificationCallbackAndroid(a)},a.prototype._raiseNotificationEventIOS=function(a){this.pushSettings.notificationCallbackIOS&&this.pushSettings.notificationCallbackIOS(a)},a.prototype._raiseNotificationEventWP8=function(a){this.pushSettings.notificationCallbackWP8&&this.pushSettings.notificationCallbackWP8(a)},a}();a.exports=k},function(a,b,c){"use strict";var d,e=c(1),f=c(133),g=c(3),h=c(2),i=c(4);try{d=c(219)}catch(j){throw j}var k=h.Constants.Platform,l=i.Utils.buildPromise,m=function(){function a(a){this._pushHandler=a,this._initSuccessCallback=null,this._initErrorCallback=null,this._globalFunctionSuffix=null,this.pushSettings=null,this.pushToken=null,this.isInitialized=!1,this.isInitializing=!1,this.emulatorMode=!1}return Object.defineProperty(a.prototype,"pushPlugin",{get:function(){try{return c(216)}catch(a){throw a}},enumerable:!0,configurable:!0}),a.prototype.enableNotifications=function(a,b,c){return this.pushSettings=this._cleanPlatformsPushSettings(a),l(e.bind(this._initialize,this),b,c)},a.prototype.disableNotifications=function(a,b){var c=this;return this.unregister().then(function(){return l(function(a,b){var d=function(){c.isInitialized=!1,a()},e=c._getPlatformType();return e===k.Android?this.pushPlugin.unregister(d,b,c.pushSettings.android):void this.pushPlugin.unregister(d,b)},a,b)},b)},a.prototype.getRegistration=function(a,b){var c=encodeURIComponent(this._getDeviceId());return this._pushHandler.devices.getById("HardwareId/"+c,a,b)},a.prototype.register=function(a,b,c){var d=this,e={};return void 0!==a&&(e.Parameters=a),this._populateRegistrationObject(e).then(function(){return d._pushHandler.devices.create(e,b,c)},c)},a.prototype.unregister=function(a,b){var c=encodeURIComponent(this._getDeviceId());return this._pushHandler.devices.destroySingle({Id:"HardwareId/"+c},a,b)},a.prototype.updateRegistration=function(a,b,c){var d=this,e={};return void 0!==a&&(e.Parameters=a),this._populateRegistrationObject(e).then(function(){return e.Id="HardwareId/"+encodeURIComponent(e.HardwareId),d._pushHandler.devices.updateSingle(e,b,c)},c)},a.prototype.areNotificationsEnabled=function(a,b,c){return a=a||{},l(function(b,c){this.pushPlugin.areNotificationsEnabled(b,c,a)},b,c)},a.prototype._initializeInteractivePush=function(a,b,c){this.pushPlugin.registerUserNotificationSettings(b,c)},a.prototype._initialize=function(a,b){if(this.isInitializing)return void b(new g.EverliveError({message:"Push notifications are currently initializing."}));if(this._initSuccessCallback=a,this._initErrorCallback=b,this.isInitialized)return void this._deviceRegistrationSuccess(this.pushToken);this.isInitializing=!0;var c=this._globalFunctionSuffix;c||(c=Date.now().toString(),this._globalFunctionSuffix=c);var f=this._getPlatformType();if(f===k.iOS){var h=this.pushSettings.iOS;h.notificationCallbackIOS=this.pushSettings.notificationCallbackIOS,this.pushPlugin.register(h,e.bind(this._successfulRegistrationAPN,this),e.bind(this._failedRegistrationAPN,this))}else{if(f!==k.Android)throw new g.EverliveError({message:"The current platform is not supported: "+d.device.os});var i=this.pushSettings.android;this._validateAndroidSettings(i),i.notificationCallbackAndroid=this.pushSettings.notificationCallbackAndroid,this.pushPlugin.register(i,e.bind(this._successSentRegistrationGCM,this),e.bind(this._errorSentRegistrationGCM,this))}},a.prototype._validateAndroidSettings=function(a){if(!a.senderID)throw new g.EverliveError({message:"Sender ID (project number) is not set in the android settings."})},a.prototype._cleanPlatformsPushSettings=function(a){var b={};a=a||{};var c=function(b,c,d){if(a[c]){b[c]=b[c]||{};var f=a[c],g=b[c];e.each(d,function(a){f.hasOwnProperty(a)&&(g[a]=f[a])})}};c(b,"iOS",["badge","sound","alert","interactiveSettings"]),c(b,"android",["senderID","projectNumber"]);var d=["notificationCallbackAndroid","notificationCallbackIOS"];return e.each(d,function(c){var d=a[c];if(d){if("function"!=typeof d)throw new g.EverliveError({message:'The "'+c+'" of the push settings should be a function'});b[c]=a[c]}}),a.customParameters&&(b.customParameters=a.customParameters),b},a.prototype._populateRegistrationObject=function(a,b,c){var e=this;return l(function(b,c){if(!e.pushToken)throw new g.EverliveError({message:"Push token is not available."});e._getLocaleName(function(){var c=e._getDeviceId(),g=d.device.model,h=e._getPlatformType(),i=f.jstz.determine().name(),j=e.pushToken,k="en_US",l=d.device.osVersion;a.HardwareId=c,a.HardwareModel=g,a.PlatformType=h,a.PlatformVersion=l,a.TimeZone=i,a.PushToken=j,a.Locale=k,b()},c)},b,c)},a.prototype._getLocaleName=function(a){return a()},a.prototype._getDeviceId=function(){return d.device.uuid},a.prototype._getPlatformType=function(){var a=d.device.os.toLowerCase();switch(a){case"ios":case"iphone":case"ipad":return k.iOS;case"android":return k.Android;default:return k.Unknown}},a.prototype._deviceRegistrationFailed=function(a){this.pushToken=null,this.isInitializing=!1,this.isInitialized=!1,this._initErrorCallback&&this._initErrorCallback({error:a})},a.prototype._deviceRegistrationSuccess=function(a){this.pushToken=a,this.isInitializing=!1,this.isInitialized=!0,this._initSuccessCallback&&this._initSuccessCallback({token:a})},a.prototype._successfulRegistrationAPN=function(a){var b=this;this.pushSettings.iOS&&this.pushSettings.iOS.interactiveSettings?this._initializeInteractivePush(this.pushSettings.iOS,function(){b._deviceRegistrationSuccess(a)},function(a){throw new g.EverliveError({message:"The interactive push configuration is incorrect: "+a})}):this._deviceRegistrationSuccess(a)},a.prototype._failedRegistrationAPN=function(a){this._deviceRegistrationFailed(a)},a.prototype._successSentRegistrationGCM=function(a){this.pushPlugin.onMessageReceived(this.pushSettings.notificationCallbackAndroid),this._deviceRegistrationSuccess(a)},a.prototype._errorSentRegistrationGCM=function(a){this._deviceRegistrationFailed(a)},a.prototype.notificationProcessed=function(){throw new Error("Not implemented")},a.prototype._onNotificationAPN=function(a){this._raiseNotificationEventIOS(a)},a.prototype._onNotificationGCM=function(a){switch(a.event){case"registered":a.regid.length>0&&this._deviceRegistrationSuccess(a.regid);break;case"message":this._raiseNotificationEventAndroid(a);break;case"error":this.pushToken?this._raiseNotificationEventAndroid(a):this._deviceRegistrationFailed(a);break;default:this._raiseNotificationEventAndroid(a)}},a.prototype._raiseNotificationEventAndroid=function(a){this.pushSettings.notificationCallbackAndroid&&this.pushSettings.notificationCallbackAndroid(a)},a.prototype._raiseNotificationEventIOS=function(a){this.pushSettings.notificationCallbackIOS&&this.pushSettings.notificationCallbackIOS(a)},a.ensurePushIsAvailable=function(){},a}();a.exports=m},function(a,b,c){"use strict";function d(a){return f.extend(b.RequestOptionsBuilder._buildBaseObject(a),{method:"DELETE"})}function e(a){return b.RequestOptionsBuilder._build(a,a.additionalOptions)}var f=c(1),g=c(9),h=c(8),i=c(10);b.RequestOptionsBuilder=(j={_buildEndpointUrl:function(a){var b=a.collectionName,c=a.additionalOptions&&void 0!==a.additionalOptions.id,d=typeof a.query;return c?b=g.join(b,a.additionalOptions.id.toString()):("string"===d||"number"===d)&&(b=g.join(b,a.query)),b},_buildBaseObject:function(a){var c={endpoint:b.RequestOptionsBuilder._buildEndpointUrl(a),query:a.query,data:a.data,headers:a.headers};return a.parse&&(c.parse=a.parse),c},_build:function(a,c){var d=f.extend(b.RequestOptionsBuilder._buildBaseObject(a),c);

return c.endpointSupplement&&(d.endpoint=g.join(d.endpoint,c.endpointSupplement)),d}},j[h.DataQueryOperation.Read]=function(a){return b.RequestOptionsBuilder._build(a,{method:"GET"})},j[h.DataQueryOperation.ReadById]=function(a){return b.RequestOptionsBuilder._build(a,{method:"GET"})},j[h.DataQueryOperation.Count]=function(a){return b.RequestOptionsBuilder._build(a,{method:"GET",endpoint:a.collectionName+"/_count"})},j[h.DataQueryOperation.Create]=function(a){return b.RequestOptionsBuilder._build(a,{method:"POST"})},j[h.DataQueryOperation.RawUpdate]=function(a){var c=a.query,d="object"==typeof c?c:null;return b.RequestOptionsBuilder._build(a,{method:"PUT",query:d})},j[h.DataQueryOperation.Update]=function(a){return b.RequestOptionsBuilder._build(a,{method:"PUT"})},j[h.DataQueryOperation.Delete]=function(a){return d(a)},j[h.DataQueryOperation.DeleteById]=function(a){return d(a)},j[h.DataQueryOperation.SetAcl]=function(a){var c,d;return null===a.additionalOptions.acl?c="DELETE":(c="PUT",d=a.additionalOptions.acl),b.RequestOptionsBuilder._build(a,{method:c,endpointSupplement:"/_acl",data:d})},j[h.DataQueryOperation.SetOwner]=function(a){return b.RequestOptionsBuilder._build(a,{method:"PUT",endpointSupplement:"/_owner"})},j[h.DataQueryOperation.UserLogin]=function(a){return b.RequestOptionsBuilder._build(a,{method:"POST",endpoint:"oauth/token",authHeaders:!1,parse:i.Request.parsers.single})},j[h.DataQueryOperation.UserLogout]=function(a){return b.RequestOptionsBuilder._build(a,{method:"GET",endpoint:"oauth/logout"})},j[h.DataQueryOperation.UserChangePassword]=function(a){var c=a.additionalOptions.keepTokens,d="Users/changepassword";return c&&(d+="?keepTokens=true"),b.RequestOptionsBuilder._build(a,{method:"POST",endpoint:d,parse:i.Request.parsers.single})},j[h.DataQueryOperation.UserLoginWithProvider]=function(a){return b.RequestOptionsBuilder._build(a,{method:"POST",authHeaders:!1})},j[h.DataQueryOperation.UserLinkWithProvider]=function(a){return b.RequestOptionsBuilder._build(a,{method:"POST",endpoint:b.RequestOptionsBuilder._buildEndpointUrl(a)+"/link"})},j[h.DataQueryOperation.UserUnlinkFromProvider]=function(a){return b.RequestOptionsBuilder._build(a,{method:"POST",endpoint:b.RequestOptionsBuilder._buildEndpointUrl(a)+"/unlink"})},j[h.DataQueryOperation.UserResetPassword]=function(a){return b.RequestOptionsBuilder._build(a,{method:"POST",endpoint:b.RequestOptionsBuilder._buildEndpointUrl(a)+"/resetpassword"})},j[h.DataQueryOperation.UserSetPassword]=function(a){return b.RequestOptionsBuilder._build(a,{method:"POST",endpoint:b.RequestOptionsBuilder._buildEndpointUrl(a)+"/setpassword"})},j[h.DataQueryOperation.FilesUpdateContent]=function(a){return b.RequestOptionsBuilder._build(a,{method:"PUT",endpoint:b.RequestOptionsBuilder._buildEndpointUrl(a)+"/Content"})},j[h.DataQueryOperation.FilesGetDownloadUrlById]=function(a){return b.RequestOptionsBuilder._build(a,{method:"GET"})},j[h.DataQueryOperation.Aggregate]=function(a){return b.RequestOptionsBuilder._build(a,{method:"GET",endpoint:a.collectionName+"/_aggregate"})},j[h.DataQueryOperation.InvokeCloudFunction]=function(a){return e(a)},j[h.DataQueryOperation.InvokeStoredProcedure]=function(a){return e(a)},j);var j},function(a,b,c){"use strict";function d(a,b){return e.isNativeScript?new g.NativeScriptFileStore(a,b):e.isCordova||e.isDesktop?new f.WebFileStore(a,b):{}}var e=c(5),f=c(82),g=c(80);b.getFileStore=d},function(a,b,c){"use strict";function d(a){if(e.isNativeScript){var b;try{b=c(212)}catch(d){try{b=c(215)}catch(f){throw f}}return{getItem:function(a){return b.getString(a)},removeItem:function(a){return b.remove(a)},setItem:function(a,c){return b.setString(a,c)}}}var g;if(e.isNodejs){var h=null;try{h=c(218).LocalStorage}catch(d){throw d}g=new h(a.storage.storagePath)}else g=window.localStorage;return{getItem:function(a){return g.getItem(a)},removeItem:function(a){return g.removeItem(a)},setItem:function(a,b){return g.setItem(a,b)}}}var e=c(5),f=function(){function a(a){this.options=a,this._localStorage=d(this.options)}return a.prototype.getItem=function(a){return this._localStorage.getItem(a)},a.prototype.removeItem=function(a){return this._localStorage.removeItem(a)},a.prototype.setItem=function(a,b){return this._localStorage.setItem(a,b)},a}();b.LocalStore=f},function(a,b,c){"use strict";var d=c(1),e=c(2),f=c(3),g=function(){function a(a,b){this.storagePath=a,this.typeSettings=b,this.batchSize=5e3,this.specialFields={}}return a.prototype.queryData=function(){throw new f.EverliveError({message:"The method queryData is not implemented"})},a.prototype.addData=function(){throw new f.EverliveError({message:"The method addData is not implemented"})},a.prototype.removeData=function(){throw new f.EverliveError({message:"The method removeData is not implemented"})},a.prototype.updateData=function(){throw new f.EverliveError({message:"The method updateData is not implemented"})},a.prototype.ensureTableExists=function(){throw new f.EverliveError({message:"The method ensureTableExists is not implemented"})},a.prototype.buildSqlBatchInsert=function(a,b){var c=this;if(d.isArray(b)||(b=[b]),0===b.length)return[];var f=this.typeSettings[a],g=d.map(f,function(a){return a.name}),h=this.buildInsertStatement(a,g),i=1,j=0,k=[];return k[j]=[],d.each(b,function(b){var f=d.map(g,function(d){return b[d]instanceof Date?b[d].toISOString():c.specialFields[a][d]&&b[d]?JSON.stringify(b[d]):b[d]});f.push(b[e.Constants.offlineItemsStateMarker]),k[j].push([h,f]),i++,i%c.batchSize==0&&(j++,k[j]=[])}),k},a.prototype.buildInsertStatement=function(a,b){var c="",f="";d.each(b,function(a){c+='"'+a+'",',f+="?,"}),c+=e.Constants.offlineItemsStateMarker,f+="?";var g='INSERT OR REPLACE INTO "'+a+'" ( '+c+" ) VALUES ( "+f+" ) ";return g},a.prototype.prepareTables=function(){var a=this;d.each(this.typeSettings,function(b,c){a.ensureTableExists(c,b),a.findSpecialFields(c,b)})},a.prototype.processResultItem=function(a,b){return d.each(this.specialFields[a],function(a,c){if(b[c])try{b[c]="true"===b[c]||"false"===b[c]?"true"===b[c]:JSON.parse(b[c])}catch(d){console.error(d)}}),b},a.prototype.findSpecialFields=function(a,b){var c=this;this.specialFields[a]={},d.each(b,function(b){b.isSpecialType&&(c.specialFields[a][b.name]=!0)})},a}();b.BaseSQLiteStore=g},function(a){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
function b(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function c(a){return"function"==typeof a}function d(a){return"number"==typeof a}function e(a){return"object"==typeof a&&null!==a}function f(a){return void 0===a}a.exports=b,b.EventEmitter=b,b.prototype._events=void 0,b.prototype._maxListeners=void 0,b.defaultMaxListeners=10,b.prototype.setMaxListeners=function(a){if(!d(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},b.prototype.emit=function(a){var b,d,g,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||e(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(d=this._events[a],f(d))return!1;if(c(d))switch(arguments.length){case 1:d.call(this);break;case 2:d.call(this,arguments[1]);break;case 3:d.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),d.apply(this,h)}else if(e(d))for(h=Array.prototype.slice.call(arguments,1),j=d.slice(),g=j.length,i=0;g>i;i++)j[i].apply(this,h);return!0},b.prototype.addListener=function(a,d){var g;if(!c(d))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,c(d.listener)?d.listener:d),this._events[a]?e(this._events[a])?this._events[a].push(d):this._events[a]=[this._events[a],d]:this._events[a]=d,e(this._events[a])&&!this._events[a].warned&&(g=f(this._maxListeners)?b.defaultMaxListeners:this._maxListeners,g&&g>0&&this._events[a].length>g&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(a,b){function d(){this.removeListener(a,d),e||(e=!0,b.apply(this,arguments))}if(!c(b))throw TypeError("listener must be a function");var e=!1;return d.listener=b,this.on(a,d),this},b.prototype.removeListener=function(a,b){var d,f,g,h;if(!c(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(d=this._events[a],g=d.length,f=-1,d===b||c(d.listener)&&d.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(e(d)){for(h=g;h-->0;)if(d[h]===b||d[h].listener&&d[h].listener===b){f=h;break}if(0>f)return this;1===d.length?(d.length=0,delete this._events[a]):d.splice(f,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},b.prototype.removeAllListeners=function(a){var b,d;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(d=this._events[a],c(d))this.removeListener(a,d);else if(d)for(;d.length;)this.removeListener(a,d[d.length-1]);return delete this._events[a],this},b.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?c(this._events[a])?[this._events[a]]:this._events[a].slice():[]},b.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(c(b))return 1;if(b)return b.length}return 0},b.listenerCount=function(a,b){return a.listenerCount(b)}},function(a){"use strict";var b={};b.DefaultTakeItemsCount=50,b.ExpandExpressionName="Expand",b.ReturnAsFieldName="ReturnAs",b.FieldsExpressionName="Fields",b.SingleFieldExpressionName="SingleField",b.SortExpressionName="Sort",b.FilterExpressionName="Filter",b.SkipExpressionName="Skip",b.TakeExpressionName="Take",b.ParentRelationFieldName="ParentRelationField",b.IdFieldNameClient="Id",b.TargetTypeNameFieldName="TargetTypeName",b.ReturnItemsCountFieldName="ReturnItemsCount",b.AggregateExpressionFieldName="Aggregate",a.exports=b},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(40),f=c(1),g=function(){function a(){this.canceled=!1}return a.prototype.cancel=function(){this.canceled=!0},a}(),h=function(a){function b(){a.apply(this,arguments)}return d(b,a),b.prototype.emit=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];return c.push(new g),a.prototype.emit.apply(this,[b].concat(c))},b.prototype.addListener=function(b,c){var d=this,e=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];var e=f.last(a);return e.canceled?void 0:c.apply(d,a)};return a.prototype.addListener.call(this,b,e),this},b.prototype.prependOnceListener=function(a,b){if(this.once(a,b),!Array.isArray(this._events[a]))return this;var c=f.last(this._events[a]),d=f.without(this._events[a],c);return this._events[a]=[c].concat(d),this},b.prototype.once=function(b,c){return a.prototype.once.call(this,b,c),this},b.prototype.on=function(a,b){return this.addListener(a,b),this},b.prototype.off=function(a,b){return this.removeListener(a,b),this},b}(e.EventEmitter);b.EventEmitterExtended=h},function(a,b){"use strict";var c=function(){function a(){}return a}();b.Query=c},function(a,b,c){"use strict";var d=c(1),e=c(5),f=function(){function a(){}return a.guardUnset=function(a,b,c){if(c||(c="The "+b+" is required"),"undefined"==typeof a||null===a)throw new Error(c)},a.isGuid=function(a){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)},a.cloneDate=function(a){return new Date(a)},a.buildPromise=function(b,c,d){var e=a.getCallbacks(c,d);return b(e.success,e.error),e.promise},a.getCallbacks=function(a,b){var c,d=function(){return new Promise(function(c,d){a=function(a){c(a)},b=function(a){d(a)}})};if(e.isNodejs)if("function"==typeof a&&"function"!=typeof b){var f=a;a=function(a,b){f(null,a,b)},b=function(a){f(a)}}else"function"!=typeof a&&"function"!=typeof b&&(c=d());else"function"!=typeof a&&"function"!=typeof b&&(c=d());return{promise:c,success:a,error:b}},a.isDate=function(a){return a&&(a instanceof Date||!d.isNaN(Date.parse(a)))},a.successfulPromise=function(a){return new Promise(function(b){b(a)})},a.rejectedPromise=function(a){return new Promise(function(b,c){c(a)})},a.uuid=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b},a.parseUtilities={getReviver:function(b){var c;return c=b?a.parseUtilities.parseIsoDateString:a.parseUtilities.parseOnlyCompleteDateTimeString,function(a,b){if("string"==typeof b){var d=c(b);d&&(b=d)}return b}},parseIsoDateString:function(a){var b;if(b=a.match(/^(\d{4})(-(\d{2})(-(\d{2})(T(\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|((\+|-)(\d{2}):(\d{2}))))?))$/)){var c=b[12];c&&(c.length>3?c=Math.round(Number(c.substr(0,3)+"."+c.substr(3))):c.length<3&&(c+=2===c.length?"0":"00"));var d=new Date(Date.UTC(Number(b[1]),Number(b[3])-1||0,Number(b[5])||0,Number(b[7])||0,Number(b[8])||0,Number(b[10])||0,Number(c)||0));if(b[13]&&"Z"!==b[13]){var e=Number(b[16])||0,f=Number(b[17])||0;e*=36e5,f*=6e4;var g=e+f;"+"===b[15]&&(g=-g),d=new Date(d.valueOf()+g)}return d}return null},parseOnlyCompleteDateTimeString:function(b){return/^\d{4}-\d{2}-\d{2}$/.test(b)?null:/^(\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|((\+|-)(\d{2}):(\d{2})))?$/.test(b)?null:a.parseUtilities.parseIsoDateString(b)},traverse:function(b,c){var d,e,f;for(d in b)b.hasOwnProperty(d)&&(e=b[d],f=c(d,e),b[d]=f,e===f&&"object"==typeof e&&a.parseUtilities.traverse(e,c));return b},traverseAndRevive:function(b,c){return c||(c=a.parseUtilities.getReviver()),a.parseUtilities.traverse(b,c)},parseError:function(a,b){if(!("string"==typeof b&&b.length>0))return b;try{return b=JSON.parse(b),{message:b.message,code:b.errorCode}}catch(c){return b}},_parseInternal:function(b,c){return"string"==typeof c&&c.length>0?c=JSON.parse(c,b):"object"==typeof c&&a.parseUtilities.traverseAndRevive(c,b),c},_transformResult:function(a,b){if(a){var c=d.extend({},b);return c.result=void 0===a.Result?a.result:a.Result,c.count=void 0===a.Count?a.count:a.Count,c}return a},parseResult:function(b,c){return c=a.parseUtilities._parseInternal.apply(null,arguments),a.parseUtilities._transformResult(c,{count:c.Count})},parseSingleResult:function(b,c){return c=a.parseUtilities._parseInternal.apply(null,arguments),a.parseUtilities._transformResult(c)},parseUpdateResult:function(b,c){return c=a.parseUtilities._parseInternal.apply(null,arguments),a.parseUtilities._transformResult(c,{ModifiedAt:c.ModifiedAt})},parseJSON:function(b){return JSON.parse(b,a.parseUtilities.getReviver())},parseXhrResponse:function(b){var c=b.getResponseHeader("content-type"),d=c&&c.toLowerCase().indexOf("json")>-1,e=b.responseText||b.statusText;return d?a.parseUtilities.parseJSON(e):e},parseXhrError:function(b,c){if(c instanceof Error)return c;var d=c.responseText||c.statusText||c;return a.parseUtilities.parseError(b,d)},parseErrorOrResponse:function(b){if(b instanceof XMLHttpRequest){var c=a.parseUtilities.parseXhrResponse(b);return{code:c.code||c.errorCode,message:c.message}}return a.parseUtilities.parseError(null,b)}},a}();b.Utils=f},function(a,b,c){"use strict";var d=c(1),e=c(3),f=c(2),g=function(){function a(a){var b=a||f.Constants.MaxConcurrentDownloadTasks;if(this.maxConcurrentTasks=parseInt(b+"",10),d.isNaN(this.maxConcurrentTasks)||0>=a)throw new e.EverliveError({message:"The maxConcurrentTasks must be a number larger than 0"});this.runningTasksCount=0,this.tasks=[]}return a.prototype.enqueue=function(a,b,c){this.tasks.push({task:a,args:[].splice.call(arguments,3),success:b,error:c}),this.runNext()},a.prototype.runNext=function(){var a=this;if(a.runningTasksCount!==a.maxConcurrentTasks&&a.tasks.length){a.runningTasksCount++;var b=this.tasks.shift(),c=b.task,d=b.args,e=b.success,f=b.error;d.unshift(function(b){a.runningTasksCount--,b?f(b):e.apply(null,[].splice.call(arguments,1)),a.runNext()}),c.apply(null,d)}},a}();b.AutoQueue=g},function(a,b,c){"use strict";var d=c(209),e=c(14),f=c(6),g=c(21),h=c(2);b.expandProcessor=new d({executionNodeFunction:function(a,b,c){var d,i=a.targetTypeName.toLowerCase()===h.Constants.FilesTypeNameLegacy?h.Constants.FilesTypeName:a.targetTypeName;d=new e.DataQuery(a.aggregate?{operation:e.DataQuery.operations.Aggregate,meta:{collectionName:i},query:new g.AggregateQuery(a.filter,a.select,a.sort,a.skip,a.take,null,a.aggregate)}:{operation:e.DataQuery.operations.Read,meta:{collectionName:i},query:new f.Query(a.filter,a.select,a.sort,a.skip,a.take)}),b.offlineModule.processQuery(d).then(function(a){c(null,a.result)},c)}})},function(a,b,c){"use strict";var d=c(4),e=c(3),f=c(72),g=c(2),h=d.Utils.buildPromise,i=g.Constants.Platform,j=function(){function a(a){this.el=a,this.notifications=a.data(g.Constants.Push.NotificationsType),this.devices=a.data(g.Constants.Push.DevicesType)}return a.prototype.ensurePushIsAvailable=function(){f.ensurePushIsAvailable()},a.prototype.currentDevice=function(a){return void 0===a&&(a=!1),this.ensurePushIsAvailable(),0===arguments.length&&(a=this.el.setup._emulatorMode),this._currentDevice||(this._currentDevice=f.getCurrentDevice(this)),this._currentDevice.emulatorMode=a||d.Utils._inAppBuilderSimulator(),this._currentDevice},a.prototype.register=function(a,b,c){this.ensurePushIsAvailable();var f=this.currentDevice(),g=this;a=a||{},a.android&&(a.android.senderID=a.android.projectNumber||a.android.senderID);var j=function(a,b){var c=new d.DeviceRegistrationResult(a);b(c)},k=function(a,b){var c=e.DeviceRegistrationError.fromEverliveError(a);b(c)},l=function(b,c,d){var e=f._getPlatformType(),h=e===i.iOS;h&&a.iOS&&(h=a.iOS.clearBadge!==!1),h?g.clearBadgeNumber().then(function(){j(b,c)},function(a){k(a,d)}):j(b,c)};return h(function(b,c){f.enableNotifications(a,function(d){var e=d.token,g=a.customParameters;f.getRegistration().then(function(){f.updateRegistration(g,function(){l(e,b,c)},function(a){k(a,c)})},function(a){801===a.code?f.register(g,function(){l(e,b,c)},c):k(a,c)})},function(a){var b=e.DeviceRegistrationError.fromPluginError(a);c(b)})},b,c)},a.prototype.unregister=function(){this.ensurePushIsAvailable();var a=this.currentDevice();return a.disableNotifications.apply(a,arguments)},a.prototype.updateRegistration=function(){this.ensurePushIsAvailable();var a=this.currentDevice();return a.updateRegistration.apply(a,arguments)},a.prototype.setBadgeNumber=function(a,b,c){if(this.ensurePushIsAvailable(),a=parseInt(a),isNaN(a))return h(function(a,b){b(new e.EverliveError({message:"The badge must have a numeric value"}))},b,c);var f={},g=this.currentDevice(),i=g._getDeviceId();return f.Id="HardwareId/"+encodeURIComponent(i),f.BadgeCounter=a,h(function(b,c){g._pushHandler.devices.updateSingle(f).then(function(){return"undefined"!=typeof window&&window.plugins&&window.plugins.pushNotification&&!d.Utils._inAppBuilderSimulator()?window.plugins.pushNotification.setApplicationIconBadgeNumber(b,c,a):b()},c)},b,c)},a.prototype.clearBadgeNumber=function(a,b){return this.ensurePushIsAvailable(),this.setBadgeNumber(0,a,b)},a.prototype.getRegistration=function(){this.ensurePushIsAvailable();var a=this.currentDevice();return a.getRegistration.apply(a,arguments)},a.prototype.send=function(){return this.notifications.create.apply(this.notifications,arguments)},a.prototype.areNotificationsEnabled=function(a,b,c){this.ensurePushIsAvailable();var d=this.currentDevice();return d.areNotificationsEnabled(a,b,c)},a.prototype.notificationProcessed=function(){this.ensurePushIsAvailable();var a=this.currentDevice();a.notificationProcessed()},a}();b.Push=j},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(140),g=c(2),h=c(50),i=function(a){function b(b){a.call(this),this._emulatorMode=!1,this.url=g.Constants.everliveUrl,this.appId=null,this.masterKey=null,this.token=null,this.tokenType=null,this.principalId=null,this.scheme="http",this.parseOnlyCompleteDateTimeObjects=!1,"string"==typeof b?this.appId=b:(this._emulatorMode=b.emulatorMode,e.extend(this,b),b.apiKey&&(this.appId=b.apiKey)),this.authentication=new h.AuthenticationSetup(this,b.authentication)}return d(b,a),b.prototype.setAuthorizationProperties=function(a,b,c){this.token=a,this.tokenType=b,this.principalId=c},b.prototype.getAuthorizationProperties=function(){return{token:this.token,tokenType:this.tokenType,principalId:this.principalId}},b}(f.CommonSetup);b.Setup=i},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(8),f=c(4),g=c(2),h=c(38),i=c(3),j=c(17),k=f.Utils.buildPromise,l=f.Utils.getCallbacks,m=function(a){function b(b){if(a.call(this,b,"Users"),this.authSetup=b.setup.authentication||{},this._authenticationCallbacks=null,this.authSetup.persist){this._localStore=new h.LocalStore(b);var c=this._getLocalStoreKey(),d=this._localStore.getItem(c),e=void 0;d&&(e=JSON.parse(this._localStore.getItem(c))),e&&this.sdk.setup.setAuthorizationProperties(e.token,e.tokenType,e.principalId)}}return d(b,a),b.prototype._getLocalStoreKey=function(){return g.Constants.AuthStoreKey+this.sdk.setup.appId+"$authentication"},b.prototype._ensureAuthentication=function(){if(!this.isAuthenticationInProgress())throw new Error("onAuthenticationRequired option of Everlive.CommonSetup.Authentication is required.");return this.isAuthenticating()?this._authenticationCallbacks.promise:(this.clearAuthorization(),this.authSetup.onAuthenticationRequired.call(this),this._authenticationCallbacks=l(),this._authenticationCallbacks.promise)},b.prototype._loginSuccess=function(a){var b=a.result;this.setAuthorization(b.access_token,b.token_type,b.principal_id)},b.prototype._logoutSuccess=function(){this.clearAuthorization()},b.prototype._loginWithProvider=function(a,b,c){var d=this,f={Identity:a},g=this.buildDataQuery(f,e.DataQueryOperation.UserLoginWithProvider);return k(function(a,b){return d.processDataQuery(g).then(function(b){return d._loginSuccess(b),a(b)})["catch"](b)},b,c)},b.prototype.login=function(a,b,c,d){var f=this,g="password",h={grant_type:g,username:a,password:b},i=this.buildDataQuery(h,e.DataQueryOperation.UserLogin);return k(function(a,b){return f.processDataQuery(i).then(function(b){return f._loginSuccess(b),a(b)})["catch"](b)},c,d)},b.prototype.logout=function(a,b){var c=this,d=this.buildDataQuery(null,e.DataQueryOperation.UserLogout);return k(function(a,b){return c.processDataQuery(d).then(function(){for(var b=[],d=0;d<arguments.length;d++)b[d-0]=arguments[d];return c._logoutSuccess(),a.apply(void 0,b)})["catch"](function(a){return 301===a.code&&c.clearAuthorization(),b(a)})},a,b)},b.prototype.loginWithFacebook=function(a,b,c){var d={Provider:"Facebook",Token:a};return this._loginWithProvider(d,b,c)},b.prototype.loginWithADFS=function(a,b,c){var d={Provider:"ADFS",Token:a};return this._loginWithProvider(d,b,c)},b.prototype.loginWithSAML=function(a,b,c){var d={Provider:"SAML",Token:a};return this._loginWithProvider(d,b,c)},b.prototype.loginWithLiveID=function(a,b,c){var d={Provider:"LiveID",Token:a};return this._loginWithProvider(d,b,c)},b.prototype.loginWithGoogle=function(a,b,c){var d={Provider:"Google",Token:a};return this._loginWithProvider(d,b,c)},b.prototype.loginWithTwitter=function(a,b,c,d){var e={Provider:"Twitter",Token:a,TokenSecret:b};return this._loginWithProvider(e,c,d)},b.prototype.setAuthorization=function(a,b,c){if(this.sdk.setup.setAuthorizationProperties(a,b,c),this.authSetup.persist){var d=this._getLocalStoreKey(),e=this.sdk.setup.getAuthorizationProperties();this._localStore.setItem(d,JSON.stringify(e))}this._authenticationCallbacks&&(this._authenticationCallbacks.success(),this._authenticationCallbacks=null)},b.prototype.clearAuthorization=function(){this.setAuthorization(null,null,null),this.clearPersistedAuthentication()},b.prototype.clearPersistedAuthentication=function(){if(this._localStore){var a=this._getLocalStoreKey();this._localStore.removeItem(a),this.sdk.setup.setAuthorizationProperties(null,null,null)}},b.prototype.isAuthenticationInProgress=function(){return"function"==typeof this.authSetup.onAuthenticationRequired},b.prototype.completeAuthentication=function(a){this.sdk.authentication.setAuthorization(a.access_token,a.token_type,a.principal_id)},b.prototype.getAuthenticationStatus=function(a,b){var c=this;return k(function(a,b){var d=c.sdk.setup;return d.masterKey?a({status:g.Constants.AuthStatus.masterKey}):d.token?c.isAuthenticationInProgress()?a({status:g.Constants.AuthStatus.authenticating}):c.sdk.users.skipAuth(!0).currentUser().then(function(b){return a({status:g.Constants.AuthStatus.authenticated,user:b.result})},function(d){return c.isAuthenticationInProgress()?a({status:g.Constants.AuthStatus.authenticating}):d.code===i.EverliveErrors.invalidRequest.code||d.code===i.EverliveErrors.invalidToken.code?a({status:g.Constants.AuthStatus.invalidAuthentication}):d.code===i.EverliveErrors.expiredToken.code?a({status:g.Constants.AuthStatus.expiredAuthentication}):b(d)}):a({status:g.Constants.AuthStatus.unauthenticated})},a,b)},b.prototype.isAuthenticating=function(){return!!this._authenticationCallbacks},b}(j.Data);Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=m},function(a,b){"use strict";var c=function(){function a(a,b){void 0===b&&(b={}),this.onAuthenticationRequired=b.onAuthenticationRequired,this.persist=b.persist,this.setup=a}return a}();b.AuthenticationSetup=c},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(9),f=c(1),g=c(2),h=c(3),i=c(8),j=c(4),k=c(102),l=function(a){function b(b){a.call(this,b,"BusinessLogic")}return d(b,a),b._isValidFuncName=function(a){return f.isString(a)&&""!==a},b.prototype.invokeCloudFunction=function(a,c,d,k){if(!b._isValidFuncName(a)){var l=new h.EverliveError(h.EverliveErrors.invalidOrMissingFunctionName);return j.Utils.callbackAndPromiseErrorResponse(l,k)}var m=f.extend({method:g.Constants.HttpMethod.GET,success:d,error:k},c);if(m.method.toUpperCase()===g.Constants.HttpMethod.GET&&f.size(m.data)){var l=new h.EverliveError(h.EverliveErrors.bodyWithGetRequestNotSupported);return j.Utils.callbackAndPromiseErrorResponse(l,k)}return m.endpoint=e.join(g.Constants.cloudFuncsEndpoint,a),this._invokeFunction(m,i.DataQueryOperation.InvokeCloudFunction)},b.prototype.invokeStoredProcedure=function(a,c,d,f){if(!b._isValidFuncName(a)){var k=new h.EverliveError(h.EverliveErrors.invalidOrMissingProcedureName);return j.Utils.callbackAndPromiseErrorResponse(k,f)}var l={method:g.Constants.HttpMethod.POST,endpoint:e.join(g.Constants.sqlProceduresEndpoint,a),data:c||{},success:d,error:f};return this._invokeFunction(l,i.DataQueryOperation.InvokeStoredProcedure)},b.prototype._invokeFunction=function(a,b){var c=a.customParameters,d=a.method,e=a.endpoint,g=a.success,h=a.error,i=f.extend({customParameters:c,method:d,endpoint:e,authHeaders:!0,isCustomRequest:!0},a),j=this.buildDataQuery({additionalOptions:i},b,{collectionName:this.collectionName});return this.processDataQuery(j,g,h)},b}(k.ProcessableObject);b.BusinessLogic=l},function(a,b,c){"use strict";var d=c(1),e=c(176),f=c(2),g=c(4),h=c(11),i=c(20),j=c(32),k=c(3),l=[f.DataQueryOperation.Read,f.DataQueryOperation.ReadById,f.DataQueryOperation.Count],m=function(){function a(a,b){this.options=a,this._everlive=b,this.typeSettings=this.options.typeSettings,this.maxAgeInMs=this.options.maxAgeInMs}return a.prototype._hash=function(a){return e(a)},a.prototype._initStore=function(a){if(!this.persister){var b=j.buildOfflineStorageOptions(a),c=this.options.storage.storagePath+"_"+a.appId;this.persister=i.getPersister(c,b)}},a.prototype._getCacheData=function(){var a=this;return this.cacheData?g.Utils.successfulPromise(this.cacheData):this._persisterGetAllDataWrap().then(function(b){return a.cacheData=b,a.cacheData})},a.prototype._persisterGetAllDataWrap=function(){var a=this;return new Promise(function(b,c){return a.persister.getAllData(b,c)})},a.prototype._persisterSaveDataWrap=function(a,b){var c=this;return new Promise(function(d,e){return c.persister.saveData(a,JSON.stringify(b),d,e)})},a.prototype._getCacheDataForContentType=function(a){return this._getCacheData().then(function(b){return b[a]="string"==typeof b[a]?JSON.parse(b[a]):b[a]||{},d.clone(b[a])})},a.prototype._cacheDataQuery=function(a){var b=this._everlive.cache._shouldSkipCache(a);if(b){if(a.ignoreCache&&!this._everlive.cache.isQueryUnsupportedOffline(a)){var c=this._everlive.cache._getHashForQuery(a);return this._everlive.cache._cacheQuery(a,c,null)}return h.RequestService.handleRequestProcessing(a,null)}return a.useCache=!1,this._everlive.cache._processCacheItem(a,null)},a.prototype._persistCacheData=function(a,b){var c=this;return this._getCacheDataForContentType(a).then(function(){var e=d.extend({},c.cacheData[a],b);return c.cacheData[a]=d.compactObject(e),c._persisterSaveDataWrap(a,c.cacheData[a])})},a.prototype.isQueryUnsupportedOffline=function(a){var b=!!a.getHeader(f.Constants.Headers.powerFields),c=a.getQueryParameters(),d=c.filter,e=g.Utils.getUnsupportedOperators(d),h=0!==e.length;return b||h},a.prototype._shouldSkipCache=function(a){var b=-1===l.indexOf(a.operation),c=a.collectionName,d=this.typeSettings,e=d&&d&&d[c]&&d[c].enabled===!1,f=a.ignoreCache,g=this.isQueryUnsupportedOffline(a),h=a.additionalOptions&&"me"===a.additionalOptions.id;return b||e||h||f||g},a.prototype._processCacheItem=function(a,b){var c=this,d=a.collectionName,e=this._getHashForQuery(a);return c._getCacheDataForContentType(d).then(function(g){return g[e]?c._isHashExpired(d,e,a.maxAge).then(function(g){return g&&!a.forceCache?c._purgeForHash(d,e).then(function(){return c._cacheQuery(a,e,b)}):(a.operation===f.DataQueryOperation.ReadById&&"me"===a.additionalOptions.id&&(a.additionalOptions.id=c._everlive.setup.principalId),c._everlive.offlineStorage.processQuery(a))}):c._cacheQuery(a,e,b)})},a.prototype._addObjectToCache=function(a,b){var c=a.Id;return this._cacheResultFromDataQuery(b,c)},a.prototype._cacheQuery=function(a,b,c){var e=this,g=a.collectionName,i=new Promise(function(i,j){var k;return h.RequestService.handleRequestProcessing(a,c).then(function(a){return k=a.result||a,e._getCacheData()}).then(function(){var b=[],c=k.Result||k;if(a.operation!==f.DataQueryOperation.Count)if(Array.isArray(c))d.each(c,function(a){var c=e._addObjectToCache(a,g);b.push(c)});else if(d.isObject(c)){var h=e._addObjectToCache(c,g);b.push(h)}return Promise.all(b)}).then(function(){return a.operation!==f.DataQueryOperation.Count?e._cacheResultFromDataQuery(g,b):void 0}).then(function(){i(k)})["catch"](function(a){j(a)})});return i},a.prototype._cacheResultFromDataQuery=function(a,b){var c={};return c[b]={cachedAt:Date.now()},this._persistCacheData(a,c)},a.prototype._getExpirationForHash=function(a,b){return this._getCacheDataForContentType(a).then(function(a){return a[b].cachedAt})},a.prototype._isHashExpired=function(a,b,c){var d=this;return this._getExpirationForHash(a,b).then(function(b){var e,f=d.typeSettings&&d.typeSettings[a]?60*d.typeSettings[a].maxAge*1e3:null;return e=c||0===c?c:f||0===f?f:d.maxAgeInMs,b+e<Date.now()})},a.prototype._purgeForHash=function(a,b){var c={};return c[b]=null,this._persistCacheData(a,c)},a.prototype._getHashForQuery=function(a){if(a.operation===f.DataQueryOperation.ReadById)return a.additionalOptions.id;var b=a.getQueryParameters();return this._hash(b)},a.prototype.clear=function(a,b,c){var d=this;return g.Utils.buildPromise(function(b,c){if(!d.options.enabled){var e=k.EverliveErrorHelper.buildCacheDisabledErrorMessage("clear");return c(new k.EverliveError({message:e,code:k.EverliveErrors.cacheDisabled.code}))}return d.persister.purge(a,function(){d.cacheData&&d.cacheData[a]&&delete d.cacheData[a],d._everlive.offlineStorage.options.enabled?b():d._everlive.offlineStorage.queryProcessor.persister.purge(a,b,c)},c)},b,c)},a.prototype.clearAll=function(a,b){var c=this;return c.cacheData=null,g.Utils.buildPromise(function(a,b){if(c.options.enabled===!1){var d=k.EverliveErrorHelper.buildCacheDisabledErrorMessage("clearAll");return b(new k.EverliveError({message:d,code:k.EverliveErrors.cacheDisabled.code}))}return c.persister.purgeAll(function(){c._everlive.offlineStorage.options.enabled?a():c._everlive.offlineStorage.queryProcessor.persister.purgeAll(a,b)},b)},a,b)},a}();b.CacheModule=m},function(a,b,c){"use strict";function d(a,b){var c,d=h();a.caching===!0?(c=f.deepExtend({},d),c.enabled=!0):c=f.deepExtend(d,a.caching),a.caching!==!1&&(b.setup.caching=c),b.cache=new g.CacheModule(c,b)}function e(a,b){b.cache._initStore(a)}var f=c(1),g=c(52),h=function(){return{maxAge:60,enabled:!1,storage:{storagePath:"el_cache"}}};b.initCaching=d,b.initStore=e},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(104),g=c(8),h=c(14),i=c(6),j=c(2),k=j.Constants.Headers,l=function(a){function b(){a.apply(this,arguments)}return d(b,a),b.prototype._getInitialDataQuery=function(a,b){return new h.DataQuery({meta:b,operation:a})},b.prototype._isOperationAllowed=function(a,b){return e.contains(a,b)},b.prototype._buildQuery=function(a){return a?a instanceof i.Query?a:new i.Query(a):null},b.prototype._tryBuildQuery=function(a,c){var d=b._tryBuildQueryAllowedOperations;if(!this._isOperationAllowed(d,a))return null;var f=e.has(c,"query")?c.query:c;return this._buildQuery(f)},b.prototype._tryGetData=function(a,c){var d=b._tryGetDataAllowedOperations;if(!this._isOperationAllowed(d,a))return null;var f=b._tryGetDataFields,g=e.find(f,function(a){return e.has(c,a)});return g?c[g]:c},b.prototype._isAuthenticationOperation=function(a){return a===g.DataQueryOperation.UserLogin||a===g.DataQueryOperation.UserLogout||a===g.DataQueryOperation.UserLoginWithProvider||a===g.DataQueryOperation.UserLinkWithProvider||a===g.DataQueryOperation.UserUnlinkFromProvider},b.prototype._isCloudCodeOperation=function(a){return a===g.DataQueryOperation.InvokeCloudFunction||a===g.DataQueryOperation.InvokeStoredProcedure},b.prototype._applyOperationSpecificProperties=function(a,b){if(a===g.DataQueryOperation.UserLoginWithProvider)b.authHeaders=!1;else if(this._isCloudCodeOperation(a)){var c=b.additionalOptions,d=c.customParameters,f=c.authHeaders;b.authHeaders=f,d&&(b.headers=e.extend(b.headers,(h={},h[k.customParameters]=JSON.stringify(d),h)))}return this._isAuthenticationOperation(a)&&(b.skipAuth=!0),b;var h},b.prototype.buildDataQuery=function(b,c,d){var e=a.prototype.buildDataQuery.call(this,b,c,d);return e.query?e:(e.query=this._tryBuildQuery(c,b)||void 0,e.data=this._tryGetData(c,b)||void 0,this._applyOperationSpecificProperties(c,e),e)},b._tryBuildQueryAllowedOperations=[g.DataQueryOperation.Read,g.DataQueryOperation.ReadById,g.DataQueryOperation.Count,g.DataQueryOperation.Aggregate,g.DataQueryOperation.SetAcl,g.DataQueryOperation.Update,g.DataQueryOperation.SetOwner,g.DataQueryOperation.Delete,g.DataQueryOperation.DeleteById,g.DataQueryOperation.RawUpdate],b._tryGetDataAllowedOperations=[g.DataQueryOperation.Create,g.DataQueryOperation.RawUpdate,g.DataQueryOperation.Update,g.DataQueryOperation.SetOwner,g.DataQueryOperation.UserLogin,g.DataQueryOperation.UserLoginWithProvider,g.DataQueryOperation.FilesUpdateContent,g.DataQueryOperation.UserResetPassword,g.DataQueryOperation.UserSetPassword,g.DataQueryOperation.UserChangePassword,g.DataQueryOperation.UserLinkWithProvider,g.DataQueryOperation.UserUnlinkFromProvider],b._tryGetDataFields=["updateObject","data"],b}(f.DataQueryBuilder);b.DataQueryBuilder=l},function(a,b,c){"use strict";var d=c(135),e=d.CryptoJS.AES,f=function(){function a(a){void 0===a&&(a={}),this.options=a}return a.prototype._getKey=function(){return this.options.encryption.key},a.prototype._canEncryptDecrypt=function(a){return this._getKey()&&null!==a&&void 0!==a},a.prototype.encrypt=function(a){return this._canEncryptDecrypt(a)?e.encrypt(a,this._getKey()).toString():a},a.prototype.decrypt=function(a){return this._canEncryptDecrypt(a)?e.decrypt(a,this._getKey()).toString(d.CryptoJS.enc.Utf8):a},a}();b.CryptographicProvider=f},function(a,b,c){"use strict";var d=c(5),e=c(57);b.helpers=[],(d.isCordova||d.isDesktop)&&b.helpers.push({name:"html",ctor:e.HtmlHelper})},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(42),g=c(4),h=c(59),i=c(58),j=c(2),k=c(3),l={processOnLoad:!1,processOnResize:!1,loadingImageUrl:"",errorImageUrl:"",attributes:{loadingImage:"data-loading-image",errorImage:"data-error-image",dpi:"data-dpi",imageSource:"data-src",fileSource:"data-href",enableOffline:"data-offline",enableResponsive:"data-responsive"},responsiveParams:{}},m=function(a){function b(b,c){a.call(this),this.sdk=b,this.settings={urlTemplate:"[protocol][hostname][appid]/[operations][url]",server:"bs1.cdn.telerik.com/image/v1/"},c=c||{},this.options=e.extend({},l,c),this.options.attributes=e.extend({},l.attributes,c.attributes),this.options.responsiveParams=e.extend({},l.responsiveParams,c.responsiveParams),this.responsive=new h.HtmlHelperResponsiveModule(this),this.offline=new i.HtmlHelperOfflineModule(this),
this._init()}return d(b,a),b.prototype._init=function(){var a=this;a.options.processOnLoad&&window.addEventListener("load",this.processAll.bind(this),!1),this.options.processOnResize&&window.addEventListener("resize",e.debounce(this.processAll.bind(this),300),!1)},b.prototype._triggerOnProcessed=function(a){this.emit(j.Constants.Events.Processed,a)},b.prototype._defaultProcessSettings=function(a){return e.defaults({},a,{responsive:!0,offline:!0})},b.prototype._setLoadingUrl=function(a){var b=a.getAttribute(this.options.attributes.loadingImage)||this.options.loadingImageUrl;return!b||g.Utils.isElement.anchor(a)?g.Utils.successfulPromise():this._setUrl(a,b,!0)},b.prototype._getBackgroundSrc=function(a){var b=window.getComputedStyle(a,null),c=b.getPropertyValue("background-image"),d="none"!==c?c:!1;return d&&(d=d.replace(/url\(('?"?)(.*?)\1\)/gi,"$2")),d},b.prototype._setErrorUrl=function(a){var b=a.getAttribute(this.options.attributes.errorImage)||this.options.errorImageUrl;return!b||g.Utils.isElement.anchor(a)?g.Utils.successfulPromise():this._setUrl(a,b,!0)},b.prototype._setUrl=function(a,b,c){void 0===c&&(c=!1);var d=this;return new Promise(function(f,h){var i=d._getAttr(a);if(g.Utils.isElement.image(a)&&i===d.options.attributes.imageSource)if(c)a.src=b,a.style.visibility="visible";else{var j=new Image;j.onerror=function(){j=null,h(new k.EverliveError({message:"Can't be loaded: "+b}))},j.onload=function(){j=null,d._setUrl(a,b,!0).then(f)["catch"](h)},j.src=b}else if(c=!0,i){var l;l=i===d.options.attributes.imageSource?"src":i===d.options.attributes.fileSource?"href":e.last(i.split("-")),a.setAttribute(l,b)}else a.style.backgroundImage="url("+b+")";c&&f()})},b.prototype._getAttr=function(a){return a.getAttribute(this.options.attributes.imageSource)?this.options.attributes.imageSource:a.getAttribute(this.options.attributes.fileSource)?this.options.attributes.fileSource:void 0},b.prototype._getUrl=function(a){var b=a.getAttribute(this.options.attributes.imageSource)||a.getAttribute(this.options.attributes.fileSource)||this._getBackgroundSrc(a);return b},b.prototype._wrapElements=function(a){var b=this,c=e.map(a,function(a){var c=a.tagName.toLowerCase(),d=function(b){var c,d=(a.attributes[b]||{value:null}).value;if(""===d)c=!0;else if(d)try{c=JSON.parse(d)}catch(e){c=!0}else c=!1;return c},e=d(b.options.attributes.enableResponsive),f=d(b.options.attributes.enableOffline);return{item:a,tag:c,operations:{responsive:e,offline:f}}});return c},b.prototype.process=function(a,b,c,d){var f=this;return g.Utils.buildPromise(function(c){b=f._defaultProcessSettings(b),a=e.isArray(a)||a instanceof NodeList||a.length?e.flatten(a):[a];var d=f._wrapElements(a),h=[];e.each(d,function(a){var c={element:a.item,responsive:!1,offline:!1},d=f._getUrl(c.element);if(!d)return h.push(g.Utils.successfulPromise(c));var e=b.responsive?a.operations.responsive:!1,i=b.offline?a.operations.offline:!1;if(!e&&!i)return h.push(f._setUrl(c.element,d,!0).then(function(){return c}));var j=f._setLoadingUrl(c.element),k=function(a,b){return b?(c[a]=!0,b):void 0};e&&(j=j.then(function(){return f.responsive.responsiveImage(a,d).then(k.bind(this,"responsive"))})),i&&(j=j.then(function(a){return f.offline.processOffline(a||d).then(k.bind(this,"offline"))})),j=j.then(function(a){return f._setUrl(c.element,a).then(function(){return c})})["catch"](function(a){return f._setErrorUrl(c.element).then(function(){throw{element:c.element,error:a}})}),h.push(j)}),g.Utils.promisesAllSettled(h).then(function(a){var b=[],d=[];e.each(a,function(a){"fulfilled"===a.state?b.push(a.value):d.push(a.reason)});var g={processed:b,failed:d};f._triggerOnProcessed(g),c(g)})},c,d)},b.prototype.processAll=function(a,b,c){a=this._defaultProcessSettings(a);var d="["+this.options.attributes.enableResponsive+"]",f="["+this.options.attributes.enableOffline+"]",g=[];a.responsive&&(g=document.querySelectorAll(d));var h=[];a.offline&&(h=document.querySelectorAll(f));var i=[].slice,j=e.unique(i.call(g).concat(i.call(h)));return this.process(j,a,b,c)},b}(f.EventEmitterExtended);b.HtmlHelper=m},function(a,b,c){"use strict";var d=c(9),e=c(1),f=c(4),g=c(3),h=function(){function a(a){this.htmlHelper=a}return a.prototype.processOffline=function(a){var b=this;return b.htmlHelper.sdk.offlineStorage.files?b.htmlHelper.sdk.offlineStorage.files.downloadOffline(a).then(function(a){return a})["catch"](function(c){if(c.code!==g.EverliveErrors.cannotDownloadOffline.code)throw c;return b.htmlHelper.sdk.offlineStorage.offlineFilesProcessor.getOfflineFilesData().then(function(b){var c=d.basename(a),f=e.find(b,function(a){if(a.onlineLocation&&a.offlineLocation){var b=a.onlineLocation,d=b.lastIndexOf(c);return-1!==d}});if(f)return f.offlineLocation;throw new g.EverliveError({message:"Cannot find offline image "+a,code:g.EverliveErrors.missingOrInvalidFileContent.code})})}):f.Utils.rejectedPromise(new g.EverliveError({message:"Offline storage must be enabled in order to use the offline features of the images component."}))},a}();b.HtmlHelperOfflineModule=h},function(a,b,c){"use strict";var d=c(1),e=c(4),f={params:{resize:{}},isUserResize:!1},g=function(){function a(a){this.htmlHelper=a}return a.prototype.getBackgroundWidth=function(a){return Math.ceil(a.offsetWidth)},a.prototype.getBackgroundHeight=function(a){return Math.ceil(a.offsetHeight)},a.prototype.parseParamsString=function(a){if(!a||"undefined"==typeof a||a.length<=1)return f;var b=a.split("/"),c={},e=!1;return d.chain(b).filter(function(a){return!!a}).each(function(a){var b=a.split("="),d=b[0],f=b[1];f=unescape(f.replace(/\+/g," ")),c[d]=f,"resize"===d&&(e=!0)}),{params:c,isUserResize:e}},a.prototype.getImgParams=function(a,b){var c,e=this,g=a.replace(/.*?resize=[^\/\/]*\//gi,""),h=new RegExp("https?://","gi"),i=new RegExp(this.htmlHelper.settings.server,"gi"),j=new RegExp(this.htmlHelper.sdk.appId+"/","gi"),k=a.replace(g,"").replace(h,"").replace(i,"").replace(j,"").toLowerCase();if(""!==k){var l=k.indexOf("/")?k.substring(0,k.length-1):k;c=this.parseParamsString(l)}else b.dataset.responsiveParams?(c=f,d.each(b.dataset.responsiveParams.split(","),function(a){var b=a.split(":"),d=b[0],e=b[1];c.params.resize[d]=e})):c=f;return d.chain(this.htmlHelper.options.responsiveParams).keys().each(function(a){var b=e.htmlHelper.options.responsiveParams[a];c.params.resize[a]=b}),c.isUserResize&&(g=a),{imgUrl:g,operations:c.params,isUserResize:c.isUserResize}},a.prototype.hasClass=function(a,b){var c=new RegExp("(?:\\s|^)"+b+"(?:\\s|$)");return!!a.className.match(c)},a.prototype.getImageWidth=function(a){var b=a.parentNode;if(b){var c=b.offsetWidth,d=window.getComputedStyle(b,null),e=parseFloat(d.getPropertyValue("padding-left")),f=parseFloat(d.getPropertyValue("padding-right")),g=parseFloat(d.getPropertyValue("border-left-width")),h=parseFloat(d.getPropertyValue("border-right-width"));return Math.abs(c-Math.ceil(e+f+g+h))}return 0},a.prototype.getImageHeight=function(a){var b=a.parentNode;if(b){var c=b.offsetHeight,d=window.getComputedStyle(b,null),e=parseFloat(d.getPropertyValue("padding-top")),f=parseFloat(d.getPropertyValue("padding-bottom")),g=parseFloat(d.getPropertyValue("border-top-width")),h=parseFloat(d.getPropertyValue("border-bottom-width"));return Math.abs(c-Math.ceil(e+f+g+h))}return 0},a.prototype.getDevicePixelRatio=function(){return window.devicePixelRatio?window.devicePixelRatio:1},a.prototype.getPixelRatio=function(a){var b=a.getAttribute(this.htmlHelper.options.attributes.dpi)||"";return""!==b?d.isNumber(b)?parseFloat(b):!1:this.getDevicePixelRatio()},a.prototype.getImgParamsString=function(a){var b="resize=";return d.chain(a.resize).keys().each(function(c,d,e){b+=c+":"+a.resize[c],b+=d<e.length-1?",":"/"}),b},a.prototype.responsiveImage=function(a,b){var c,f=this,g=d.extend({},a),h=g.item,i=g.tag,j=e.Utils.isElement.image(i);g=d.extend({},g,f.getImgParams(b,a.item)),g.isUserResize||(c=j?f.getImageWidth(h):f.getBackgroundWidth(h)),c=c?c:!1;var k=g.isUserResize?g.imgUrl:f.getImgSrc(g,c);return new Promise(function(a){return c||g.isUserResize?a(k):a()})},a.prototype.getImgSrc=function(a,b){var c=this.htmlHelper.sdk.setup.scheme+"://",d=this.htmlHelper.sdk.setup.appId,e=this.htmlHelper.settings.server,f=this.htmlHelper.settings.urlTemplate,g=this.getPixelRatio(a.item);f=f.replace("[protocol]",c),f=f.replace("[appid]",d||""),f=f.replace("[hostname]",e);var h,i=a.operations||!1;if(i){i.resize=i.resize||{},i.resize.w=b,i.resize.pd=g;var j=i.resize.fill;("cover"===j||"contain"===j)&&(i.resize.h=this.getImageHeight(a.item)||this.getBackgroundHeight(a.item)),h=this.getImgParamsString(i)}else{var k={resize:{w:b,pd:g}};h=this.getImgParamsString(k)}return f=f.replace("[operations]",h),f=f.replace("[url]",a.imgUrl)},a}();b.HtmlHelperResponsiveModule=g},function(a,b,c){"use strict";var d=c(30);b.Everlive=d.Everlive},function(a,b,c){"use strict";function d(a){var b={};if(a){if(a.skip&&(b.$skip=a.skip,delete a.skip),a.take&&(b.$take=a.take,delete a.take),a.sort){var c=a.sort,d={};j.isArray(c)||(c=[c]),j.each(c,function(a,b){d[b.field]="asc"===b.dir?1:-1}),b.$sort=d,delete a.sort}a.filter&&(b.$where=z.build(a.filter),delete a.filter)}return b}function e(a,b){for(var c=g(b[b.length-1]),d=b.slice(0,b.length-1),e="/_expand",f=0;f<d.length;f++)e+="/"+g(d[f]);return function(b,c){return function(d){var e=a+"";return d.Id&&c&&(e+=b+"/"+d.Id+"/"+c),e}}(e,c)}function f(a){return"string"==typeof a?{}:{"X-Everlive-Filter":JSON.stringify(a.filter),"X-Everlive-Sort":JSON.stringify(a.sort),"X-Everlive-Single-Field":a.singleField,"X-Everlive-Skip":a.skip,"X-Everlive-Take":a.take,"X-Everlive-Fields":JSON.stringify(a.fields)}}function g(a){if("string"==typeof a)return a;if(a.relation)return a.relation;throw new Error("You need to specify a 'relation' for an expand node when using the object notation")}function h(a,b){p.each(a,function(a){"count"===a.aggregate?b[a.aggregate](a.aggregate+m+a.field):b[a.aggregate](a.field,a.aggregate+m+a.field)})}function i(a,b){var c={};return p.each(a,function(a){c[a.field]||(c[a.field]={}),c[a.field][a.aggregate]=b[a.aggregate+m+a.field]}),p.isEmpty(c)?null:c}var j,k,l,m,n,o=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},p=c(1),q=c(22),r=c(6),s=c(21),t=c(2),u=c(30),v=c(142),w=c(4),x={read:"read",update:"update",destroy:"destroy",create:"create"};!function(){"undefined"==typeof window||"undefined"==typeof window.jQuery||"undefined"==typeof window.kendo||p.isEmpty(window.kendo.data)||(j=window.jQuery,k=window.kendo,l=j.extend,m="_",n=k.data.RemoteTransport.extend({init:function(a){if(this.everlive$=a.dataProvider||u.Everlive.$,this._subscribeToSdkEvents(a),!this.everlive$)throw new Error("An instance of the Backend services sdk must be provided.");if(!a.typeName)throw new Error("A type name must be provided.");this.headers=a.headers,this.dataCollection=this.everlive$.data(a.typeName),k.data.RemoteTransport.fn.init.call(this,a)},read:function(a){var b=this.options.read,c=this;if(b&&b.url)return k.data.RemoteTransport.fn.read.call(this,a);var e;b&&b.headers&&(e=b.headers);var f=d(a.data),g=new r.Query(f.$where,null,f.$sort,f.$skip,f.$take),h=a.data.Id;h?this.dataCollection.withHeaders(this.headers).withHeaders(e).getById(h).then(a.success,a.error):this.dataCollection.withHeaders(this.headers).withHeaders(e).get(g).then(function(b){return c._readServAggregates(b,f,a,e)}).then(a.success)["catch"](a.error)},update:function(a){var b=this.options.update;if(b&&b.url)return k.data.RemoteTransport.fn.read.call(this,a);var c;b&&b.headers&&(c=b.headers);var d=p.isArray(a.data.models);if(d)throw new Error("Batch update is not supported.");var e=a.data;return this.dataCollection.withHeaders(this.headers).withHeaders(c).updateSingle(e).then(a.success.bind(this,e),a.error)["catch"](a.error)},create:function(a){var b=this.options.create;if(b&&b.url)return k.data.RemoteTransport.fn.read.call(this,a);var c;b&&b.headers&&(c=b.headers);var d=p.isArray(a.data.models),e=d?a.data.models:a.data;return this.dataCollection.withHeaders(this.headers).withHeaders(c).create(e).then(a.success.bind(this,e),a.error)["catch"](a.error)},destroy:function(a){var b=this.options.destroy;if(b&&b.url)return k.data.RemoteTransport.fn.read.call(this,a);var c;b&&b.headers&&(c=b.headers);var d=p.isArray(a.data.models);if(d)throw new Error("Batch destroy is not supported.");var e={Id:a.data.Id};return this.dataCollection.withHeaders(this.headers).withHeaders(c).destroySingle(e).then(a.success,a.error)["catch"](a.error)},_subscribeToSdkEvents:function(a){var b=this;p.map(x,function(c){if(a&&a[c]&&"function"==typeof a[c].beforeSend){var d=a[c].beforeSend;b.everlive$.on(t.Constants.Events.BeforeExecute,d)}})},_readServAggregates:function(a,b,c,d){if(c.data.aggregate){if(!c.data.hasOwnProperty("filter")&&!b.$where)throw new Error("The serverFiltering option must be enabled, when using serverAggregates.");var e=new s.AggregateQuery(b.$where,null,b.$sort,b.$skip,b.$take);return h(c.data.aggregate,e),this.dataCollection.withHeaders(this.headers).withHeaders(d).aggregate(e).then(function(b){var d=i(c.data.aggregate,b.result[0]);return j.extend(!0,a,{aggregates:d}),a})["catch"](c.error)}return a}}),j.extend(!0,k.data,{transports:{everlive:n},schemas:{everlive:{type:"json",total:function(a){return a.hasOwnProperty("count")?a.count:a.Count},data:function(a){return a.result||w.Utils.parseUtilities.traverseAndRevive(a.Result)||a},model:{id:t.Constants.idField},aggregates:"aggregates"}}}))}();var y=["startswith","startsWith","endswith","endsWith","contains"],z={build:function(a){return z._build(a)},_build:function(a){return z._isRaw(a)?z._raw(a):z._isSimple(a)?z._simple(a):z._isRegex(a)?z._regex(a):z._isAnd(a)?z._and(a):z._isOr(a)?z._or(a):void 0},_isRaw:function(a){return"_raw"===a.operator},_raw:function(a){var b={};return b[a.field]=a.value,b},_isSimple:function(a){return"undefined"==typeof a.logic&&!z._isRegex(a)},_simple:function(a){var b={},c={},d=z._translateoperator(a.operator);return d?b[d]=a.value:b=a.value,c[a.field]=b,c},_isRegex:function(a){return-1!==j.inArray(a.operator,y)},_regex:function(a){var b={},c=z._getRegex(a);return b[a.field]=z._getRegexValue(c),b},_getRegex:function(a){var b=a.value,c=a.operator;switch(c){case"contains":return new RegExp(".*"+b+".*","i");case"startsWith":case"startswith":return new RegExp("^"+b,"i");case"endsWith":case"endswith":return new RegExp(b+"$","i")}throw new Error("Unknown operator type.")},_getRegexValue:function(a){return q.QueryBuilder.prototype._getRegexValue.call(this,a)},_isAnd:function(a){return"and"===a.logic},_and:function(a){var b,c,d,e={$and:[]},f=a.filters;for(b=0,c=f.length;c>b;b++)d=z._build(f[b]),e.$and.push(d);return e},_isOr:function(a){return"or"===a.logic},_or:function(a){var b,c,d,e=[],f=a.filters;for(b=0,c=f.length;c>b;b++)d=z._build(f[b]),e.push(d);return{$or:e}},_translateoperator:function(a){switch(a){case"eq":return null;case"neq":return"$ne";case"gt":return"$gt";case"lt":return"$lt";case"gte":return"$gte";case"lte":return"$lte"}throw new Error("Unknown operator type.")}},A=function(a){return void 0===a&&(a={}),u.Everlive.$.getKendoDataSource(a.typeName,a)};b.createDataSource=A;var B=function(a){void 0===a&&(a={});var b=a.typeName,c=a.dataProvider||u.Everlive.$;if(!c)throw new Error("You need to instantiate an Everlive instance in order to create a Kendo UI DataSource.");if(!b)throw new Error("You need to specify a 'typeName' in order to create a Kendo UI DataSource.");return c.getHierarchicalDataSource(b,a)};b.createHierarchicalDataSource=B;var C=function(a){function b(){a.apply(this,arguments)}return o(b,a),b.prototype.getKendoDataSource=function(a,b){void 0===b&&(b={});var c=b.dataProvider||u.Everlive.$;if(!c)throw new Error("You need to instantiate an Everlive instance in order to create a Kendo UI DataSource.");if(!a)throw new Error("You need to specify a 'typeName' in order to create a Kendo UI DataSource.");if(b.serverGrouping)throw new Error("serverGrouping is not supported.");if(b.serverAggregates&&!b.serverFiltering)throw new Error("The serverFiltering option must be enabled, when using serverAggregates.");var d={type:"everlive",transport:{typeName:a,dataProvider:this}},b=p.defaults(d,b);return new k.data.DataSource(b)},b.prototype.getHierarchicalDataSource=function(a,b){void 0===b&&(b={});var c=b.expand||b;if(delete b.expand,!a)throw new Error("You need to specify a 'typeName' in order to create a Kendo UI HierarchicalDataSource.");if(!j.isArray(c))throw new Error("You need to set 'expand' array option in order to create a Kendo UI HierarchicalDataSource");for(var d,h=w.Utils.buildUrl(this.setup)+a,i=w.Utils.isOfflineStorageEnabled(this.setup),m=c.length-1;m>=0;m--){var n=c[m];if(i){if(!j.isPlainObject(n))throw new Error("When offline is enabled, each member of the expand array option must be an object. (Expand node index: "+m+")");if(!n.relation)throw new Error("When offline is enabled, each member of the expand array option must have a `relation` option set.  (Expand node index: "+m+")");if(!n.typeName)throw new Error("When offline is enabled, each member of the expand array option must have a `typeName` option set.  (Expand node index: "+m+")");var o,p={};p[n.relation]={TargetTypeName:n.typeName,Filter:n.filter,Sort:n.sort,Take:n.take,Skip:n.skip,Fields:n.fields,SingleField:n.singleField},o={"X-Everlive-Expand":JSON.stringify(p),"X-Everlive-Single-Field":n.relation};var q;q=0===m?a:c[m-1].typeName,d={model:{hasChildren:n.relation,children:{type:"everlive",transport:{typeName:q,read:{headers:o}},schema:d}}}}else d={model:{hasChildren:g(n),children:{type:"everlive",transport:{read:{url:e(h,c.slice(0,m+1)),headers:f(n)}},schema:d}}}}var r={};return r.type="everlive",r.transport={typeName:a,dataProvider:this},r.schema=d,j.isPlainObject(b)&&l(!0,r,b),new k.data.HierarchicalDataSource(r)},b.prototype.createDataSource=function(a){return void 0===a&&(a={}),A(a)},b.prototype.createHierarchicalDataSource=function(a){return void 0===a&&(a={}),B(a)},b}(v.Sdk);b.KendoSdk=C},function(a,b,c){"use strict";var d=c(1),e=c(9),f=c(135),g=c(4),h=c(23),i=c(3),j=c(45),k=function(){function a(a,b,c){this._offlineFilesProcessor=a,this._everlive=b,this._downloadsQueue=new j.AutoQueue(c)}return a.prototype._getFilenameMetadata=function(a,b){return new Promise(function(c,f){h.reqwest({url:a,method:"HEAD",async:!0,crossDomain:!0}).then(function(a){var f=a.getResponseHeader("Content-Disposition");if(f){var g=/filename="?([^"\\]*(?:\\.[^"\\]*)*)"?/i.exec(f);d.isArray(g)&&(b.filename=g[1])}else b.filename=e.basename(a.responseURL);c(a.responseURL)})["catch"](function(a){return f(a)})})},a.prototype.downloadOffline=function(a,b,c,d){var e=this;return g.Utils.buildPromise(function(c,d){e._downloadsQueue.enqueue(function(c){var f;return e._getOfflineFileInfo(a).then(function(c){return f=c,b?!1:e.existsOffline(a)}).then(function(b){return b?e._getOfflineFileInfo(a).then(function(a){return e._getOfflineLocation(a)}):e._everlive.isOnline()?g.Utils.successfulPromise().then(function(){return f.filename?void 0:e._getFilenameMetadata(a,f)}).then(function(a){var b=a||f.location;return e._saveFile(b,f.filename,null,f.location)}):void d(new i.EverliveError(i.EverliveErrors.cannotDownloadOffline))}).then(function(a){c(null,a)})["catch"](c)},c,d)},c,d)},a.prototype._saveFile=function(a,b,c,d){var e,f=this;return f._downloadFile(a,b).then(function(a){return e=a,f._offlineFilesProcessor.getOfflineFilesData()}).then(function(b){return b.push({offlineLocation:e,onlineLocation:d||a,id:c}),f._offlineFilesProcessor.saveOfflineFilesData()}).then(function(){return e})},a.prototype.purgeAll=function(a,b){var c=this;return g.Utils.buildPromise(function(a,b){c._offlineFilesProcessor.fileStore.removeFilesDirectory().then(function(){return c._offlineFilesProcessor.filesMetaStore.removeFilesDirectory()}).then(function(){c._offlineFilesProcessor._offlineFilesData=null}).then(a)["catch"](b)},a,b)},a.prototype._getOfflineLocation=function(a){var b=this,c=a.location,d=a.filename,e=a.Id;return b._offlineFilesProcessor.getOfflineLocation(c,e).then(function(a){return a?a:e&&!c?b._getFileUrlForId(e,d):null})},a.prototype._downloadFile=function(a,b){var c=this;return new Promise(function(d,h){var i=new FileTransfer,j=c._sanitizeUrl(a),k=e.basename(j),l=e.extname(b),m=k;e.extname(j)!==l&&(m+=l);var n="";if(!g.Utils.isGuid(a)){var o=a.lastIndexOf(k),p=a.substr(0,o);n=f.CryptoJS.MD5(p).toString()}return c._offlineFilesProcessor.fileStore.getDataDirectory().then(function(a){return g.Utils.joinPath(a.nativeURL,c._offlineFilesProcessor.fileStore.filesDirectoryPath,n,m)}).then(function(b){i.download(a,b,function(){d(b)},h,!0,{headers:c._everlive.buildAuthHeader()})})["catch"](h)})},a.prototype._sanitizeUrl=function(a){if(!a)return a;var b=encodeURI(a),c=b.lastIndexOf("?");return-1!==c&&(b=b.substr(0,c)),b},a.prototype._getFileUrlForId=function(a,b){var c=this;return this._offlineFilesProcessor.fileStore.getDataDirectory().then(function(d){var f=e.extname(b);return g.Utils.joinPath(d.nativeURL,c._offlineFilesProcessor.fileStore.filesDirectoryPath,a+f)})},a.prototype.existsOffline=function(a,b,c){var d=this;return g.Utils.buildPromise(function(b,c){d._getOfflineFileInfo(a).then(function(a){return d._getOfflineLocation(a)}).then(function(a){return a?d._offlineFilesProcessor.fileStore.getFileByAbsolutePath(a):void 0}).then(function(a){return!!a}).then(b)["catch"](function(a){return a.code===i.EverliveErrors.itemNotFound.code?b(!1):c.apply(this,arguments)})},b,c)},a.prototype.purge=function(a,b,c){var d=this;return g.Utils.buildPromise(function(b,c){d._getOfflineFileInfo(a).then(function(a){return d._getOfflineLocation(a)}).then(function(a){return a?d._offlineFilesProcessor.purge(a):void 0}).then(b)["catch"](c)},b,c)},a.prototype.getOfflineLocation=function(a,b,c){var d=this;return g.Utils.buildPromise(function(b,c){d._getOfflineFileInfo(a).then(d._getOfflineLocation.bind(d)).then(function(a){return a?d.existsOffline(a).then(function(b){return b?a:null}):null}).then(b)["catch"](c)},b,c)},a.prototype._getOfflineFileInfo=function(a){var b=this,c=this._sanitizeUrl(a);return new Promise(function(d,e){b._everlive.files.isSync(!0).useOffline(!0).getById(c).then(function(a){var b=a.result;d({location:b.Uri,filename:b.Filename,Id:c})})["catch"](function(b){b&&b.code===i.EverliveErrors.itemNotFound.code?d({location:a}):e(b)})})},a.prototype.changeFileExtensionById=function(a,b){var c=this;return"string"!=typeof b?new Promise(function(a){a()}):c._changeExtension(a,b)},a.prototype._changeExtension=function(a,b){var c,f=this,g=f._offlineFilesProcessor.fileStore,h=a+b;return g.getFilesDirectory().then(function(b){return c=b,f.getOfflineLocation(a)}).then(function(a){var j=e.basename(a);return j!==h?g.getFileByAbsolutePath(a).then(function(a){return g.renameFile(c,a,h)}).then(function(){return f._offlineFilesProcessor.getOfflineFilesData()}).then(function(c){var g=d.findWhere(c,{offlineLocation:a});if(!g)throw new i.EverliveError({message:"Could not find a cached location for the specified file."});var h=g.offlineLocation,j=e.extname(h),k=h.slice(0,h.length-j.length)+b;return g.offlineLocation=k,f._offlineFilesProcessor.saveOfflineFilesData()}):void 0})},a}();b.OfflineFilesModule=k},function(a,b,c){"use strict";var d=c(1),e=c(9),f=c(3),g=c(37),h=c(5),i=c(4),j="filesMetadataMap",k=function(){function a(a,b){this.setup=a,this._everlive=b,this.fileStore=g.getFileStore(a.files.storagePath,a),this.filesMetaStore=g.getFileStore(a.files.metaPath,a)}return a.prototype.validateFileCreateObject=function(a,b){return new Promise(function(c,d){return a.base64||b?a.ContentType?a.Filename?void c():d(new f.EverliveError(f.EverliveErrors.invalidRequest)):d(new f.EverliveError(f.EverliveErrors.missingContentType)):d(new f.EverliveError(f.EverliveErrors.missingOrInvalidFileContent))})},a.prototype.getOfflineFilesData=function(){var a=this;return new Promise(function(b,c){return a._offlineFilesData?void b(a._offlineFilesData):a.filesMetaStore.getFile(j).then(function(b){return a.filesMetaStore.readFileAsText(b)}).then(function(c){c||(c="[]"),a._offlineFilesData=JSON.parse(c),b(a._offlineFilesData)})["catch"](c)})},a.prototype.saveOfflineFilesData=function(){var a=this;return a.getOfflineFilesData().then(function(b){return a.filesMetaStore.writeText(j,JSON.stringify(b))})},a.prototype.upsertFileFromObject=function(a,b,c){if(h.isDesktop||h.isNativeScript)return i.Utils.successfulPromise();var d=this;if(!c)if(b){if(!a.base64)return i.Utils.rejectedPromise(new f.EverliveError(f.EverliveErrors.missingOrInvalidFileContent));if(!a.ContentType)return i.Utils.rejectedPromise(new f.EverliveError(f.EverliveErrors.missingContentType))}else if(!a.base64)return i.Utils.successfulPromise();if(!a.base64){var e,g=i.Utils.getId(a),j=a.Uri?i.Utils.successfulPromise(a.Uri):d._everlive.files.isSync(c).applyOffline(!1).getDownloadUrlById(g);return j.then(function(a){return e=a,d._everlive.offlineStorage.files.existsOffline(g)}).then(function(b){return b?void 0:d._everlive.offlineStorage.files._saveFile(e,a.Filename)})}return a.Storage="internal",i.Utils.successfulPromise().then(function(){return c?void 0:d.validateFileCreateObject(a,c)}).then(function(){var b,c=a.Uri,e=d.getFilenameForObject(a),f=a.base64;delete a.base64;var g=i.Utils.b64toBlob(f,a.ContentType);return d.writeFile(e,g).then(function(a){return b=a,d.getOfflineFilesData()}).then(function(e){return e.push({offlineLocation:b.offlineLocation,onlineLocation:c,id:a._id}),a.Length=b.size,d.saveOfflineFilesData()})})},a.prototype.purge=function(a){var b=this;return this.getOfflineFilesData().then(function(c){var e=d.where(c,{offlineLocation:a}),f=c.indexOf(e[0]);return-1!==f&&c.splice(f,1),b.saveOfflineFilesData()}).then(function(){return b.fileStore.getFileByAbsolutePath(a)}).then(function(a){return a?b.fileStore.removeFile(a):void 0})},a.prototype.writeFile=function(a,b,c){var d,e=this;return e.fileStore.writeText(a,b,c).then(function(a){return d=a,e.saveOfflineFilesData()}).then(function(){return e.fileStore.getFileSize(a,c)}).then(function(a){return{size:a,offlineLocation:d}})},a.prototype.getFilenameForObject=function(a){var b=e.extname(a.Filename);return a._id+b},a.prototype.getOfflineLocation=function(a,b){return this.getOfflineFilesData().then(function(c){if(a||b)for(var d=0;d<c.length;d++){var e=c[d],f=a&&(e.offlineLocation===a||e.onlineLocation===a),g=b&&e.id===b;if(f||g)return e.offlineLocation}})},a}();b.OfflineFilesProcessor=k},function(a,b,c){"use strict";function d(a){var b=e(a);return b.ModifiedAt=a.ModifiedAt,b}function e(a){return{Id:a.Id}}function f(a,b,c,d,e){var f,g=e.storage.provider;switch(g){case j.Constants.StorageProvider.LocalStorage:case j.Constants.StorageProvider.FileSystem:case j.Constants.StorageProvider.Custom:f=new s.OfflineInMemoryQueryProcessor(a,b,c,d,e);break;case j.Constants.StorageProvider.SQLite:f=new t.OfflineSQLiteQueryProcessor(a,b,c,d,e);break;default:throw new i.EverliveError({message:"Unsupported storage type "+g})}return f}var g=c(1),h=c(14),i=c(3),j=c(2),k=c(36),l=c(4),m=c(10),n=c(15),o=c(63),p=c(62),q=c(6),r=c(11),s=c(70),t=c(71),u={server:"server",client:"client"},v=function(){function a(a,b,c,d){this._everlive=a,this.options=b,this._encryptionProvider=d,this._isSynchronizing=!1,this.offlineFilesProcessor=new o.OfflineFilesProcessor(this.options,this._everlive),this.queryProcessor=f(c,d,this.offlineFilesProcessor,this._everlive,this.options),this.files=new p.OfflineFilesModule(this.offlineFilesProcessor,this._everlive,this.options.files.maxConcurrentDownloads)}return a.prototype.purgeAll=function(a,b){return this.queryProcessor.purgeAll(a,b)},a.prototype.purge=function(a,b,c){return this.queryProcessor.purge(a,b,c)},a.prototype.processQuery=function(a){return this.queryProcessor.processQuery(a)},a.prototype._setOffline=function(a){this.options.offline=a},a.prototype.isOnline=function(){return!this.options.offline},a.prototype._prepareSyncData=function(a){var b=this,c={},d=[];return g.each(a,function(a,e){var f=n.offlineTransformations.idTransform(a.offlineItemsToSync),g=b._getSyncItemStates(e,f,a.serverItems);d.push(g.conflicts),c[e]=g.itemsForSync}),{conflicts:d,contentTypesSyncData:c}},a.prototype._resolveConflicts=function(a){var b=this;return this._applyResolutionStrategy(a.conflicts).then(function(){return b._mergeResolvedConflicts(a.conflicts,a.contentTypesSyncData)}).then(function(){return a.contentTypesSyncData})},a.prototype.isSynchronizing=function(){return this._isSynchronizing},a.prototype._fireSyncStart=function(){var a=this;return new Promise(function(b){a._isSynchronizing?b():(a._isSynchronizing=!0,a._everlive.emit(j.Constants.Events.SyncStart),b())})},a.prototype._fireSyncEnd=function(){this._isSynchronizing=!1,this._everlive.emit(j.Constants.Events.SyncEnd,this._syncResultInfo),this._syncResultInfo=null},a.prototype._eachSyncItem=function(a,b,c,d){var e=this;g.each(a,function(a){var f=b(a.remoteItem),h=a.resultingItem,i=a.isCustom,j=a.resolutionType;g.some(e._syncResultInfo.failedItems[c],{itemId:h.Id})||d(h,f,i,j)})},a.prototype._shouldAutogenerateIdForContentType=function(a){return this.queryProcessor._shouldAutogenerateIdForContentType(a)},a.prototype._addCreatedFileToSyncPromises=function(a,b,c){var d=this;g.each(a,function(a){var e=d._everlive.files;b[a.Id]=new Promise(function(b,f){d.files.getOfflineLocation(a.Id).then(function(b){return b?d._transferFile(!1,a,b):void 0},function(b){f({type:j.Constants.offlineItemStates.created,items:a,contentType:c,error:b,storage:u.server})}).then(function(b){var f=g.extend({},a,b.result);return d._onItemProcessed(f,c,u.server,j.Constants.offlineItemStates.created),e.isSync(!0).useOffline(!0).updateSingle(f)},function(b){f({type:j.Constants.offlineItemStates.created,items:a,contentType:c,error:b,storage:u.server})}).then(b,function(b){f({type:j.Constants.offlineItemStates.modified,items:a,contentType:c,error:b,storage:u.client})})})})},a.prototype._transferFile=function(a,b,c){var d=this._everlive;return new Promise(function(e,f){var h=this,i=d.files.getUploadUrl(),k=l.Utils.successfulPromise();a&&(k=new Promise(function(a){d.files.isSync(!0).applyOffline(!1).getById(b.Id).then(function(){a(!0)})["catch"](function(){a(!1)})})),k.then(function(k){var m=a&&k;m&&(i+="/"+b.Id+"/Content");var n=new FileTransfer,o=j.Constants.fileUploadKey,p={fileKey:o,httpMethod:m?"PUT":"POST",mimeType:b.ContentType,fileName:b.Filename,headers:d.buildAuthHeader(),params:{}};g.each(b,function(a,b){if("base64"!==b.toLowerCase()){var c=j.Constants.fileUploadKey+j.Constants.fileUploadDelimiter+b;p.params[c]=a}}),n.upload(c,i,function(a){var b=l.Utils.parseUtilities.parseJSON(a.response);b.Result===!1?f.apply(h,arguments):e(g.isArray(b.Result)?{result:b.Result[0]}:b)},f,p,!0)})})},a.prototype._addCreatedObjectToSyncPromises=function(a,b,c,d,e,f){var h=this,i=new Promise(function(a,i){b.isSync(!0).applyOffline(!1).create(c).then(function(a){c=g.map(c,function(b,c){b.Id=a.result[c].Id,b.CreatedAt=b.ModifiedAt=a.result[c].CreatedAt;var f=g.find(d.createdItems,function(a){return a.resultingItem.Id===b.Id});return f.isCustom&&h._onItemProcessed(b,e,u.client,j.Constants.offlineItemStates.modified),b})},function(a){var b=a.error||a;throw{type:j.Constants.offlineItemStates.created,items:c,contentType:e,error:b,storage:u.server}}).then(function(){return b.isSync(!0).useOffline(!0).create(c).then(function(){g.each(c,function(a){h._onItemProcessed(a,e,u.server,j.Constants.offlineItemStates.created)})},function(a){throw{type:j.Constants.offlineItemStates.created,items:c,contentType:e,error:a,storage:u.client}})}).then(function(){if(f&&f.length){var a={Id:{$in:f}};return b.isSync(!0).useOffline(!0).destroy(a)["catch"](function(a){throw{type:j.Constants.offlineItemStates.created,items:c,contentType:e,error:a,storage:u.client}})}}).then(a)["catch"](function(a){i(a);

})});return g.each(c,function(b){a[b.Id]=i}),c},a.prototype._addCreatedItemsForSync=function(a,b,c){var d,e=c.collectionName,f=g.pluck(a.createdItems,"resultingItem");return this._shouldAutogenerateIdForContentType(e)||(d=g.pluck(f,"Id"),f=n.offlineTransformations.removeIdTransform(f)),l.Utils.isContentType.files(e)?this._addCreatedFileToSyncPromises(f,b,e):this._addCreatedObjectToSyncPromises(b,c,f,a,e,d)},a.prototype._addUpdatedItemsForSync=function(a,b,c,d,e){var f=this,g=d.collectionName;f._eachSyncItem(a.modifiedItems,b,g,e)},a.prototype._addDeletedItemsForSync=function(a,b,c,d,e){var f=this,g=d.collectionName;f._eachSyncItem(a.deletedItems,b,g,e)},a.prototype._onSyncResponse=function(a,b,c,d,e){var f=this;if(1!==a.result)return new Promise(function(a,b){b(g.extend({},i.EverliveErrors.syncConflict,{contentType:c}))});if(d===h.DataQuery.operations.Update){f._onItemProcessed(b,c,u.server,j.Constants.offlineItemStates.modified);var k=g.extend({},b,{ModifiedAt:a.ModifiedAt}),l=new h.DataQuery({operation:d,data:k,additionalOptions:{id:b.Id},meta:{collectionName:c},isSync:!0});return this.processQuery(l).then(function(){if(e){var a=g.find(f._syncResultInfo.syncedItems[c],function(a){return a.itemId===b.Id});a||f._onItemProcessed(b,c,u.client,j.Constants.offlineItemStates.modified)}})}return d===h.DataQuery.operations.Delete?(f._onItemProcessed(b,c,u.server,j.Constants.offlineItemStates.deleted),this._purgeById(c,b.Id).then(function(){e&&f._onItemProcessed(b,c,u.client,j.Constants.offlineItemStates.deleted)})):void 0},a.prototype._purgeById=function(a,b){return this.queryProcessor.purgeById(a,b)},a.prototype.sync=function(){var a=this;if(a._syncResultInfo=a._syncResultInfo||{syncedItems:{},syncedToServer:0,syncedToClient:0,failedItems:{},error:void 0},!this.isOnline())throw new i.EverliveError({message:"Cannot synchronize while offline"});a._fireSyncStart().then(function(){return a._applySync()}).then(function(b){var c=[];return g.each(b,function(b,d){b&&"rejected"===b.state&&(b.reason&&b.reason.code===i.EverliveErrors.syncConflict.code?c.push(b):a._onItemFailed(b,d))}),c.length?a.sync():void a._fireSyncEnd()})["catch"](function(b){b||(b=new i.EverliveError(i.EverliveErrors.syncErrorUnknown)),a._syncResultInfo.error=b,a._fireSyncEnd()})},a.prototype._handleKeepServer=function(a,b,c,d){var e,f=this,g=b.serverItem,k=b.clientItem;if(g&&k)e=new h.DataQuery({meta:{collectionName:a},operation:h.DataQuery.operations.Update,additionalOptions:{id:g.Id},data:g});else if(g&&!k)e=new h.DataQuery({meta:{collectionName:a},operation:h.DataQuery.operations.Create,data:g});else{if(g||!k)throw new i.EverliveError({message:'Both serverItem and clientItem are not set when syncing data with "KeepServer" resolution strategy.'});e=new h.DataQuery({meta:{collectionName:a},operation:h.DataQuery.operations.DeleteById,additionalOptions:{id:k.Id}})}e.isSync=!0,c.push(new Promise(function(c,i){f.processQuery(e).then(function(){switch(e.operation){case h.DataQuery.operations.Update:f._onItemProcessed(g,a,u.client,j.Constants.offlineItemStates.modified),l.Utils.isContentType.files(a)&&d.modifiedItems.push({remoteItem:b.serverItem,resultingItem:g,resolutionType:j.Constants.ConflictResolution.KeepServer});break;case h.DataQuery.operations.Create:f._onItemProcessed(g,a,u.client,j.Constants.offlineItemStates.created);break;case h.DataQuery.operations.DeleteById:f._onItemProcessed(k,a,u.client,j.Constants.offlineItemStates.deleted)}c()},function(a){var b,c;switch(e.operation){case h.DataQuery.operations.Update:b=g.Id,c=j.Constants.offlineItemStates.modified;break;case h.DataQuery.operations.Create:b=g.Id,c=j.Constants.offlineItemStates.created;break;case h.DataQuery.operations.DeleteById:b=k.Id,c=j.Constants.offlineItemStates.deleted}i({itemId:b,type:c,contentType:e.collectionName,error:a,storage:u.client})})}))},a.prototype._handleKeepClient=function(a,b){var c,d,e=a.serverItem,f=a.clientItem;if(e&&f)c=g.extend(f,{ModifiedAt:new Date(e.ModifiedAt)}),d=b.modifiedItems;else if(e&&!f)c=e,d=b.deletedItems;else{if(e||!f)throw new i.EverliveError({message:'Both serverItem and clientItem are not set when syncing data with "KeepClient" resolution strategy.'});c=f,d=b.createdItems}d.push({remoteItem:a.serverItem,resultingItem:c,resolutionType:j.Constants.ConflictResolution.KeepClient})},a.prototype._handleCustom=function(a,b,c,d){var e=a.serverItem,f=a.clientItem,i=g.omit(a.result.item,"CreatedAt","ModifiedAt");if(e&&i){var k=new h.DataQuery({meta:{collectionName:b},operation:h.DataQuery.operations.Create,data:e,preserveState:!0,isSync:!0});c.push(this.processQuery(k)),this._onItemProcessed(e,b,u.client,j.Constants.offlineItemStates.created)}if(e&&i&&!f)i.Id=e.Id,d.modifiedItems.push({remoteItem:e,resultingItem:i,isCustom:!0});else if(e&&!i)d.deletedItems.push({remoteItem:a.serverItem,resultingItem:e,isCustom:!0});else if(!e&&i&&f){var l=new h.DataQuery({meta:{collectionName:b},operation:h.DataQuery.operations.Update,data:i,additionalOptions:{id:f.Id}});c.push(this.processQuery(l)),i.Id=f.Id,d.createdItems.push({remoteItem:e,resultingItem:i,isCustom:!0})}else i.Id=e.Id,d.modifiedItems.push({remoteItem:e,resultingItem:i,isCustom:!0})},a.prototype._mergeResolvedConflicts=function(a,b){var c=this,d=[];return g.each(a,function(a){var e=a.contentTypeName;g.each(a.conflictingItems,function(a){var f=b[e];switch(a.result.resolutionType){case j.Constants.ConflictResolution.KeepServer:c._handleKeepServer(e,a,d,f);break;case j.Constants.ConflictResolution.KeepClient:c._handleKeepClient(a,f);break;case j.Constants.ConflictResolution.Custom:if(l.Utils.isContentType.files(e))throw new i.EverliveError(i.EverliveErrors.customFileSyncNotSupported);c._handleCustom(a,e,d,f);break;case j.Constants.ConflictResolution.Skip:}})}),Promise.all(d)},a.prototype._getSyncItemStates=function(a,b,c){var d=this,e={itemsForSync:{createdItems:[],modifiedItems:[],modifiedItemsOnServer:[],deletedItems:[],deletedItemsOnServer:[]},conflicts:{contentTypeName:a,conflictingItems:[]}};return g.each(b,function(b){var f=g.findWhere(c,{Id:b.Id});if(f){if(f.Id===b.Id&&b[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.created)return d.options.conflicts.strategy===j.Constants.ConflictResolutionStrategy.Custom?(d._onItemFailed({type:j.Constants.offlineItemStates.modified,storage:u.client,error:new i.EverliveError(i.EverliveErrors.syncError),contentType:a},b.Id),d._onItemFailed({type:j.Constants.offlineItemStates.modified,storage:u.server,error:new i.EverliveError(i.EverliveErrors.syncError),contentType:a},f.Id)):d._onItemFailed({type:j.Constants.offlineItemStates.created,storage:u.client,error:new i.EverliveError(i.EverliveErrors.syncError),contentType:a},f.Id);var h=!!b[j.Constants.offlineItemsStateMarker],k=!1;h&&(k=f.ModifiedAt.getTime()!==b.ModifiedAt.getTime()||b[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.deleted),k?e.conflicts.conflictingItems.push({clientItem:b[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.deleted?null:b,serverItem:f,result:{}}):b[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.deleted?e.itemsForSync.deletedItems.push({remoteItem:f,resultingItem:b}):b[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.modified?e.itemsForSync.modifiedItems.push({remoteItem:f,resultingItem:b}):void 0===b[j.Constants.offlineItemsStateMarker]||null===b[j.Constants.offlineItemsStateMarker]?e.itemsForSync.modifiedItemsOnServer.push(f):e.itemsForSync.modifiedItems.push({remoteItem:f,resultingItem:f})}else b[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.modified?e.conflicts.conflictingItems.push({clientItem:b,serverItem:null,result:{}}):b[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.created?e.itemsForSync.createdItems.push({remoteItem:f,resultingItem:b}):e.itemsForSync.deletedItemsOnServer.push(b);delete b[j.Constants.offlineItemsStateMarker]}),e},a.prototype._setResolutionTypeForItem=function(a,b){b.result={resolutionType:a}},a.prototype._applyResolutionStrategy=function(a){var b=this,c=b.options.conflicts.strategy;return new Promise(function(d,e){for(var f=[],h=0;h<a.length;h++){var k=a[h];if(k.conflictingItems.length)switch(c){case j.Constants.ConflictResolutionStrategy.ServerWins:g.each(k.conflictingItems,b._setResolutionTypeForItem.bind(b,j.Constants.ConflictResolution.KeepServer));break;case j.Constants.ConflictResolutionStrategy.Custom:var l=b.options.conflicts.implementation;if(!l)return e(new i.EverliveError({message:"Implementation of the conflict resolution strategy must be provided when set to Custom"}));f.push(new Promise(function(b){l(a,b)}));break;default:return e(new i.EverliveError({message:"Invalid resolution strategy provided"}))}}Promise.all(f).then(function(){d()})})},a.prototype._getSyncPromiseBatch=function(a,b){var c=this,d=new h.DataQuery({meta:{collectionName:a},query:new q.Query({Id:{$in:b}}),operation:h.DataQuery.operations.Read,applyOffline:!1}),e=k.RequestOptionsBuilder[d.operation],f=e(d),g=new m.Request(c._everlive.setup,f);return r.RequestService.sendRequest(g)},a.prototype._getPlainItemsForSync=function(a,b){return this.options.syncUnmodified&&!b?g.values(a):this.queryProcessor._getDirtyItems(a)},a.prototype._getIdsForSync=function(a,b){return this._shouldAutogenerateIdForContentType(a)?g.pluck(b,"_id"):g.pluck(g.reject(b,function(a){return a[j.Constants.offlineItemsStateMarker]===j.Constants.offlineItemStates.created}),"_id")},a.prototype._getSyncPromiseForCollection=function(a,b){for(var c=[],d=j.Constants.syncBatchSize,e=this._getPlainItemsForSync(a),f=this._getIdsForSync(b,e),h=Math.ceil(f.length/d),i=0;h>i;i++){var k=i*d,l=f.slice(k,k+d),m=this._getSyncPromiseBatch(b,l);c.push(m)}return Promise.all(c).then(function(a){var b={serverItems:[],offlineItemsToSync:e};return g.each(a,function(a){b.serverItems=g.union(b.serverItems,a)}),b})},a.prototype._onItemFailed=function(a,b){var c=this,d=a.reason?a.reason:a,e=d.contentType,f=function(a){var b=g.pick(d,"storage","type","error");return b.error||(b.error=new i.EverliveError(i.EverliveErrors.syncErrorUnknown)),g.extend({itemId:a,contentType:e},b)},h=[];d.type===j.Constants.offlineItemStates.created&&d.items?h=g.map(d.items,function(a){return f(a.Id)}):h.push(f(b)),c._syncResultInfo.failedItems[e]=c._syncResultInfo.failedItems[e]||[],g.each(h,function(a){c._syncResultInfo.failedItems[e].push(a),c._fireItemProcessed(a)})},a.prototype._onItemProcessed=function(a,b,c,d){var e={itemId:a.Id,type:d,storage:c,contentType:b};this._syncResultInfo.syncedItems[b]=this._syncResultInfo.syncedItems[b]||[],this._syncResultInfo.syncedItems[b].push(e),e.storage==u.server?this._syncResultInfo.syncedToServer++:this._syncResultInfo.syncedToClient++,this._fireItemProcessed(e)},a.prototype._fireItemProcessed=function(a){this._everlive.emit(j.Constants.Events.ItemProcessed,a)},a.prototype._getClientWinsSyncData=function(a,b){var c=this,d={};return g.each(a,function(a,e){d[e]||(d[e]={createdItems:[],modifiedItems:[],deletedItems:[],deletedItemsOnServer:[],modifiedItemsOnServer:[]});var f=c._getPlainItemsForSync(a,b),h=n.offlineTransformations.idTransform(f);g.each(h,function(a){switch(a[j.Constants.offlineItemsStateMarker]){case j.Constants.offlineItemStates.created:d[e].createdItems.push({remoteItem:a,resultingItem:a});break;case j.Constants.offlineItemStates.modified:d[e].modifiedItems.push({remoteItem:a,resultingItem:a});break;case j.Constants.offlineItemStates.deleted:d[e].deletedItems.push({remoteItem:a,resultingItem:a})}delete a[j.Constants.offlineItemsStateMarker]})}),d},a.prototype._getModifiedFilesForSyncClientWins=function(a,b,c){var d=this,e=d._everlive;return new Promise(function(f,g){var h=d.files;h.getOfflineLocation(a).then(function(a){return a?d._transferFile(!0,b,a).then(function(a){return a.Result!==!1?{result:a}:void g({type:j.Constants.offlineItemStates.modified,itemId:b.Id,contentType:c,error:a,storage:u.server})},function(a){g({type:j.Constants.offlineItemStates.modified,itemId:b.Id,contentType:c,error:a,storage:u.server})}):e.files.isSync(!0).applyOffline(!1).updateSingle(b).then(function(a){return a},function(a){g({type:j.Constants.offlineItemStates.modified,itemId:b.Id,contentType:c,error:a,storage:u.server})})}).then(function(a){var f=a.result;return b.ModifiedAt=f.ModifiedAt,d._onItemProcessed(b,c,u.server,j.Constants.offlineItemStates.modified),e.files.isSync(!0).useOffline(!0).updateSingle(b)}).then(f)["catch"](function(a){g({type:j.Constants.offlineItemStates.modified,itemId:b.Id,contentType:c,error:a,storage:u.server})})})},a.prototype._getModifiedItemForSyncClientWins=function(a,b,c){var d=this;return new Promise(function(e,f){return a.isSync(!0).applyOffline(!1).updateSingle(b).then(function(a){d._onItemProcessed(b,c,u.server,j.Constants.offlineItemStates.modified);var e=g.extend({},b,{ModifiedAt:a.ModifiedAt}),f=new h.DataQuery({operation:h.DataQuery.operations.Update,data:e,additionalOptions:{id:b.Id},meta:{collectionName:c},isSync:!0});return d.processQuery(f)},function(a){f({storage:u.server,type:j.Constants.offlineItemStates.modified,itemId:b.Id,contentType:c,error:a})}).then(e,function(a){f({storage:u.client,type:j.Constants.offlineItemStates.modified,itemId:b.Id,contentType:c,error:a})})})},a.prototype._addModifiedItemsForSyncClientWins=function(a,b,c){var d=this;this._addUpdatedItemsForSync(a,e,b,c,function(a){var e=a.Id;if(!e)throw new i.EverliveError({message:"When updating an item it must have an Id field."});var f=c.collectionName;b[e]=l.Utils.isContentType.files(f)?d._getModifiedFilesForSyncClientWins(e,a,f):d._getModifiedItemForSyncClientWins(c,a,f)})},a.prototype._addDeletedItemsForSyncClientWins=function(a,b,c){var d=this;this._addDeletedItemsForSync(a,e,b,c,function(a,e){var f=c.collectionName;b[a.Id]=new Promise(function(b,h){var k=a.Id;if(!k)throw new i.EverliveError({message:"When deleting an item it must have an Id field."});return c.isSync(!0).applyOffline(!1).destroySingle(e).then(function(){return d._onItemProcessed(a,f,u.server,j.Constants.offlineItemStates.deleted),d._purgeById(f,a.Id).then(function(){b()},function(a){h(g.extend({},{storage:u.client,type:j.Constants.offlineItemStates.deleted,contentType:f,itemId:k,error:a}))})},function(a){h(g.extend({},{storage:u.server,type:j.Constants.offlineItemStates.deleted,contentType:f,error:a,itemId:k}))})})})},a.prototype._applyClientWins=function(a){var b=this,c=this._getClientWinsSyncData(a,!0),d={};g.each(c,function(a,c){var e=b._everlive.data(c);a.createdItems.length&&b._addCreatedItemsForSync(a,d,e),a.modifiedItems.length&&b._addModifiedItemsForSyncClientWins(a,d,e),a.deletedItems.length&&b._addDeletedItemsForSyncClientWins(a,d,e)});var e;return l.Utils.promiseHashSettled(d).then(function(c){if(e=c,b.options.syncUnmodified){var d=[];return g.each(a,function(a,c){var e=b._getPlainItemsForSync(a),f=g.where(e,function(a){return void 0!==a[j.Constants.offlineItemsStateMarker]}),h=b._everlive.data(c),i=g.pluck(f,"_id"),k=h.isSync(!0).useOffline(!1).get({Id:{$in:i}}).then(function(a){var d=a.result,e=g.pluck(d,"Id");return b._unmodifiedClientWinsItemsDeletedOnServer(c,e,f).then(function(){return b._unmodifiedClientWinsItemsUpdatedOnServer(c,d,f)})});d.push(k)}),Promise.all(d)}}).then(function(){return e})},a.prototype._unmodifiedClientWinsItemsDeletedOnServer=function(a,b,c){var d=this,e=[],f=g.pluck(c,"_id");return g.each(f,function(a){-1===b.indexOf(a)&&e.push(a)}),l.Utils.successfulPromise().then(function(){if(0!==e.length){var b=new h.DataQuery({operation:h.DataQuery.operations.Delete,filter:{Id:{$in:e}},meta:{collectionName:a},isSync:!0});return d.processQuery(b).then(function(){g.each(e,function(b){d._onItemProcessed({Id:b},a,u.client,j.Constants.offlineItemStates.deleted)})})}})},a.prototype._unmodifiedClientWinsItemsUpdatedOnServer=function(a,b,c){var d=this,e=[];return g.each(b,function(b){var f=g.find(c,function(a){return a._id===b.Id});if(f){var i=new h.DataQuery({operation:h.DataQuery.operations.Update,data:b,additionalOptions:{id:f._id},meta:{collectionName:a},isSync:!0}),k=d.processQuery(i).then(function(){d._onItemProcessed(b,a,u.client,j.Constants.offlineItemStates.modified)});e.push(k)}}),Promise.all(e)},a.prototype._modifyFileStandardSync=function(a,b,c,d,e){var f=this,h=f._everlive.files;a[b]=new Promise(function(a,k){var l;f.files.getOfflineLocation(b).then(function(a){l=a}).then(function(){return h.isSync(!0).applyOffline(!1).getById(b)}).then(function(a){var b=a.result;if(b.ModifiedAt.getTime()!==c.ModifiedAt.getTime())k(g.extend({},new i.EverliveError(i.EverliveErrors.syncConflict),{contentType:d}));else if(l){if(e===j.Constants.ConflictResolution.KeepServer)return f.files._saveFile(c.Uri,c.Filename,c.Id).then(function(){return f.offlineFilesProcessor.purge(l)}).then(function(){return a});if(e===j.Constants.ConflictResolution.KeepClient)return f._transferFile(!0,c,l)}}).then(function(){return f._everlive.files.isSync(!0).useOffline(!0).updateSingle(c)}).then(a)["catch"](k)})},a.prototype._modifyContentTypeStandardSync=function(a,b,c,d,e,f,g){var i=this;a[b]=c.isSync(!0).applyOffline(!1).update(d,e).then(function(a){return i._onSyncResponse(a,d,f,h.DataQuery.operations.Update,g)},function(a){return new Promise(function(b,c){c({type:j.Constants.offlineItemStates.modified,itemId:d.Id,contentType:f,error:a,storage:u.server})})})},a.prototype._applyStandardSync=function(a){var b=this,c={};return g.each(a,function(a,d){c[d]=b._getSyncPromiseForCollection(a,d)}),l.Utils.promiseHash(c).then(function(a){return b._prepareSyncData(a)}).then(function(a){return b._resolveConflicts(a)}).then(function(a){var c={};return g.each(a,function(a,e){var f=b._everlive.data(e);a.createdItems.length&&b._addCreatedItemsForSync(a,c,f),a.modifiedItems.length&&b._addUpdatedItemsForSync(a,d,c,f,function(a,d,g,h){var i=a.Id;l.Utils.isContentType.files(e)?b._modifyFileStandardSync(c,i,a,e,h):b._modifyContentTypeStandardSync(c,i,f,a,d,e,g)}),a.deletedItems.length&&b._addDeletedItemsForSync(a,d,c,f,function(a,d,g){c[a.Id]=f.isSync(!0).applyOffline(!1).destroy(d).then(function(c){return b._onSyncResponse(c,a,e,h.DataQuery.operations.Delete,g)},function(b){return new Promise(function(c,d){d({type:j.Constants.offlineItemStates.deleted,itemId:a.Id,contentType:e,error:b,storage:u.server})})})}),g.each(a.deletedItemsOnServer,function(a){c[a.Id]=f.isSync(!0).useOffline(!0).destroySingle({Id:a.Id}).then(function(){return b._onItemProcessed(a,e,u.client,j.Constants.offlineItemStates.deleted)},function(b){return new Promise(function(c,d){d({type:j.Constants.offlineItemStates.deleted,itemId:a.Id,contentType:e,error:b,storage:u.client})})})}),g.each(a.modifiedItemsOnServer,function(a){c[a.Id]=f.isSync(!0).useOffline(!0).update(a,{Id:a.Id}).then(function(){return b._onItemProcessed(a,e,u.client,j.Constants.offlineItemStates.modified)},function(b){return l.Utils.rejectedPromise({type:j.Constants.offlineItemStates.modified,itemId:a.Id,contentType:e,error:b,storage:u.client})})})}),l.Utils.promiseHashSettled(c)})},a.prototype._applySync=function(){var a=this;return this.queryProcessor._getAllCollections().then(function(b){return a.options.conflicts.strategy===j.Constants.ConflictResolutionStrategy.ClientWins?a._applyClientWins(b):a._applyStandardSync(b)})},a.prototype.getItemsForSync=function(a,b){var c=this,d={};return l.Utils.buildPromise(function(a,b){c.queryProcessor._getAllCollections().then(function(b){g.each(b,function(a,b){var e=c._getPlainItemsForSync(a);d[b]=g.map(e,function(a){var b={item:g.extend({},a),action:a[j.Constants.offlineItemsStateMarker]};return delete b.item[j.Constants.offlineItemsStateMarker],b})}),a(d)})["catch"](b)},a,b)},a}();b.OfflineStorageModule=v},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(37),g=c(16),h=function(a){function b(b,c){a.call(this,b,c),this.fileStore=f.getFileStore(c.storage.storagePath,c)}return d(b,a),b.prototype.getAllData=function(b,c){var d=this._fileSystemErrorHandler(c);a.prototype.getAllData.call(this,b,d)},b.prototype.getData=function(a,b,c){var d=this,e=this._fileSystemErrorHandler(c);this.getFileHandle(a,function(a){d._readFileContent(a,b,e)},c)},b.prototype.saveData=function(a,b,c,d){var e=this,f=this._fileSystemErrorHandler(d);this.getFileHandle(a,function(d){e._writeFileContent(d,b,function(){e._saveContentTypes(a,c,f)},f)},f)},b.prototype.purge=function(a,b,c){var d=this,e=this._fileSystemErrorHandler(c);this.getFileHandle(a,function(a){d.fileStore.removeFile(a).then(function(){b()})["catch"](c)},e)},b.prototype.purgeAll=function(a,b){var c=this._fileSystemErrorHandler(b);this.fileStore.removeFilesDirectory().then(function(){a()})["catch"](c)},b.prototype.getFileHandle=function(a,b,c){var d=this,e=this._getFilePath(a);this.fileStore.getFilesDirectory().then(function(){return d.fileStore.getFile(e)}).then(function(a){b(a)})["catch"](c)},b.prototype._getContentTypes=function(a,b){this.getData(this.contentTypesStoreKey,function(b){var c=JSON.parse(b||"[]");a(c)},b)},b.prototype._saveContentTypes=function(a,b,c){var d=this;this._getContentTypes(function(f){e.contains(f,a)||f.push(a),d.getFileHandle(d.contentTypesStoreKey,function(a){d._writeFileContent(a,JSON.stringify(f),b,c)},c)},c)},b.prototype._readFileContent=function(a,b,c){this.fileStore.readFileAsText(a).then(function(a){b(a)})["catch"](c)},b.prototype._writeFileContent=function(a,b,c,d){this.fileStore.writeTextToFile(a,b).then(c)["catch"](d)},b.prototype._getFilePath=function(a){return this._getKey(a)},b.prototype._fileSystemErrorHandler=function(a){return this.fileStore.getErrorHandler(a)},b}(g.BasePersister);b.FileSystemPersister=h},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(38),g=c(16),h=function(a){function b(b,c){a.call(this,b,c),this._localStore=new f.LocalStore(c)}return d(b,a),b.prototype.getData=function(a,b,c){try{var d=this._getKey(a),e=this._getItem(d);b(e)}catch(f){c(f)}},b.prototype.saveData=function(a,b,c,d){try{var e=this._getKey(a);this._setItem(e,b),c()}catch(f){d(f)}},b.prototype.purge=function(a,b,c){var d=this;try{var f=this._getKey(a);this._removeItem(f),this._getContentTypes(function(c){c=e.without(c,a),d._setContentTypesCollection(c),b()},c)}catch(g){c(g)}},b.prototype.purgeAll=function(a,b){var c=this;try{this._getContentTypes(function(b){e.each(b,function(a){var b=c._getKey(a);c._removeItem(b)}),c._removeItem(c.contentTypesStoreKey),a()},b)}catch(d){b(d)}},b.prototype._getItem=function(a){return this._localStore.getItem(a)},b.prototype._setItem=function(a,b){return this._localStore.setItem(a,b)},b.prototype._removeItem=function(a){return this._localStore.removeItem(a)},b.prototype._getKey=function(b){return this._addTypeToCollectionsCache(b),a.prototype._getKey.call(this,b)},b.prototype._getContentTypes=function(a,b){try{var c=this._getItem(this.contentTypesStoreKey),d=[];c&&(d=JSON.parse(c)),a(d)}catch(e){b(e)}},b.prototype._setContentTypesCollection=function(a){this._setItem(this.contentTypesStoreKey,JSON.stringify(a))},b.prototype._addTypeToCollectionsCache=function(a){var b,c=this;if(this._getContentTypes(function(b){e.contains(b,a)||(b.push(a),c._setContentTypesCollection(b))},function(a){return b=a}),b)throw b},b}(g.BasePersister);b.LocalStoragePersister=h},function(a,b,c){"use strict";function d(a,b){if(g.isNativeScript)return new i.NativeScriptSQLiteStore(a,b);if(g.isCordova)return new h.CordovaSQLiteStore(a,b);throw new l.EverliveError({message:"Unsupported platform for SQLite"})}var e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},f=c(1),g=c(5),h=c(79),i=c(81),j=c(16),k=c(69),l=c(3),m=c(4),n=function(a){function b(b,e){a.call(this,b,e);var g={dialect:"sqlite",separatedValues:!1};this.jsonSql=c(174)(g),this.contentTypes=f.keys(e.typeSettings);{var h=this.extendTypeSchemes(e.typeSettings);e.storage.storagePath+"_"+e.appId}this.sqliteStore=d(e.storage.storagePath,h)}return e(b,a),b.prototype.getData=function(a,b,c){return this.queryData(a,b,c)},b.prototype.count=function(a,b,c,d){try{var e=this.prepareCount(a,d);this.sqliteStore.queryData(a,e.query,function(a){var c=a&&a[0]&&a[0].Count?a[0].Count:0;b({Count:c})},c)}catch(f){c(f)}},b.prototype.queryData=function(a,b,c,d,e,f,g,h){try{var i=this.prepareQuery(a,"select",d,e,f,g,h);this.sqliteStore.queryData(a,i.query,b,c)}catch(j){c(j)}},b.prototype.removeData=function(a,b,c,d){try{var e=this.prepareQuery(a,"remove",d);this.sqliteStore.removeData(a,e.query,b,c)}catch(f){c(f)}},b.prototype.updateData=function(a,b,c,d,e){try{var f=this.prepareUpdate(a,b,e);this.sqliteStore.updateData(a,f.query,c,d)}catch(g){d(g)}},b.prototype.saveData=function(a,b,c,d){try{this.sqliteStore.addData(a,b,c,d)}catch(e){d(e)}},b.prototype.purgeById=function(a,b,c,d){var e=this.prepareQuery(a,"remove",{_id:b});this.sqliteStore.removeData(a,e.query,function(){c()},d)},b.prototype.purge=function(a,b,c){var d=this.prepareQuery(a,"remove");this.sqliteStore.removeData(a,d.query,function(){b()},c)},b.prototype.purgeAll=function(a,b){var c=this,d=f.map(this.options.typeSettings,function(a,b){var d=c.prepareQuery(b,"remove"),e=new Promise(function(a,e){c.sqliteStore.removeData(b,d.query,a,e)});return e});return Promise.all(d).then(function(){a()},b)},b.prototype.extendTypeSchemes=function(a){var b={};return f.each(a,function(a,c){b[c]=k.getDefinition(c,a.Scheme)}),b.Files||(b.Files=k.getDefinition("Files",[])),b.Users||(b.Users=k.getDefinition("Users",[])),b},b.prototype.prepareCount=function(a,b){var c={type:"select",table:a};c.count={Count:"COUNT(*)"},b&&(c.condition=b);var d=this.jsonSql.build(c);return d},b.prototype.prepareUpdate=function(a,b,c){var d={type:"update",table:a};b.$set&&delete b.$set.Meta,f.each(b.$set,function(a,c){a instanceof Date&&(b.$set[c]=a.toISOString())}),d.modifier=b,c&&(d.condition=c);var e=this.jsonSql.build(d);return e},b.prototype.prepareFilter=function(a){this.traverseAndRemoveUndefined(a),this.traverseAndTransformRegexFilter(a)},b.prototype.traverseAndTransformRegexFilter=function(a){if(a&&a.$regex){var b=m.Utils.startsWith(a.$regex,"^")?"":"%",c=m.Utils.endsWith(a.$regex,"$")?"":"%",d=a.$regex.substring(1,a.$regex.length-1);a.$like=""+b+d+c,delete a.$regex,delete a.$options}for(var e in a)if(a.hasOwnProperty(e)){var f=a[e];"object"==typeof f&&this.traverseAndTransformRegexFilter(f)}},b.prototype.traverseAndRemoveUndefined=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];"object"==typeof c?this.traverseAndRemoveUndefined(c):void 0===c&&delete a[b]}},b.prototype.prepareQuery=function(a,b,c,d,e,g,h){var i={type:b,table:a};c&&(this.prepareFilter(c),i.condition=c),d&&(i.sort=d),e&&(i.offset=e),g&&(i.limit=g),h&&(i.fields=f.keys(h));var j=this.jsonSql.build(i);return j},b.prototype._getContentTypes=function(a){a(this.contentTypes)},b}(j.BasePersister);b.SQLitePersister=n},function(a,b,c){"use strict";var d=c(2),e=function(){function a(a,b,c){this.name=a,this.type=b,this.key=c,this.isSpecialType=void 0!==d.Constants.SqliteUnsupportedTypes[this.type]}return a.prototype.getDefinition=function(){var a=this.isSpecialType?d.Constants.SqliteTypes.Text:this.type,b='"'+this.name+'" "'+a+'"';return this.key&&(b+=" "+this.key),b},a}();b.FieldDefinition=e},function(a,b,c){"use strict";function d(a,b){var c=null;return c=i.Utils.isContentType.files(a)?new l:i.Utils.isContentType.users(a)?new k:new j,c.extendScheme(b)}var e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},f=c(1),g=c(68),h=c(2),i=c(4),j=function(){function a(){this._scheme=[],this._scheme.push(new g.FieldDefinition("_id",h.Constants.SqliteTypes.Text,"PRIMARY KEY")),this._scheme.push(new g.FieldDefinition("CreatedAt",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("ModifiedAt",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("CreatedBy",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("ModifiedBy",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("Owner",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("Meta",h.Constants.SqliteUnsupportedTypes.OBJECT)),this._scheme.push(new g.FieldDefinition(h.Constants.offlineItemsStateMarker,h.Constants.SqliteTypes.Text))}return a.prototype.extendScheme=function(a){var b=f.map(a,function(a){return new g.FieldDefinition(a.Name,a.Type||h.Constants.SqliteTypes.Text)}),c=f.union(b,this._scheme);return c},a}(),k=function(a){function b(){a.call(this),this._scheme.push(new g.FieldDefinition("Username",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("Email",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("DisplayName",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("Role",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("IdentityProvider",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("IsVerified",h.Constants.SqliteUnsupportedTypes.BOOLEAN))}return e(b,a),b}(j),l=function(a){function b(){a.call(this),this._scheme.push(new g.FieldDefinition("Filename",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("ContentType",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("Length",h.Constants.SqliteTypes.Number)),this._scheme.push(new g.FieldDefinition("totalSize",h.Constants.SqliteTypes.Number)),this._scheme.push(new g.FieldDefinition("Storage",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("Uri",h.Constants.SqliteTypes.Text)),this._scheme.push(new g.FieldDefinition("base64",h.Constants.SqliteTypes.Text))}return e(b,a),b}(j);b.getDefinition=d},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(9),g=c(4),h=c(15),i=c(5),j=c(3),k=c(2),l=c(33),m=c(134),n=c(181),o=c(207),p=function(a){function b(b,c,d,e,f){a.call(this,b,c,d,e,f),this.persister=b,this._encryptionProvider=c,this.offlineFilesProcessor=d,this.everlive=e,this.setup=f,this._collectionCache={}}return d(b,a),b.prototype.processQuery=function(a){var b=a.collectionName;if(g.Utils.isContentType.pushDevices(b)||g.Utils.isContentType.pushNotifications(b))return this.everlive.isOnline()?g.Utils.successfulPromise():g.Utils.rejectedPromise(new j.EverliveError(j.EverliveErrors.pushNotSupportedOffline));var c=this.checkSupportedQuery(a);if(c&&!a.isSync)return new Promise(function(a,b){b(new j.EverliveError(c))});var d=a.getQueryParameters(),e=g.Utils.getUnsupportedOperators(d.filter),f=e.length;if(f)return new Promise(function(a,b){var c;c=1===f?"The operator "+e[0]+" is not supported in offline mode.":"The operators "+e.join(",")+"are not supported in offline mode.",b(new j.EverliveError({message:c,code:j.EverliveErrors.operationNotSupportedOffline.code}))});switch(h.offlineTransformations.traverseAndTransformFilterId(d.filter),a.operation){case k.DataQueryOperation.Read:return this.read(a,d.filter,d.sort,d.skip,d.limit,d.select,d.expand);case k.DataQueryOperation.ReadById:return this.readById(a,d.expand);case k.DataQueryOperation.FilesGetDownloadUrlById:return this.getDownloadUrlById(a);case k.DataQueryOperation.Count:return this.count(a,d.filter);case k.DataQueryOperation.Create:return this.create(a);case k.DataQueryOperation.RawUpdate:case k.DataQueryOperation.Update:
return this.update(a,d.filter);case k.DataQueryOperation.FilesUpdateContent:return this.updateFileContent(a);case k.DataQueryOperation.Delete:return this.remove(a,d.filter);case k.DataQueryOperation.DeleteById:return this.remove(a,{_id:a.additionalOptions.id});case k.DataQueryOperation.Aggregate:return this.aggregate(a,d);default:return new Promise(function(b,c){if(a.isSync)b();else{var d=k.DataQueryOperation[a.operation];c(new j.EverliveError({message:d+" is not supported in offline mode."}))}})}},b.prototype.create=function(a){var b=this;return b._createItems(a.collectionName,a.data,a.isSync,a.preserveState).then(function(c){var d=g.Utils.isContentType.files(a.collectionName);return b._getCreateResult(c,d)})},b.prototype.read=function(a,b,c,d,e,f,g){var i,j=this;return new Promise(function(k,l){var m;j._prepareExpand(g,a,!0).then(function(b){return i=b,b&&(f=b.mainQueryFieldsExpression),j._getCollection(a.collectionName)}).then(function(g){var k=j._readInternal(g,b,c,d,e,f);if(d||e){var l=j._readInternal(g);m=l.length}return k=j._shouldAutogenerateIdForContentType(a.collectionName)?h.offlineTransformations.idTransform(k):h.offlineTransformations.removeIdTransform(k,!0),j._expandResult(i,k)}).then(function(b){var c=j._transformOfflineResult(b,m,a);k(c)})["catch"](l)})},b.prototype._readInternal=function(a,b,c,d,f,g){var i=e.extend({},b),j=this._getWithoutDeletedFilter(i);h.offlineTransformations.traverseAndTransformFilterId(j);var k=m.Query(j),l=m.Cursor(a,k,g);return c&&(l=l.sort(c)),d&&l.skip(d),f&&l.limit(f),e.map(l.all(),function(a){return e.extend({},a)})},b.prototype.readById=function(a,b){var c,d=this;return d._prepareExpand(b,a,!1).then(function(b){return c=b,d._getCollection(a.collectionName)}).then(function(b){return new Promise(function(e,f){var g=d._getById(b,a.additionalOptions.id);return g?(g=h.offlineTransformations.idTransform(g),d._expandResult(c,g).then(e)["catch"](f)):f(new j.EverliveError(j.EverliveErrors.itemNotFound))})}).then(function(b){return d._transformOfflineResult(b,null,a)})},b.prototype._getById=function(a,b){if(!b)throw new j.EverliveError({message:"Id field is mandatory when using offline storage"});if(a[b]){var c=e.extend({},a[b]),d=c&&c[k.Constants.offlineItemsStateMarker]===k.Constants.offlineItemStates.deleted;return d?void 0:c}},b.prototype._getUpdateItemsResult=function(a){var b=a.length,c=b?a[0].ModifiedAt:new Date;return{ModifiedAt:c,result:b}},b.prototype.update=function(a,b){var c=this;return this._updateItems(a,a.data,b,a.isSync).then(function(a){return c._getUpdateItemsResult(a)})},b.prototype.remove=function(a,b){return this._removeItems(a,b,a.isSync)},b.prototype.count=function(a,b){var c=this;return new Promise(function(d,e){c._getCollection(a.collectionName).then(function(a){var e=c._readInternal(a,b);d({result:e.length})})["catch"](e)})},b.prototype._mapCreateItem=function(a,b,c,d,f){function h(){return i._setItemDates(a,l,f),i._setItem(b,e.extend({},l),m),l}var i=this,l=e.extend({},a);l._id=l.Id||g.Utils.uuid(),delete l.Id;var m,n=i._getById(b,l._id),o=!!n;if(o&&!c&&!d)throw new j.EverliveError({message:"An item with the specified id already exists"});return m=c&&d&&o?n[k.Constants.offlineItemsStateMarker]:c?void 0:k.Constants.offlineItemStates.created,g.Utils.isContentType.files(f)?i.offlineFilesProcessor.upsertFileFromObject(l,!0,c).then(h):h()},b.prototype._createItems=function(a,b,c,d){var f=this;return this._getCollection(a).then(function(g){var i=e.isArray(b)?b:[b],j=e.map(i,function(b){return f._mapCreateItem(b,g,c,d,a)});return Promise.all(j).then(function(b){return f._persistData(a).then(function(){return f._shouldAutogenerateIdForContentType(a)||c||(j=h.offlineTransformations.removeIdTransform(b)),b})})})},b.prototype._applyUpdateOperation=function(a,b,c,d,f){var h,i=g.Utils.getDbOperators(a,!0),j=0!==i.length;h=j?a:{$set:a};var l={ModifiedBy:this.everlive.setup.principalId||k.Constants.guidEmpty};h.$set=e.extend(l,h.$set),d&&(h.$set.ModifiedAt=g.Utils.cloneDate(a.ModifiedAt||f)),n(b,{},h,{strict:!0}),b._id=b._id||h._id||h.Id,delete b.Id;var m;m=d?void 0:b[k.Constants.offlineItemsStateMarker]===k.Constants.offlineItemStates.created?k.Constants.offlineItemStates.created:k.Constants.offlineItemStates.modified,this._setItem(c,b,m)},b.prototype.updateFileContent=function(a){if(i.isDesktop)return g.Utils.successfulPromise();var b,c=a.isSync,d=a.data,e=this,f=a.additionalOptions.id,h=a.collectionName;return this._getCollection(h).then(function(a){var g=e._getById(a,f);return b=[g],g.base64=d.base64,g.Filename=d.Filename,g.ContentType=d.ContentType,delete g.Uri,e._overwriteFile(f,g,c).then(function(){return e._applyUpdateOperation(d,g,a),e._setItem(a,g,k.Constants.offlineItemStates.modified),e._persistData(h)}).then(function(){return e._getUpdateItemsResult(b)})})},b.prototype._updateItems=function(a,b,c,d){var e=this,h=a.collectionName;return e._getCollection(h).then(function(i){var k;if(a.additionalOptions&&a.additionalOptions.id){var l=a.additionalOptions.id,m=e._getById(i,l);if(!m)throw new j.EverliveError({message:"Item with id :"+l+" does not exist offline in the collection :"+h,code:j.EverliveErrors.itemNotFound.code});if(k=[m],g.Utils.isContentType.files(h)&&b.$set&&b.$set.Filename||b.Filename){var n=b.Filename||b.$set.Filename,o=f.extname(n);return e.everlive.offlineStorage.files.changeFileExtensionById(l,o).then(function(){return e._applyUpdateOperation(b,m,i,d,a.ModifiedAt),e._persistData(h)}).then(function(){return k})}e._applyUpdateOperation(b,m,i,d,a.ModifiedAt)}else{k=e._readInternal(i,c);for(var p=0;p<k.length;p++){var q=k[p],r=!!e._getById(i,q._id.toString());if(!r&&!d)throw new j.EverliveError(j.EverliveErrors.itemNotFound);e._applyUpdateOperation(b,q,i,d,a.ModifiedAt)}}return e._persistData(h).then(function(){return k})})},b.prototype._getAllCollections=function(){var a=this;return new Promise(function(b,c){a.persister.getAllData(function(c){e.each(c,function(b,d){var e=a._encryptionProvider.decrypt(b);c[d]=JSON.parse(e||"{}",g.Utils.parseUtilities.getReviver())}),b(c)},c)})},b.prototype._getCollection=function(a){var b=this;return new Promise(function(c,d){b._collectionCache[a]?c(b._collectionCache[a]):b.persister.getData(a,function(d){var e=b._encryptionProvider.decrypt(d),f=JSON.parse(e||"{}",g.Utils.parseUtilities.getReviver());b._collectionCache[a]=f,c(b._collectionCache[a])},d)})},b.prototype._setItem=function(a,b,c){c?b[k.Constants.offlineItemsStateMarker]=c:delete b[k.Constants.offlineItemsStateMarker],a[b._id]=b},b.prototype._persistData=function(a){var b=this;return new Promise(function(c,d){var e=b._collectionCache[a]||{};b._transformPersistedData(a,e);var f=JSON.stringify(e),g=b._encryptionProvider.encrypt(f);b.persister.saveData(a,g,c,d)})},b.prototype._shouldAutogenerateIdForContentType=function(a){return!(this.setup&&this.setup.typeSettings&&this.setup.typeSettings[a]&&this.setup.typeSettings[a].autoGenerateId===!1)},b.prototype._clearItem=function(a,b){delete a[b._id]},b.prototype._mapRemoveItem=function(a,b,c,d){var e=this;return new Promise(function(b,c){return g.Utils.isContentType.files(d)&&!i.isDesktop?e.everlive.offlineStorage.files.purge(a._id).then(b,c):b()}).then(function(){a._id=a._id||a.Id;var d=!!e._getById(b,a._id.toString());if(!d&&!c)throw new j.EverliveError({message:"Cannot delete item - item with id "+a._id+" does not exist."});var f=a[k.Constants.offlineItemsStateMarker]===k.Constants.offlineItemStates.created||c;f?e._clearItem(b,a):e._setItem(b,a,k.Constants.offlineItemStates.deleted)})},b.prototype._removeItems=function(a,b,c){var d=this,f=a.collectionName;return d._getCollection(f).then(function(a){var g=d._readInternal(a,b),h=e.map(g,function(b){return d._mapRemoveItem(b,a,c,f)});return Promise.all(h)}).then(function(a){return d._persistData(f).then(function(){return a})}).then(function(a){return d._transformOfflineResult(a.length)})},b.prototype.aggregate=function(a,b){var c=this;return this._getCollection(a.collectionName).then(function(d){if(!b||!b.aggregate||e.isEmpty(b.aggregate))throw new j.EverliveError({message:"You must specify a valid aggregation definition. Either GroupBy or Aggregate is required."});var f=e.extend({},b.aggregate);f.Filter=b.filter;var g=o.translate(f,{maxDocumentsCount:k.Constants.Aggregation.MaxDocumentsCount}),h=e.filter(d,function(a){return a[k.Constants.offlineItemsStateMarker]!==k.Constants.offlineItemStates.deleted}),i=m.aggregate(h,g);return c._transformOfflineResult(i,null,a)})},b.prototype.purgeAll=function(b,c){return this._collectionCache={},a.prototype.purgeAll.call(this,b,c)},b.prototype.purge=function(b,c,d){return delete this._collectionCache[b],a.prototype.purge.call(this,b,c,d)},b.prototype.purgeById=function(a,b){var c=this;return this._getCollection(a).then(function(d){return delete d[b],c._persistData(a)})},b}(l.OfflineQueryProcessor);b.OfflineInMemoryQueryProcessor=p},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(9),g=c(5),h=c(3),i=c(33),j=c(4),k=c(15),l=c(2),m=function(a){function b(){a.apply(this,arguments)}return d(b,a),b.prototype.processQuery=function(a){var b=a.collectionName;if(j.Utils.isContentType.pushDevices(b)||j.Utils.isContentType.pushNotifications(b))return this.everlive.isOnline()?j.Utils.successfulPromise():j.Utils.rejectedPromise(new h.EverliveError(h.EverliveErrors.pushNotSupportedOffline));var c=this.checkSupportedQuery(a);if(c&&!a.isSync)return new Promise(function(a,b){b(new h.EverliveError(c))});var d=a.getQueryParameters(),e=j.Utils.getUnsupportedOperators(d.filter),f=e.length;if(f)return new Promise(function(a,b){var c;c=1===f?"The operator "+e[0]+" is not supported in offline mode.":"The operators "+e.join(",")+"are not supported in offline mode.",b(new h.EverliveError({message:c,code:h.EverliveErrors.operationNotSupportedOffline.code}))});switch(k.offlineTransformations.traverseAndTransformFilterId(d.filter),k.offlineTransformations.traverseAndTransformFilterId(d.select),k.offlineTransformations.traverseAndTransformFilterId(d.sort),a.operation){case l.DataQueryOperation.Read:return this.read(a,d.filter,d.sort,d.skip,d.limit,d.select,d.expand);case l.DataQueryOperation.ReadById:return this.readById(a,d.expand);case l.DataQueryOperation.FilesGetDownloadUrlById:return this.getDownloadUrlById(a);case l.DataQueryOperation.Count:return this.count(a,d.filter);case l.DataQueryOperation.Create:return this.create(a);case l.DataQueryOperation.RawUpdate:case l.DataQueryOperation.Update:return this.update(a,d.filter);case l.DataQueryOperation.FilesUpdateContent:return this.updateFileContent(a);case l.DataQueryOperation.Delete:return this.remove(a,d.filter);case l.DataQueryOperation.DeleteById:return this.remove(a,{_id:a.additionalOptions.id});case l.DataQueryOperation.Aggregate:return new Promise(function(b,c){var d=l.DataQueryOperation[a.operation];c(new h.EverliveError({message:d+" is not supported in offline mode."}))});default:return new Promise(function(b,c){if(a.isSync)b();else{var d=l.DataQueryOperation[a.operation];c(new h.EverliveError({message:d+" is not supported in offline mode."}))}})}},b.prototype.update=function(a,b){return this._updateItems(a,a.data,b,a.isSync).then(function(a){return{ModifiedAt:new Date,result:a}})},b.prototype.updateFileContent=function(a){var b=this;if(g.isDesktop)return j.Utils.successfulPromise();var c,d=a.isSync,e=a.data,f=a.additionalOptions.id,h=a.collectionName;return this._getById(h,f).then(function(a){var g=a[0];return c=[g],g.base64=e.base64,g.Filename=e.Filename,g.ContentType=e.ContentType,delete g.Uri,b._overwriteFile(f,g,d).then(function(){return b._getUpdatePromise(h,e,{_id:f})}).then(function(a){return{ModifiedAt:new Date,result:a}})})},b.prototype._getById=function(a,b){var c=this;return new Promise(function(d,e){c.persister.queryData(a,d,e,{_id:b})})},b.prototype._updateItems=function(a,b,c,d){var e=this,g=a.collectionName;if(a.additionalOptions&&a.additionalOptions.id){var h=a.additionalOptions.id;c={_id:h}}if(j.Utils.isContentType.files(g)&&b.$set&&b.$set.Filename||b.Filename){var i=b.Filename||b.$set.Filename,k=f.extname(i);return this.everlive.offlineStorage.files.changeFileExtensionById(a.additionalOptions.id,k).then(function(){return e._getUpdatePromise(g,b,c,d,a.ModifiedAt)})}return this._getUpdatePromise(g,b,c,d,a.ModifiedAt)},b.prototype._getUpdatePromise=function(a,b,c,d,f){var g=this._applyUpdateOperation(a,b,c,l.Constants.offlineItemStates.created,d,f),h=this._applyUpdateOperation(a,b,c,l.Constants.offlineItemStates.modified,d,f);return Promise.all([g,h]).then(function(a){var b=0;return e.each(a,function(a){b+=a}),b},function(){return 0})},b.prototype._applyUpdateOperation=function(a,b,c,d,f,g){var h,i=this,k=j.Utils.getDbOperators(b,!0),m=0!==k.length;h=m?b:{$set:b};var n={ModifiedBy:this.everlive.setup.principalId||l.Constants.guidEmpty};return h.$set=e.extend(n,h.$set),delete h.$set.Id,f&&(h.$set.ModifiedAt=j.Utils.cloneDate(b.$set&&b.$set.ModifiedAt?b.$set.ModifiedAt:b.ModifiedAt||g)),delete c[l.Constants.offlineItemsStateMarker],f?h.$set[l.Constants.offlineItemsStateMarker]="":d===l.Constants.offlineItemStates.created?(c[l.Constants.offlineItemsStateMarker]=l.Constants.offlineItemStates.created,h.$set[l.Constants.offlineItemsStateMarker]=d):(c.$or=[(o={},o[l.Constants.offlineItemsStateMarker]=l.Constants.offlineItemStates.modified,o),(p={},p[l.Constants.offlineItemsStateMarker]={$is:null},p)],h.$set[l.Constants.offlineItemsStateMarker]=l.Constants.offlineItemStates.modified),new Promise(function(b,d){i.persister.updateData(a,h,b,d,c)});var o,p},b.prototype.readById=function(a,b){var c,d=this;return this._prepareExpand(b,a,!1).then(function(b){return c=b,a.additionalOptions.id?new Promise(function(b,c){var e=a.additionalOptions.id;d.persister.queryData(a.collectionName,b,c,{_id:e})}):Promise.reject(new h.EverliveError({message:"Id field is mandatory when using offline storage"}))}).then(function(a){var b=a[0];return b?(b=k.offlineTransformations.idTransform(b),d._expandResult(c,b)):Promise.reject(new h.EverliveError(h.EverliveErrors.itemNotFound))}).then(function(b){var c=d._transformOfflineResult(b,null,a);return c})},b.prototype.remove=function(a,b){return this._removeItems(a,b,a.isSync)},b.prototype._purgeFiles=function(a,b,c){var d=this;this.persister.queryData("Files",function(a){var c=e.map(a,function(a){return d.everlive.offlineStorage.files.purge(a._id)});return Promise.all(c).then(b)},function(a){c(a)},a)},b.prototype._removeItems=function(a,b,c){var d=this;return new Promise(function(c,e){return!j.Utils.isContentType.files(a.collectionName)||g.isDesktop?c():b?void d._purgeFiles(b,c,e):c()}).then(function(){var f=a.collectionName,g=new Promise(function(a,c){var g=b?e.clone(b):{};g[l.Constants.offlineItemsStateMarker]=l.Constants.offlineItemStates.created,d.persister.removeData(f,a,c,g)}),h=new Promise(function(a,g){if(c){var h=b.Id||b._id;h?d.persister.purgeById(f,h,a,g):b?d.persister.removeData(f,a,g,b):d.persister.purge(f,a,g)}else{var i=b?e.clone(b):{};i.$or=[(j={},j[l.Constants.offlineItemsStateMarker]=l.Constants.offlineItemStates.modified,j),(k={},k[l.Constants.offlineItemsStateMarker]={$is:null},k)],d.persister.updateData(f,(m={},m[l.Constants.offlineItemsStateMarker]=l.Constants.offlineItemStates.deleted,m),a,g,i)}var j,k,m});return Promise.all([g,h]).then(function(a){var b=0;return e.each(a,function(a){a&&(b+=a)}),d._transformOfflineResult(b)})})},b.prototype.count=function(a,b){var c=this;return new Promise(function(d,e){c.persister.count(a.collectionName,function(a){d({result:a.Count})},e,b)})},b.prototype._persistData=function(a,b){var c=this;return new Promise(function(d,e){c._transformPersistedData(a,b),c.persister.saveData(a,b,d,e)})},b.prototype.read=function(a,c,d,f,g,i,j){var l=this;b._handleIdInSelect(i);var m=b._validateSelectMode(i);if(!m){var n=new h.EverliveError(h.EverliveErrors.generalDatabaseError);return n.message="You cannot mix including and excluding fields.",Promise.reject(n)}var o;return new Promise(function(b,h){l._prepareExpand(j,a,!0).then(function(b){o=b,b&&(i=b.mainQueryFieldsExpression);var h=e.extend({},c),k=l._getWithoutDeletedFilter(h,!0);return l._readInternal(a.collectionName,k,d,f,g,i,j)}).then(function(c){var d=function(d){d&&(d=d.Count),c=l._shouldAutogenerateIdForContentType(a.collectionName)?k.offlineTransformations.idTransform(c):k.offlineTransformations.removeIdTransform(c,!0),l._expandResult(o,c).then(function(c){var e=l._transformOfflineResult(c,d,a);b(e)},h)};f||g?l.persister.count(a.collectionName,d,h):d()})["catch"](h)})},b._validateSelectMode=function(a){if(!j.Utils.existsAndIsNotEmpty(a))return!0;for(var b=null,c=e.keys(a),d=0;d<c.length;d+=1){var f=c[d],g=a[f];if("_id"!==f&&"Id"!==f&&a.hasOwnProperty(f))if(null==b)b=g;else if(g!=b)return!1}return!0},b._handleIdInSelect=function(a){if(j.Utils.existsAndIsNotEmpty(a)){var b=a._id||a.Id;0!==b&&(a._id=1)}},b.prototype._readInternal=function(a,b,c,d,e,f){var g=this;return new Promise(function(h,i){g.persister.queryData(a,h,i,b,c,d,e,f)})},b.prototype.create=function(a){var b=this;return this._createItems(a.collectionName,a.data,a.isSync,a.preserveState).then(function(c){var d=j.Utils.isContentType.files(a.collectionName);return b._getCreateResult(c,d)})},b.prototype._createItems=function(a,b,c,d){var f=this,g=e.isArray(b)?b:[b],h=e.map(g,function(b){var g=e.extend({},b);return g._id=g.Id||j.Utils.uuid(),delete g.Id,f._getById(a,g._id).then(function(e){var h,i=e[0]&&e[0][l.Constants.offlineItemsStateMarker]!==l.Constants.offlineItemStates.deleted;h=c&&d&&i?e[0][l.Constants.offlineItemsStateMarker]:c?void 0:l.Constants.offlineItemStates.created;var k=function(){return f._setItemDates(b,g,a),h?g[l.Constants.offlineItemsStateMarker]=h:delete g[l.Constants.offlineItemsStateMarker],g};return j.Utils.isContentType.files(a)?f.offlineFilesProcessor.upsertFileFromObject(g,!0,c).then(k):k()})});return Promise.all(h).then(function(b){return f._persistData(a,b).then(function(){return f._shouldAutogenerateIdForContentType(a)||c||(h=k.offlineTransformations.removeIdTransform(b)),b})})},b.prototype._getAllCollections=function(){var a=this;return new Promise(function(b,c){a.persister.getAllData(function(a){e.each(a,function(b,c){var d={};e.each(b,function(a){var b=a._id,c=JSON.stringify(a),e=JSON.parse(c,j.Utils.parseUtilities.getReviver());d[b]=e}),a[c]=d}),b(a)},c)})},b}(i.OfflineQueryProcessor);b.OfflineSQLiteQueryProcessor=m},function(a,b,c){"use strict";function d(a){if(f.isNativeScript){var b=c(35);return new b(a)}if(f.isCordova||f.isDesktop){var d=c(34);return new d(a)}return{}}function e(){if(f.isNativeScript){var a=c(35);a.ensurePushIsAvailable()}else if(f.isCordova||f.isDesktop){var b=c(34);b.ensurePushIsAvailable()}}var f=c(5);b.getCurrentDevice=d,b.ensurePushIsAvailable=e},function(a,b,c){"use strict";function d(a,b){var c=b.getQueryParameters();return a.filter=c.filter,a.fields=c.select,a.sort=c.sort,a.skip=c.skip,a.take=c.limit||c.take,a.expand=c.expand,a.aggregate=c.aggregate,c}function e(a,b){a.settings={useOffline:b.useOffline,applyOffline:b.applyOffline,ignoreCache:b.ignoreCache,forceCache:b.forceCache}}var f=c(8),g=c(2),h=function(){function a(){}return a.fromDataQuery=function(b){var c=new a;if(c.contentTypeName=b.collectionName,b.additionalOptions&&b.additionalOptions.id)switch(b.operation){case f.DataQueryOperation.Update:c.operation=f.DataQueryOperation.UpdateById;break;case f.DataQueryOperation.Delete:c.operation=f.DataQueryOperation.DeleteById;break;default:c.operation=b.operation}else c.operation=b.operation;c.itemId=b.additionalOptions?b.additionalOptions.id:void 0,c.data=b.data,e(c,b),d(c,b),c.headers=b.getHeaders();var h=c.headers[g.Constants.Headers.powerFields];return"string"==typeof h&&(c.powerfields=JSON.parse(h)),c.isSync=b.isSync,c},a.prototype.cancel=function(){this._cancelled=!0},a.prototype.isCancelled=function(){return this._cancelled},a}();b.EventQuery=h},function(a,b,c){"use strict";var d=c(19),e=c(2),f=e.Constants.OperatorType,g=function(){function a(a,b,c){this.parent=a,this.single=c,this.expr=new d.Expression(b||f.where),this.parent.expr.addOperand(this.expr)}return a.prototype.and=function(){return new a(this,f.and)},a.prototype.or=function(){return new a(this,f.or)},a.prototype.not=function(){return new a(this,f.not,!0)},a.prototype._simple=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return this.expr.addOperand(new d.Expression(a,b)),this._done()},a.prototype.eq=function(a,b){return this._simple(f.equal,a,b)},a.prototype.ne=function(a,b){return this._simple(f.not_equal,a,b)},a.prototype.gt=function(a,b){return this._simple(f.gt,a,b)},a.prototype.gte=function(a,b){return this._simple(f.gte,a,b)},a.prototype.lt=function(a,b){return this._simple(f.lt,a,b)},a.prototype.lte=function(a,b){return this._simple(f.lte,a,b)},a.prototype.isin=function(a,b){return this._simple(f.isin,a,b)},a.prototype.notin=function(a,b){return this._simple(f.notin,a,b)},a.prototype.all=function(a,b){return this._simple(f.all,a,b)},a.prototype.size=function(a,b){return this._simple(f.size,a,b)},a.prototype.regex=function(a,b,c){return this._simple(f.regex,a,b,c)},a.prototype.startsWith=function(a,b,c){return this._simple(f.startsWith,a,b,c)},a.prototype.endsWith=function(a,b,c){return this._simple(f.endsWith,a,b,c)},a.prototype.nearSphere=function(a,b,c,d){return this._simple(f.nearShpere,a,b,c,d)},a.prototype.withinBox=function(a,b,c){return this._simple(f.withinBox,a,b,c)},a.prototype.withinPolygon=function(a,b){return this._simple(f.withinPolygon,a,b)},a.prototype.withinCenterSphere=function(a,b,c,d){return this._simple(f.withinShpere,a,b,c,d)},a.prototype.done=function(){return this.parent instanceof a?this.parent._done():this.parent},a.prototype._done=function(){return this.single?this.parent:this},a.prototype.equal=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.eq.apply(this,a)},a.prototype.notEqual=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.ne.apply(this,a)},a.prototype.greaterThan=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.gt.apply(this,a)},a.prototype.greaterThanEqual=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.gt.apply(this,a)},a.prototype.lessThan=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.lt.apply(this,a)},a.prototype.lessThanEqual=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return this.lt.apply(this,a)},a}();b.WhereQuery=g},function(a,b,c){"use strict";function d(a){var b={url:a.url,method:a.method,headers:a.headers||{}};return a.data&&(b.content=a.data),b.headers[f.Constants.Headers.ContentType]=b.contentType||"application/json",new Promise(function(a,c){return e.request(b).then(function(b){var d=b.content.toString(),e=JSON.parse(d);b.statusCode<400?a(e):c(d)},function(a){c(a)})})}var e=c(139),f=c(2);a.exports=d},function(a,b,c){(function(b){"use strict";function d(a){var c,d=e.parse(a.url);c="https:"===d.protocol?g.request:i.request;var h=a.headers||{};return h[j.Constants.Headers.ContentType]=a.contentType,new Promise(function(e,g){var i=c({method:a.method,hostname:d.hostname,port:d.port,path:d.path,headers:h},function(a){var b,c="",d=a.headers["content-encoding"];switch(d){case"gzip":b=f.createGunzip(),a.pipe(b);break;default:b=a,b.setEncoding("utf8")}b.on("data",function(a){c+=a.toString()}),b.on("end",function(){if(200<=a.statusCode&&a.statusCode<400){var b=JSON.parse(c);e(b)}else if(c)g(c);else{var d=new k.EverliveError({message:"Response error."});d.statusCode=a.statusCode,g(d)}})});if(i.on("error",function(a){g({responseText:a})}),a.data){var j=h["content-encoding"];switch(j){case"gzip":var l=new b(a.data,"utf-8");f.gzip(l,function(a,b){i.end(b)});break;default:i.end(a.data)}}else i.end()})}var e=null,f=null,g=null;try{e=c(220),f=c(221),g=c(214)}catch(h){throw h}var i=c(139),j=c(2),k=c(3);a.exports=d}).call(b,c(18).Buffer)},function(a,b,c){"use strict";var d=c(2),e=c(10),f=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,f){if(a.operation===d.DataQueryOperation.InvokeCloudFunction||a.operation===d.DataQueryOperation.InvokeStoredProcedure)return b.next(f);var g=null;switch(a.operation){case d.DataQueryOperation.ReadById:case d.DataQueryOperation.Aggregate:case d.DataQueryOperation.Count:case d.DataQueryOperation.Create:case d.DataQueryOperation.SetAcl:case d.DataQueryOperation.FilesGetDownloadUrlById:case d.DataQueryOperation.UserLinkWithProvider:case d.DataQueryOperation.UserUnlinkFromProvider:g=e.Request.parsers.single;break;case d.DataQueryOperation.RawUpdate:case d.DataQueryOperation.Update:g=e.Request.parsers.update;break;default:g=a.isCustomRequest?e.Request.parsers.customRequest:e.Request.parsers.simple}var h=g.result(f);return b.next(h)},a}();b.ResponseParserProcessor=f},function(a,b,c){"use strict";var d=c(1),e=c(8),f=function(){function a(){}return a.prototype.mergeResultData=function(a,b){var c=b.result;return d.isArray(a)||"number"==typeof a.length?d.each(a,function(a,b){d.extend(a,c[b])}):d.extend(a,c),b},a.prototype.mergeUpdateResultData=function(a,b){var c=b.ModifiedAt;return a.ModifiedAt=c,b},a.prototype.processDataQuery=function(a,b,c,d){var f=null;switch(a.operation){case e.DataQueryOperation.Update:f=this.mergeUpdateResultData(a.data,d);break;case e.DataQueryOperation.Create:f=this.mergeResultData(a.data,d);break;case e.DataQueryOperation.FilesGetDownloadUrlById:f=d.result.Uri;break;default:f=d}return b.next(f)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=f},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(39),g=function(){return new Promise(function(a){document.addEventListener("deviceready",a)})},h=function(a){function b(b,c){var d=this;a.call(this,b,c),g().then(function(){d.sqliteDb=window.sqlitePlugin.openDatabase({name:d.storagePath+".db",location:"default"}),d.prepareTables()})}return d(b,a),b.prototype.queryData=function(a,b,c,d){var e=this;this.sqliteDb.transaction(function(f){f.executeSql(b,[],function(b,d){for(var f=[],g=0;g<d.rows.length;g++)f.push(e.processResultItem(a,d.rows.item(g)));c(f)},function(a,b){d(b)})})},b.prototype.addData=function(a,b,c,d){var f=this,g=this.buildSqlBatchInsert(a,b),h=e.map(g,function(a){return new Promise(function(b,c){f.sqliteDb.sqlBatch(a,function(){b()},function(a){c(a)})})});return Promise.all(h).then(c,d)},b.prototype.removeData=function(a,b,c,d){this.sqliteDb.transaction(function(a){a.executeSql(b,[],function(a,b){c(b.rowsAffected)},function(a,b){d(b)})})},b.prototype.updateData=function(a,b,c,d){this.sqliteDb.transaction(function(a){a.executeSql(b,[],function(a,b){c(b.rowsAffected)},function(a,b){d(b)})})},b.prototype.ensureTableExists=function(a,b){var c=this,d='CREATE TABLE IF NOT EXISTS "'+a+'" (_id TEXT PRIMARY KEY)';this.sqliteDb.transaction(function(f){f.executeSql(d,[],function(){e.each(b,function(b){var d='ALTER TABLE "'+a+'" ADD COLUMN '+b.getDefinition();c.sqliteDb.executeSql(d)})},function(a,b){throw console.log(b),b})})},b}(f.BaseSQLiteStore);b.CordovaSQLiteStore=h},function(a,b,c){"use strict";var d=function(){function a(a,b){this.storagePath=a,this.options=b,this.options=b;try{this.fs=c(213)}catch(d){throw d}this.dataDirectoryPath=this.fs.knownFolders.documents().path,this.filesDirectoryPath=this.fs.path.join(this.dataDirectoryPath,a)}return a.prototype.getErrorHandler=function(a){return function(b){a&&a(b)}},a.prototype.removeFilesDirectory=function(){var a=this;return a.getFilesDirectory().then(function(a){return a.remove()})},a.prototype.removeFile=function(a){return a.remove()},a.prototype.readFileAsText=function(a){return a.readText()},a.prototype.writeTextToFile=function(a,b){return a.writeText(b)},a.prototype.getFile=function(a){var b=this;return new Promise(function(c,d){b.resolveDataDirectory().then(function(d){var e=b.fs.path.join(d.path,a),f=b.fs.File.fromPath(e);c(f)})["catch"](d)})},a.prototype.getFilesDirectory=function(){var a=this;return new Promise(function(b){var c=a.fs.Folder.fromPath(a.filesDirectoryPath);b(c)})},a.prototype.resolveDataDirectory=function(){var a=this;return new Promise(function(b){var c=a.fs.Folder.fromPath(a.dataDirectoryPath);b(c)})},a.prototype.ensureFilesDirectory=function(){var a=this;return new Promise(function(b,c){a.resolveDataDirectory().then(function(c){var d=a.fs.path.join(c.path,a.filesDirectoryPath);a.fs.Folder.fromPath(d),b()})["catch"](c)})},a.prototype.getFilesDirectoryPath=function(){return this.filesDirectoryPath},a.prototype.writeText=function(){throw new Error("Not implemented")},a.prototype.createDirectory=function(){throw new Error("Not implemented")},a.prototype.getFileSize=function(){throw new Error("Not implemented")},a.prototype.getFileByAbsolutePath=function(){throw new Error("Not implemented")},a.prototype.readFileAsBase64=function(){throw new Error("Not implemented")},a.prototype.renameFile=function(){throw new Error("Not implemented")},a}();b.NativeScriptFileStore=d},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(39),f=c(1),g=function(a){function b(b,d){var e=this;a.call(this,b,d);var f;try{f=c(217)}catch(g){throw g}new f(this.storagePath+".db",function(a,b){if(a)throw console.error("Failed to open database",a),a;e.sqliteDb=b,e.sqliteDb.resultType(f.RESULTSASOBJECT),e.prepareTables()})}return d(b,a),b.prototype.queryData=function(a,b,c,d){var e=this;this.sqliteDb.all(b,[],function(b,f){if(b)d(b);else{for(var g=[],h=0;h<f.length;h++)g.push(e.processResultItem(a,f[h]));c(g)}})},b.prototype.addData=function(a,b,c,d){var e=this,g=this.buildSqlBatchInsert(a,b);if(0===g.length)return c();var h=[];return f.each(g,function(a){f.each(a,function(a){h.push(new Promise(function(b,c){e.sqliteDb.execSQL(a[0],a[1],function(a){a?c(a):b()})}))})}),Promise.all(h).then(c,d)},b.prototype.removeData=function(a,b,c,d){this.sqliteDb.execSQL(b,function(a,b){a?d(a):c(b)})},b.prototype.updateData=function(a,b,c,d){this.sqliteDb.execSQL(b,function(a,b){a?d(a):c(b)})},b.prototype.ensureTableExists=function(a,b){var c=this,d="CREATE TABLE IF NOT EXISTS "+a+" (_id TEXT PRIMARY KEY)";this.sqliteDb.execSQL(d,[],function(){f.each(b,function(b){var d="ALTER TABLE "+a+" ADD COLUMN "+b.getDefinition();c.sqliteDb.execSQL(d,function(){})})},function(a){throw console.log(a),a})},b}(e.BaseSQLiteStore);b.NativeScriptSQLiteStore=g},function(a,b,c){"use strict";var d=c(1),e=c(5),f=c(3),g=c(4),h=function(){return new Promise(function(a){document.addEventListener("deviceready",a)})},i=function(){function a(a,b){var c=this;this.options=b;var d;e.isWindowsPhone||e.isInAppBuilderSimulator()?d=a.replace(new RegExp("/","g"),""):-1===a.lastIndexOf("/")&&(d=a+"/"),d=d||a,h().then(function(){c.filesDirectoryPath=d,c._requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,c._resolveLocalFileSystemURL=window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL,c._PERSISTENT_FILE_SYSTEM=window.LocalFileSystem?window.LocalFileSystem.PERSISTENT:window.PERSISTENT})}return a.prototype.getErrorHandler=function(a){var b={1000:"NOT_FOUND"};return d.each(Object.keys(FileError),function(a){b[FileError[a]]=a}),function(c){c.message||(c.message=b[c.code]),a&&a(c)}},a.prototype.getDataDirectory=function(){var a=this;return h().then(function(){var b=function(b,c,d){a._requestFileSystem.call(window,a._PERSISTENT_FILE_SYSTEM,b,function(b){a.fileSystemRoot=b.root,a.fileSystemRoot.nativeURL=a.fileSystemRoot.nativeURL||a.fileSystemRoot.toURL(),
c(a.fileSystemRoot)},d)};return new Promise(function(c,d){if(a.fileSystemRoot)return c(a.fileSystemRoot);if(e.isDesktop){if(navigator&&!navigator.webkitPersistentStorage)return d(new f.EverliveError({message:"FileSystemStorage can be used only with browsers supporting it. Consider using localStorage."}));navigator.webkitPersistentStorage.requestQuota(a.options.storage.requestedQuota,function(a){b(a,c,d)},d)}else b(0,c,d)})})},a.prototype.getFilesDirectory=function(){var a=this;return new Promise(function(b,c){a.getDataDirectory().then(function(d){d.getDirectory(a.filesDirectoryPath,{create:!0,exclusive:!1},b,c)})["catch"](c)})},a.prototype.removeFilesDirectory=function(){var a=this;return this.getFilesDirectory().then(function(b){return a._removeFolderWrap(b)})},a.prototype.removeFile=function(a){return new Promise(function(b,c){a.remove(function(){b()},c)})},a.prototype.readFileAsText=function(a){var b=this;return new Promise(function(c,d){b.getFilesDirectory().then(function(){a.file(function(a){var b=new FileReader;b.onloadend=function(){var a=this.result;"object"==typeof this.result&&(a=JSON.stringify(this.result)),c(a)},b.onerror=d,b.readAsText(a)},d)})["catch"](d)})},a.prototype.writeTextToFile=function(a,b){var c=this;return c.getFilesDirectory().then(function(){return c._getWriterWrap(a,b)})},a.prototype.getFileSize=function(a,b){var c=this;return new Promise(function(d,e){var f=g.Utils.joinPath(b,a);return c.getFile(f).then(function(a){a.file(function(a){d(a.size)},e)})})},a.prototype.getFile=function(a,b){return this.getFilesDirectory().then(function(c){var d;return d=b?b:c,new Promise(function(b,c){d.getFile(a,{create:!0,exclusive:!1},b,c)})})},a.prototype.getFileByAbsolutePath=function(a){var b=this;return a=g.Utils.transformPlatformPath(a),new Promise(function(c,d){b._resolveLocalFileSystemURL.call(window,a,c,function(a){return a&&a.code===FileError.NOT_FOUND_ERR?c():d(a)})})},a.prototype.createDirectory=function(a){var b=this;return this.getFilesDirectory().then(function(c){return b._getDirectoryWrap(a,c,{create:!0,exclusive:!1})})},a.prototype.renameFile=function(a,b,c){return new Promise(function(d,e){b.moveTo(a,c,d,e)})},a.prototype._getDirectoryWrap=function(a,b,c){return new Promise(function(d,e){b.getDirectory(a,c,d,e)})},a.prototype._removeFolderWrap=function(a){return new Promise(function(b,c){a.removeRecursively(function(){b()},c)})},a.prototype._getWriterWrap=function(a,b){return new Promise(function(c,d){a.createWriter(function(a){a.onwriteend=function(){c()},a.onerror=d;var e=new Blob([b]);a.write(e)},d)})},a.prototype.writeText=function(a,b,c){var d,e=this;return this.getFilesDirectory().then(function(a){return c?e.createDirectory(c):a}).then(function(b){return e.getFile(a,b)}).then(function(a){return d=a,e.writeTextToFile(a,b)}).then(function(){return d.nativeURL||d.toURL()})},a.prototype.readFileAsBase64=function(a){return new Promise(function(b,c){a.file(function(a){var c=new FileReader;c.onloadend=function(a){b(g.Utils.arrayBufferToBase64(a.target.result))},c.readAsArrayBuffer(a)},c)})},a}();b.WebFileStore=i},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(4),f=c(5),g=c(17),h=c(2),i=function(a){function b(b){a.call(this,b,"Files")}return d(b,a),b.prototype.getUploadUrl=function(){return e.Utils.buildUrl(this.setup)+this.collectionName},b.prototype.getDownloadUrl=function(a){return e.Utils.buildUrl(this.setup)+this.collectionName+"/"+a+"/Download"},b.prototype.getUpdateUrl=function(a){return e.Utils.buildUrl(this.setup)+this._getUpdateUrl(a)},b.prototype.updateContent=function(a,b,c,d){var e=b,f={id:a},g=this.buildDataQuery({data:e,additionalOptions:f},h.DataQueryOperation.FilesUpdateContent);return this.processDataQuery(g,c,d)},b.prototype.getDownloadUrlById=function(a,b,c){if(f.isDesktop&&!this.sdk.isOnline()){var d=this.getDownloadUrl(a);return e.Utils.buildPromise(function(a){return a(d)},b,c)}var g={id:a},i=this.buildDataQuery({additionalOptions:g},h.DataQueryOperation.FilesGetDownloadUrlById);return this.processDataQuery(i,b,c)},b.prototype.download=function(a,b,c,d,f,g){var h=this;return void 0===d&&(d=!1),e.Utils.buildPromise(function(e,f){var g=c&&c.headers?c.headers:{},i=new FileTransfer;h.withHeaders(g).getById(a).then(function(g){var h=g.result;a=h.Uri,i.download(a,b,e,f,d,c)},f)},f,g)},b.prototype.upload=function(a,b,c,d,f){void 0===c&&(c=!1);var g=this.getUploadUrl();return e.Utils.buildPromise(function(d,e){var f=new FileTransfer,h=encodeURI(g);f.upload(a,h,d,e,b,c)},d,f)},b.prototype._getUpdateUrl=function(a){return this.collectionName+"/"+a+"/Content"},b}(g.Data);b.Files=i},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(4),g=c(3),h=c(17),i=c(2),j=function(a){function b(b){a.call(this,b,"Users")}return d(b,a),b.prototype.register=function(a,b,c,d,g){f.Utils.guardUnset(a,"username"),f.Utils.guardUnset(b,"password");var h=e.extend({Username:a,Password:b},c);return this.create(h,d,g)},b.prototype.currentUser=function(a,b){var c=this,d=this.sdk._isOfflineStorageEnabled()&&this.sdk.isOffline()?this.sdk.setup.principalId:"me";return f.Utils.buildPromise(function(a,b){return("me"!==d||c.sdk.setup.token||c.sdk.setup.masterKey)&&d?void c.getById(d).then(function(b){a("undefined"!=typeof b.result?{result:b.result}:{result:null})},function(d){c.sdk.authentication&&c.sdk.authentication.isAuthenticationInProgress()?a({result:null}):601===d.code?a({result:null}):b(801===d.code?new g.EverliveError(g.EverliveErrors.invalidToken):d)}):a({result:null})},a,b)},b.prototype.changePassword=function(a,b,c,d,e,g){var h=this;void 0===d&&(d=!1);var j={Username:a,Password:b,NewPassword:c},k={keepTokens:d},l=this.buildDataQuery({data:j,additionalOptions:k},i.DataQueryOperation.UserChangePassword);return f.Utils.buildPromise(function(a,b){h.processDataQuery(l).then(function(b){return b&&b.result&&(d||h.clearAuthorization()),a(b)})["catch"](b)},e,g)},b.prototype.login=function(a,b,c,d){return this.sdk.authentication.login(a,b,c,d)},b.prototype.logout=function(a,b){return this.sdk.authentication.logout(a,b)},b.prototype.loginWithFacebook=function(a,b,c){return this.sdk.authentication.loginWithFacebook(a,b,c)},b.prototype.linkWithFacebook=function(a,b,c,d){var e={Provider:"Facebook",Token:b};return this._linkWithProvider(e,a,c,d)},b.prototype.unlinkFromFacebook=function(a,b,c){return this._unlinkFromProvider("Facebook",a,b,c)},b.prototype.loginWithADFS=function(a,b,c){return this.sdk.authentication.loginWithADFS(a,b,c)},b.prototype.linkWithADFS=function(a,b,c,d){var e={Provider:"ADFS",Token:b};return this._linkWithProvider(e,a,c,d)},b.prototype.unlinkFromADFS=function(a,b,c){return this._unlinkFromProvider("ADFS",a,b,c)},b.prototype.linkWithSAML=function(a,b,c,d){var e={Provider:"SAML",Token:b};return this._linkWithProvider(e,a,c,d)},b.prototype.unlinkFromSAML=function(a,b,c){return this._unlinkFromProvider("SAML",a,b,c)},b.prototype.loginWithLiveID=function(a,b,c){return this.sdk.authentication.loginWithLiveID(a,b,c)},b.prototype.linkWithLiveID=function(a,b,c,d){var e={Provider:"LiveID",Token:b};return this._linkWithProvider(e,a,c,d)},b.prototype.unlinkFromLiveID=function(a,b,c){return this._unlinkFromProvider("LiveID",a,b,c)},b.prototype.loginWithGoogle=function(a,b,c){return this.sdk.authentication.loginWithGoogle(a,b,c)},b.prototype.linkWithGoogle=function(a,b,c,d){var e={Provider:"Google",Token:b};return this._linkWithProvider(e,a,c,d)},b.prototype.unlinkFromGoogle=function(a,b,c){return this._unlinkFromProvider("Google",a,b,c)},b.prototype.loginWithTwitter=function(a,b,c,d){return this.sdk.authentication.loginWithTwitter(a,b,c,d)},b.prototype.linkWithTwitter=function(a,b,c,d,e){var f={Provider:"Twitter",Token:b,TokenSecret:c};return this._linkWithProvider(f,a,d,e)},b.prototype.loginWithSAML=function(a,b,c){return this.sdk.authentication.loginWithGoogle(a,b,c)},b.prototype.unlinkFromTwitter=function(a,b,c){return this._unlinkFromProvider("Twitter",a,b,c)},b.prototype.setAuthorization=function(a,b,c){this.sdk.authentication.setAuthorization(a,b,c)},b.prototype.clearAuthorization=function(){this.sdk.authentication.setAuthorization(null,null,null)},b.prototype.resetPassword=function(a,b,c){var d=this.buildDataQuery(a,i.DataQueryOperation.UserResetPassword);return this.processDataQuery(d,b,c)},b.prototype.setPassword=function(a,b,c){var d=this.buildDataQuery(a,i.DataQueryOperation.UserSetPassword);return this.processDataQuery(d,b,c)},b.prototype.skipAuth=function(b){return a.prototype.skipAuth.call(this,b)},b.prototype._linkWithProvider=function(a,b,c,d){var e=this.buildDataQuery({additionalOptions:{id:b},data:a},i.DataQueryOperation.UserLinkWithProvider);return this.processDataQuery(e,c,d)},b.prototype._unlinkFromProvider=function(a,b,c,d){var e=this.buildDataQuery({additionalOptions:{id:b},data:{Provider:a}},i.DataQueryOperation.UserUnlinkFromProvider);return this.processDataQuery(e,c,d)},b}(h.Data);b.Users=j},function(a,b,c){"use strict";var d=c(1),e=c(4),f=c(3),g=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,g){var h=c.sdk._isOfflineStorageEnabled();a.useOffline=h?!c.sdk.isOnline():!1;var i=c.sdk.setup.caching===!0||c.sdk.setup.caching&&c.sdk.setup.caching.enabled,j=e.Utils.isQuerySupportedOffline(a);if(c.options&&(a=d.extend(a,c.options),c.options=null),a.useCache=i&&!a.isSync&&j,a.applyOffline=void 0!==a.applyOffline?a.applyOffline:h||a.useCache,!a.useCache&&(a.forceCache||a.maxAge||a.ignoreCache)){var k=void 0;k=a.forceCache?"forceCache":a.maxAge?"maxAge":"ignoreCache";var l=f.EverliveErrorHelper.buildCacheDisabledErrorMessage(k);return b.error(new f.EverliveError({message:l,code:f.EverliveErrors.cacheDisabled.code}))}return b.next(g)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=g},function(a,b,c){"use strict";var d=c(3),e=c(2),f=c(4),g=c(5),h=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,h){if(!a.isSync&&c.offlineStorage&&c.offlineStorage.isSynchronizing()){var i=new d.EverliveError(d.EverliveErrors.syncInProgress);return b.error(i)}if(f.Utils.isContentType.files(c.collectionName)&&g.isDesktop){var j=a.operation;if(a.useOffline&&a.applyOffline&&(j===e.DataQueryOperation.Create||j===e.DataQueryOperation.Update)){var i=new d.EverliveError(d.EverliveErrors.filesNotSupportedInBrowser);return b.error(i)}}return b.next(h)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=h},function(a,b,c){"use strict";var d=c(1),e=c(4),f=c(3),g=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,g){if(!a.skipAuth&&c.sdk.authentication&&c.sdk.authentication.isAuthenticationInProgress()){if(b.prependOnceListener("error",function(h,i){var j=e.Utils.parseUtilities.parseErrorOrResponse(h);if(j&&(j.code===f.EverliveErrors.invalidToken.code||j.code===f.EverliveErrors.expiredToken.code)){i.cancel();var k=c.sdk.authentication._ensureAuthentication();if(a.noRetry)return b.next(g);k.then(function(){if(a.headers&&a.headers.authorization){var f=e.Utils.buildAuthHeader(c.sdk.setup);d.extend(a.headers,f)}return b.restart()})}}),c.sdk.authentication.isAuthenticating()){var h=c.sdk.authentication._ensureAuthentication();return a.noRetry||h.then(function(){return b.restart()}),h}return b.next(g)}return b.next(g)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=g},function(a,b,c){"use strict";var d=c(2),e=c(11),f=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,f){var g=a.operation;if(g!==d.DataQueryOperation.InvokeCloudFunction&&g!==d.DataQueryOperation.InvokeStoredProcedure)return b.next(f);var h=e.RequestService.buildRequest(a,c);return h.send().then(function(a){return b.end(a)})["catch"](function(a){return b.error(a)})},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=f},function(a,b,c){"use strict";var d=c(11),e=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,d){return!a.useCache||a.useCache&&a.canUseOffline?b.next(d):this._cacheDataQuery(a,c).then(function(a){return b.next(a||d)},function(a){return b.error(a)})},a.prototype._cacheDataQuery=function(a,b){var c=b.sdk.cache._shouldSkipCache(a);if(c){if(a.ignoreCache&&!b.sdk.cache.isQueryUnsupportedOffline(a)){var e=b.sdk.cache._getHashForQuery(a);return b.sdk.cache._cacheQuery(a,e,b)}return d.RequestService.handleRequestProcessing(a,b)}return a.useCache=!1,b.sdk.cache._processCacheItem(a,b)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e},function(a,b,c){"use strict";var d=c(1),e=c(2),f=c(73),g=[e.DataQueryOperation.Count,e.DataQueryOperation.Read,e.DataQueryOperation.Create,e.DataQueryOperation.Update,e.DataQueryOperation.UpdateById,e.DataQueryOperation.Delete,e.DataQueryOperation.DeleteById,e.DataQueryOperation.ReadById,e.DataQueryOperation.Aggregate,e.DataQueryOperation.RawUpdate],h=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,h){if(d.contains(g,a.operation)){var i=f.EventQuery.fromDataQuery(a);if(c.sdk.emit(e.Constants.Events.BeforeExecute,i),i.isCancelled())return b.cancel();a.applyEventQuery(i)}return b.next(h)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=h},function(a,b,c){"use strict";var d=c(3),e=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,e){if(!a.canUseOffline)return b.next(e);if(a.applyOffline)return c.offlineStorage.processQuery(a).then(function(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];return b.next.apply(b,a)},function(a){return a.code||(a=new d.EverliveError({message:a.message,code:d.EverliveErrors.generalDatabaseError.code})),b.error(a)});var f=new d.EverliveError({message:"The applyOffline must be true when working offline."});return b.error(f)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e},function(a,b,c){"use strict";var d=c(11),e=function(){function a(){}return a.prototype.processDataQuery=function(a,b,c,e){return a.canUseOffline||a.useCache?b.next(e):d.RequestService.handleRequestProcessing(a,c).then(function(a){return b.next(a||e)},function(a){return b.error(a)})},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e},function(a,b,c){(function(d){function e(){return"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function f(){var a=arguments,c=this.useColors;if(a[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+a[0]+(c?"%c ":" ")+"+"+b.humanize(this.diff),!c)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function g(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function h(a){try{null==a?b.storage.removeItem("debug"):b.storage.debug=a}catch(c){}}function i(){try{return b.storage.debug}catch(a){}return"undefined"!=typeof d&&"env"in d?d.env.DEBUG:void 0}function j(){try{return window.localStorage}catch(a){}}b=a.exports=c(152),b.log=g,b.formatArgs=f,b.save=h,b.load=i,b.useColors=e,b.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:j(),b.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],b.formatters.j=function(a){try{return JSON.stringify(a)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}},b.enable(i())}).call(b,c(7))},function(a,b,c){function d(a,b,c){if(~b.indexOf(".")){for(var d=b.split("."),f=a,g=0;g<d.length-1;g++)Number(d[g])==d[g]&&"array"==e(f)?f=f[d[g]]:"object"==e(f)&&(c&&!f.hasOwnProperty(d[g])&&(f[d[g]]={}),f&&(f=f[d[g]]));return f}return a}var e=c(183);b.get=function(a,b){if(!~b.indexOf("."))return a[b];var c=d(a,b),f=b.split(".").pop(),g=e(c);return"object"==g||"array"==g?c[f]:void 0},b.set=function(a,b,c){if(~b.indexOf(".")){var f=d(a,b,!0),g=b.split(".").pop();f&&"object"==e(f)&&(f[g]=c)}else a[b]=c},b.parent=d},function(a,b,c){function d(a,b){switch(e(a)){case"null":case"undefined":return null==b;case"regexp":return a.test(b);case"array":if("array"==e(b)&&a.length==b.length){for(var c=0;c<a.length;c++)if(!d(b[c],a[c]))return!1;return!0}return!1;case"object":var f={};for(var c in a){if(a.hasOwnProperty(c)&&(!b.hasOwnProperty(c)||!d(a[c],b[c])))return!1;f[c]=!0}for(var c in b)if(b.hasOwnProperty(c)&&!f.hasOwnProperty(c))return!1;return!0;default:return a===b}}var e=c(25);a.exports=d},function(a,b){var c=Object.prototype.hasOwnProperty;b.keys=Object.keys||function(a){var b=[];for(var d in a)c.call(a,d)&&b.push(d);return b},b.values=function(a){var b=[];for(var d in a)c.call(a,d)&&b.push(a[d]);return b},b.merge=function(a,b){for(var d in b)c.call(b,d)&&(a[d]=b[d]);return a},b.length=function(a){return b.keys(a).length},b.isEmpty=function(a){return 0==b.length(a)}},function(a,b,c){function d(a,b){this.afterTransform=function(a,c){return e(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,i.isNullOrUndefined(c)||a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(a,this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){i.isFunction(this._flush)?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
a.exports=f;var h=c(13),i=c(26);i.inherits=c(27),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(){var a=this._transformState;i.isNull(a.writechunk)||!a.writecb||a.transforming?a.needTransform=!0:(a.transforming=!0,this._transform(a.writechunk,a.writeencoding,a.afterTransform))}},function(a,b,c){(function(b){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(a,b){var d=c(13);a=a||{};var e=a.highWaterMark,f=a.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.objectMode=!!a.objectMode,b instanceof d&&(this.objectMode=this.objectMode||!!a.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var g=a.decodeStrings===!1;this.decodeStrings=!g,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(b,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function f(a){var b=c(13);return this instanceof f||this instanceof b?(this._writableState=new e(a,this),this.writable=!0,void x.call(this)):new f(a)}function g(a,c,d){var e=new Error("write after end");a.emit("error",e),b.nextTick(function(){d(e)})}function h(a,c,d,e){var f=!0;if(!(w.isBuffer(d)||w.isString(d)||w.isNullOrUndefined(d)||c.objectMode)){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),b.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return!a.objectMode&&a.decodeStrings!==!1&&w.isString(b)&&(b=new v(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),w.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing||b.corked?b.buffer.push(new d(c,e,f)):k(a,b,!1,g,c,e,f),h}function k(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function l(a,c,d,e,f){d?b.nextTick(function(){c.pendingcb--,f(e)}):(c.pendingcb--,f(e)),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,c){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),c)l(a,d,e,c,f);else{var g=r(a,d);g||d.corked||d.bufferProcessing||!d.buffer.length||q(a,d),e?b.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),b.pendingcb--,d(),t(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){if(b.bufferProcessing=!0,a._writev&&b.buffer.length>1){for(var c=[],d=0;d<b.buffer.length;d++)c.push(b.buffer[d].callback);b.pendingcb++,k(a,b,!0,b.length,b.buffer,"",function(a){for(var d=0;d<c.length;d++)b.pendingcb--,c[d](a)}),b.buffer=[]}else{for(var d=0;d<b.buffer.length;d++){var e=b.buffer[d],f=e.chunk,g=e.encoding,h=e.callback,i=b.objectMode?1:f.length;if(k(a,b,!1,i,f,g,h),b.writing){d++;break}}d<b.buffer.length?b.buffer=b.buffer.slice(d):b.buffer.length=0}b.bufferProcessing=!1}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function t(a,b){var c=r(a,b);return c&&(0===b.pendingcb?(s(a,b),b.finished=!0,a.emit("finish")):s(a,b)),c}function u(a,c,d){c.ending=!0,t(a,c),d&&(c.finished?b.nextTick(d):a.once("finish",d)),c.ended=!0}// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
a.exports=f;var v=c(18).Buffer;f.WritableState=e;var w=c(26);w.inherits=c(27);var x=c(28);w.inherits(f,x),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return w.isFunction(b)&&(c=b,b=null),w.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),w.isFunction(c)||(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(d.pendingcb++,e=j(this,d,a,b,c)),e},f.prototype.cork=function(){var a=this._writableState;a.corked++},f.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.buffer.length||q(this,a))},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype._writev=null,f.prototype.end=function(a,b,c){var d=this._writableState;w.isFunction(a)?(c=a,a=null,b=null):w.isFunction(b)&&(c=b,b=null),w.isNullOrUndefined(a)||this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||u(this,d,c)}}).call(b,c(7))},function(a,b,c){(function(a,d){function e(a,b){this._id=a,this._clearFn=b}var f=c(7).nextTick,g=Function.prototype.apply,h=Array.prototype.slice,i={},j=0;b.setTimeout=function(){return new e(g.call(setTimeout,window,arguments),clearTimeout)},b.setInterval=function(){return new e(g.call(setInterval,window,arguments),clearInterval)},b.clearTimeout=b.clearInterval=function(a){a.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},b.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},b.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},b._unrefActive=b.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},b.setImmediate="function"==typeof a?a:function(a){var c=j++,d=arguments.length<2?!1:h.call(arguments,1);return i[c]=!0,f(function(){i[c]&&(d?a.apply(null,d):a.call(null),b.clearImmediate(c))}),c},b.clearImmediate="function"==typeof d?d:function(a){delete i[a]}}).call(b,c(99).setImmediate,c(99).clearImmediate)},function(a){"use strict";function b(a){this.name="ExpandError",this.message=a,this.stack=(new Error).stack}b.prototype=new Error,a.exports=b},function(a,b,c){(function(a,c,d,e){!function(a,c){c(b)}(this,function(b){"use strict";function f(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function g(a,b,c){return b=gb(void 0===b?a.length-1:b,0),function(){for(var d=arguments,e=-1,g=gb(d.length-b,0),h=Array(g);++e<g;)h[e]=d[b+e];e=-1;for(var i=Array(b+1);++e<b;)i[e]=d[e];return i[b]=c(h),f(a,this,i)}}function h(a){return a}function i(a,b){return g(a,b,h)}function j(a){return i(function(b,c){var d=hb(function(c,d){var e=this;return a(b,function(a,b){a.apply(e,c.concat([b]))},d)});return c.length?d.apply(this,c):d})}function k(a){var b=nb.call(a,pb),c=a[pb];try{a[pb]=void 0;var d=!0}catch(e){}var f=ob.call(a);return d&&(b?a[pb]=c:delete a[pb]),f}function l(a){return rb.call(a)}function m(a){return null==a?void 0===a?tb:sb:(a=Object(a),ub&&ub in a?k(a):l(a))}function n(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function o(a){if(!n(a))return!1;var b=m(a);return b==wb||b==xb||b==vb||b==yb}function p(a){return"number"==typeof a&&a>-1&&a%1==0&&zb>=a}function q(a){return null!=a&&p(a.length)&&!o(a)}function r(){}function s(a){return function(){if(null!==a){var b=a;a=null,b.apply(this,arguments)}}}function t(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function u(a){return null!=a&&"object"==typeof a}function v(a){return u(a)&&m(a)==Cb}function w(){return!1}function x(a,b){return b=null==b?Ob:b,!!b&&("number"==typeof a||Pb.test(a))&&a>-1&&a%1==0&&b>a}function y(a){return u(a)&&p(a.length)&&!!mc[m(a)]}function z(a){return function(b){return a(b)}}function A(a,b){var c=Hb(a),d=!c&&Gb(a),e=!c&&!d&&Nb(a),f=!c&&!d&&!e&&uc(a),g=c||d||e||f,h=g?t(a.length,String):[],i=h.length;for(var j in a)!b&&!wc.call(a,j)||g&&("length"==j||e&&("offset"==j||"parent"==j)||f&&("buffer"==j||"byteLength"==j||"byteOffset"==j)||x(j,i))||h.push(j);return h}function B(a){var b=a&&a.constructor,c="function"==typeof b&&b.prototype||xc;return a===c}function C(a,b){return function(c){return a(b(c))}}function D(a){if(!B(a))return yc(a);var b=[];for(var c in Object(a))Ac.call(a,c)&&"constructor"!=c&&b.push(c);return b}function E(a){return q(a)?A(a):D(a)}function F(a){var b=-1,c=a.length;return function(){return++b<c?{value:a[b],key:b}:null}}function G(a){var b=-1;return function(){var c=a.next();return c.done?null:(b++,{value:c.value,key:b})}}function H(a){var b=E(a),c=-1,d=b.length;return function(){var e=b[++c];return d>c?{value:a[e],key:e}:null}}function I(a){if(q(a))return F(a);var b=Bb(a);return b?G(b):H(a)}function J(a){return function(){if(null===a)throw new Error("Callback was already called.");var b=a;a=null,b.apply(this,arguments)}}function K(a){return function(b,c,d){function e(a,b){if(i-=1,a)h=!0,d(a);else{if(b===Bc||h&&0>=i)return h=!0,d(null);f()}}function f(){for(;a>i&&!h;){var b=g();if(null===b)return h=!0,void(0>=i&&d(null));i+=1,c(b.value,b.key,J(e))}}if(d=s(d||r),0>=a||!b)return d(null);var g=I(b),h=!1,i=0;f()}}function L(a,b,c,d){K(b)(a,c,d)}function M(a,b){return function(c,d,e){return a(c,b,d,e)}}function N(a,b,c){function d(a){a?c(a):++f===g&&c(null)}c=s(c||r);var e=0,f=0,g=a.length;for(0===g&&c(null);g>e;e++)b(a[e],e,J(d))}function O(a){return function(b,c,d){return a(Dc,b,c,d)}}function P(a,b,c,d){d=d||r,b=b||[];var e=[],f=0;a(b,function(a,b,d){var g=f++;c(a,function(a,b){e[g]=b,d(a)})},function(a){d(a,e)})}function Q(a){return function(b,c,d,e){return a(K(c),b,d,e)}}function R(a){return hb(function(b,c){var d;try{d=a.apply(this,b)}catch(e){return c(e)}n(d)&&"function"==typeof d.then?d.then(function(a){c(null,a)},function(a){c(a.message?a:new Error(a))}):c(null,d)})}function S(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function T(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}function U(a,b){return a&&Kc(a,b,E)}function V(a,b,c,d){for(var e=a.length,f=c+(d?1:-1);d?f--:++f<e;)if(b(a[f],f,a))return f;return-1}function W(a){return a!==a}function X(a,b,c){for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function Y(a,b,c){return b===b?X(a,b,c):V(a,W,c)}function Z(a,b){for(var c=-1,d=null==a?0:a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function $(a){return"symbol"==typeof a||u(a)&&m(a)==Mc}function _(a){if("string"==typeof a)return a;if(Hb(a))return Z(a,_)+"";if($(a))return Pc?Pc.call(a):"";var b=a+"";return"0"==b&&1/a==-Nc?"-0":b}function aa(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b),c=c>e?e:c,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function ba(a,b,c){var d=a.length;return c=void 0===c?d:c,!b&&c>=d?a:aa(a,b,c)}function ca(a,b){for(var c=a.length;c--&&Y(b,a[c],0)>-1;);return c}function da(a,b){for(var c=-1,d=a.length;++c<d&&Y(b,a[c],0)>-1;);return c}function ea(a){return a.split("")}function fa(a){return Vc.test(a)}function ga(a){return a.match(ld)||[]}function ha(a){return fa(a)?ga(a):ea(a)}function ia(a){return null==a?"":_(a)}function ja(a,b,c){if(a=ia(a),a&&(c||void 0===b))return a.replace(md,"");if(!a||!(b=_(b)))return a;var d=ha(a),e=ha(b),f=da(d,e),g=ca(d,e)+1;return ba(d,f,g).join("")}function ka(a){return a=a.toString().replace(qd,""),a=a.match(nd)[2].replace(" ",""),a=a?a.split(od):[],a=a.map(function(a){return ja(a.replace(pd,""))})}function la(a,b){var c={};U(a,function(a,b){function d(b,c){var d=Z(e,function(a){return b[a]});d.push(c),a.apply(null,d)}var e;if(Hb(a))e=a.slice(0,-1),a=a[a.length-1],c[b]=e.concat(e.length>0?d:a);else if(1===a.length)c[b]=a;else{if(e=ka(a),0===a.length&&0===e.length)throw new Error("autoInject task functions require explicit parameters.");e.pop(),c[b]=e.concat(d)}}),Lc(c,b)}function ma(a){setTimeout(a,0)}function na(a){return i(function(b,c){a(function(){b.apply(null,c)})})}function oa(){this.head=this.tail=null,this.length=0}function pa(a,b){a.length=1,a.head=a.tail=b}function qa(a,b,c){function d(a,b,c){if(null!=c&&"function"!=typeof c)throw new Error("task callback must be a function");if(h.started=!0,Hb(a)||(a=[a]),0===a.length&&h.idle())return td(function(){h.drain()});for(var d=0,e=a.length;e>d;d++){var f={data:a[d],callback:c||r};b?h._tasks.unshift(f):h._tasks.push(f)}td(h.process)}function e(a){return i(function(b){f-=1;for(var c=0,d=a.length;d>c;c++){var e=a[c],i=Y(g,e,0);i>=0&&g.splice(i),e.callback.apply(e,b),null!=b[0]&&h.error(b[0],e.data)}f<=h.concurrency-h.buffer&&h.unsaturated(),h.idle()&&h.drain(),h.process()})}if(null==b)b=1;else if(0===b)throw new Error("Concurrency must not be zero");var f=0,g=[],h={_tasks:new oa,concurrency:b,payload:c,saturated:r,unsaturated:r,buffer:b/4,empty:r,drain:r,error:r,started:!1,paused:!1,push:function(a,b){d(a,!1,b)},kill:function(){h.drain=r,h._tasks.empty()},unshift:function(a,b){d(a,!0,b)},process:function(){for(;!h.paused&&f<h.concurrency&&h._tasks.length;){var b=[],c=[],d=h._tasks.length;h.payload&&(d=Math.min(d,h.payload));for(var i=0;d>i;i++){var j=h._tasks.shift();b.push(j),c.push(j.data)}0===h._tasks.length&&h.empty(),f+=1,g.push(b[0]),f===h.concurrency&&h.saturated();var k=J(e(b));a(c,k)}},length:function(){return h._tasks.length},running:function(){return f},workersList:function(){return g},idle:function(){return h._tasks.length+f===0},pause:function(){h.paused=!0},resume:function(){if(h.paused!==!1){h.paused=!1;for(var a=Math.min(h.concurrency,h._tasks.length),b=1;a>=b;b++)td(h.process)}}};return h}function ra(a,b){return qa(a,1,b)}function sa(a,b,c,d){d=s(d||r),vd(a,function(a,d,e){c(b,a,function(a,c){b=c,e(a)})},function(a){d(a,b)})}function ta(a,b,c,d){var e=[];a(b,function(a,b,d){c(a,function(a,b){e=e.concat(b||[]),d(a)})},function(a){d(a,e)})}function ua(a){return function(b,c,d){return a(vd,b,c,d)}}function va(a,b,c){return function(d,e,f,g){function h(){g&&g(null,c(!1))}function i(a,d,e){return g?void f(a,function(d,h){g&&(d||b(h))?(d?g(d):g(d,c(!0,a)),g=f=!1,e(d,Bc)):e()}):e()}arguments.length>3?(g=g||r,a(d,e,i,h)):(g=f,g=g||r,f=e,a(d,i,h))}}function wa(a,b){return b}function xa(a){return i(function(b,c){b.apply(null,c.concat([i(function(b,c){"object"==typeof console&&(b?console.error&&console.error(b):console[a]&&S(c,function(b){console[a](b)}))})]))})}function ya(a,b,c){function d(b,d){return b?c(b):d?void a(e):c(null)}c=J(c||r);var e=i(function(a,e){return a?c(a):(e.push(d),void b.apply(this,e))});d(null,!0)}function za(a,b,c){c=J(c||r);var d=i(function(e,f){return e?c(e):b.apply(this,f)?a(d):void c.apply(null,[null].concat(f))});a(d)}function Aa(a,b,c){za(a,function(){return!b.apply(this,arguments)},c)}function Ba(a,b,c){function d(b){return b?c(b):void a(e)}function e(a,e){return a?c(a):e?void b(d):c(null)}c=J(c||r),a(e)}function Ca(a){return function(b,c,d){return a(b,d)}}function Da(a,b,c){Dc(a,Ca(b),c)}function Ea(a,b,c,d){K(b)(a,Ca(c),d)}function Fa(a){return hb(function(b,c){var d=!0;b.push(function(){var a=arguments;d?td(function(){c.apply(null,a)}):c.apply(null,a)}),a.apply(this,b),d=!1})}function Ga(a){return!a}function Ha(a){return function(b){return null==b?void 0:b[a]}}function Ia(a,b,c,d){var e=new Array(b.length);a(b,function(a,b,d){c(a,function(a,c){e[b]=!!c,d(a)})},function(a){if(a)return d(a);for(var c=[],f=0;f<b.length;f++)e[f]&&c.push(b[f]);d(null,c)})}function Ja(a,b,c,d){var e=[];a(b,function(a,b,d){c(a,function(c,f){c?d(c):(f&&e.push({index:b,value:a}),d())})},function(a){a?d(a):d(null,Z(e.sort(function(a,b){return a.index-b.index}),Ha("value")))})}function Ka(a,b,c,d){var e=q(b)?Ia:Ja;e(a,b,c,d||r)}function La(a,b){function c(a){return a?d(a):void e(c)}var d=J(b||r),e=Fa(a);c()}function Ma(a,b,c,d){d=s(d||r);var e={};L(a,b,function(a,b,d){c(a,b,function(a,c){return a?d(a):(e[b]=c,void d())})},function(a){d(a,e)})}function Na(a,b){return b in a}function Oa(a,b){var c=Object.create(null),d=Object.create(null);b=b||h;var e=hb(function(e,f){var g=b.apply(null,e);Na(c,g)?td(function(){f.apply(null,c[g])}):Na(d,g)?d[g].push(f):(d[g]=[f],a.apply(null,e.concat([i(function(a){c[g]=a;var b=d[g];delete d[g];for(var e=0,f=b.length;f>e;e++)b[e].apply(null,a)})])))});return e.memo=c,e.unmemoized=a,e}function Pa(a,b,c){c=c||r;var d=q(b)?[]:{};a(b,function(a,b,c){a(i(function(a,e){e.length<=1&&(e=e[0]),d[b]=e,c(a)}))},function(a){c(a,d)})}function Qa(a,b){Pa(Dc,a,b)}function Ra(a,b,c){Pa(K(b),a,c)}function Sa(a,b){if(b=s(b||r),!Hb(a))return b(new TypeError("First argument to race must be an array of functions"));if(!a.length)return b();for(var c=0,d=a.length;d>c;c++)a[c](b)}function Ta(a,b,c,d){var e=Sd.call(a).reverse();sa(e,b,c,d)}function Ua(a){return hb(function(b,c){return b.push(i(function(a,b){if(a)c(null,{error:a});else{var d=null;1===b.length?d=b[0]:b.length>1&&(d=b),c(null,{value:d})}})),a.apply(this,b)})}function Va(a,b,c,d){Ka(a,b,function(a,b){c(a,function(a,c){b(a,!c)})},d)}function Wa(a){var b;return Hb(a)?b=Z(a,Ua):(b={},U(a,function(a,c){b[c]=Ua.call(this,a)})),b}function Xa(a){return function(){return a}}function Ya(a,b,c){function d(a,b){if("object"==typeof b)a.times=+b.times||f,a.intervalFunc="function"==typeof b.interval?b.interval:Xa(+b.interval||g),a.errorFilter=b.errorFilter;else{if("number"!=typeof b&&"string"!=typeof b)throw new Error("Invalid arguments for async.retry");a.times=+b||f}}function e(){b(function(a){a&&i++<h.times&&("function"!=typeof h.errorFilter||h.errorFilter(a))?setTimeout(e,h.intervalFunc(i)):c.apply(null,arguments)})}var f=5,g=0,h={times:f,intervalFunc:Xa(g)};if(arguments.length<3&&"function"==typeof a?(c=b||r,b=a):(d(h,a),c=c||r),"function"!=typeof b)throw new Error("Invalid arguments for async.retry");var i=1;e()}function Za(a,b){Pa(vd,a,b)}function $a(a,b,c){function d(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0}Ec(a,function(a,c){b(a,function(b,d){return b?c(b):void c(null,{value:a,criteria:d})})},function(a,b){return a?c(a):void c(null,Z(b.sort(d),Ha("value")))})}function _a(a,b,c){function d(){h||(f.apply(null,arguments),clearTimeout(g))}function e(){var b=a.name||"anonymous",d=new Error('Callback function "'+b+'" timed out.');d.code="ETIMEDOUT",c&&(d.info=c),h=!0,f(d)}var f,g,h=!1;return hb(function(c,h){f=h,g=setTimeout(e,b),a.apply(null,c.concat(d))})}function ab(a,b,c,d){for(var e=-1,f=_d($d((b-a)/(c||1)),0),g=Array(f);f--;)g[d?f:++e]=a,a+=c;return g}function bb(a,b,c,d){Gc(ab(0,a,1),b,c,d)}function cb(a,b,c,d){3===arguments.length&&(d=c,c=b,b=Hb(a)?[]:{}),d=s(d||r),Dc(a,function(a,d,e){c(b,a,d,e)},function(a){d(a,b)})}function db(a){return function(){return(a.unmemoized||a).apply(null,arguments)}}function eb(a,b,c){if(c=J(c||r),!a())return c(null);var d=i(function(e,f){return e?c(e):a()?b(d):void c.apply(null,[null].concat(f))});b(d)}function fb(a,b,c){eb(function(){return!a.apply(this,arguments)},b,c)}var gb=Math.max,hb=function(a){return i(function(b){var c=b.pop();a.call(this,b,c)})},ib="object"==typeof a&&a&&a.Object===Object&&a,jb="object"==typeof self&&self&&self.Object===Object&&self,kb=ib||jb||Function("return this")(),lb=kb.Symbol,mb=Object.prototype,nb=mb.hasOwnProperty,ob=mb.toString,pb=lb?lb.toStringTag:void 0,qb=Object.prototype,rb=qb.toString,sb="[object Null]",tb="[object Undefined]",ub=lb?lb.toStringTag:void 0,vb="[object AsyncFunction]",wb="[object Function]",xb="[object GeneratorFunction]",yb="[object Proxy]",zb=9007199254740991,Ab="function"==typeof Symbol&&Symbol.iterator,Bb=function(a){return Ab&&a[Ab]&&a[Ab]()},Cb="[object Arguments]",Db=Object.prototype,Eb=Db.hasOwnProperty,Fb=Db.propertyIsEnumerable,Gb=v(function(){return arguments}())?v:function(a){return u(a)&&Eb.call(a,"callee")&&!Fb.call(a,"callee")},Hb=Array.isArray,Ib="object"==typeof b&&b&&!b.nodeType&&b,Jb=Ib&&"object"==typeof c&&c&&!c.nodeType&&c,Kb=Jb&&Jb.exports===Ib,Lb=Kb?kb.Buffer:void 0,Mb=Lb?Lb.isBuffer:void 0,Nb=Mb||w,Ob=9007199254740991,Pb=/^(?:0|[1-9]\d*)$/,Qb="[object Arguments]",Rb="[object Array]",Sb="[object Boolean]",Tb="[object Date]",Ub="[object Error]",Vb="[object Function]",Wb="[object Map]",Xb="[object Number]",Yb="[object Object]",Zb="[object RegExp]",$b="[object Set]",_b="[object String]",ac="[object WeakMap]",bc="[object ArrayBuffer]",cc="[object DataView]",dc="[object Float32Array]",ec="[object Float64Array]",fc="[object Int8Array]",gc="[object Int16Array]",hc="[object Int32Array]",ic="[object Uint8Array]",jc="[object Uint8ClampedArray]",kc="[object Uint16Array]",lc="[object Uint32Array]",mc={};mc[dc]=mc[ec]=mc[fc]=mc[gc]=mc[hc]=mc[ic]=mc[jc]=mc[kc]=mc[lc]=!0,mc[Qb]=mc[Rb]=mc[bc]=mc[Sb]=mc[cc]=mc[Tb]=mc[Ub]=mc[Vb]=mc[Wb]=mc[Xb]=mc[Yb]=mc[Zb]=mc[$b]=mc[_b]=mc[ac]=!1;var nc,oc="object"==typeof b&&b&&!b.nodeType&&b,pc=oc&&"object"==typeof c&&c&&!c.nodeType&&c,qc=pc&&pc.exports===oc,rc=qc&&ib.process,sc=function(){try{return rc&&rc.binding("util")}catch(a){}}(),tc=sc&&sc.isTypedArray,uc=tc?z(tc):y,vc=Object.prototype,wc=vc.hasOwnProperty,xc=Object.prototype,yc=C(Object.keys,Object),zc=Object.prototype,Ac=zc.hasOwnProperty,Bc={},Cc=M(L,1/0),Dc=function(a,b,c){var d=q(a)?N:Cc;d(a,b,c)},Ec=O(P),Fc=j(Ec),Gc=Q(P),Hc=M(Gc,1),Ic=j(Hc),Jc=i(function(a,b){return i(function(c){return a.apply(null,b.concat(c))})}),Kc=T(),Lc=function(a,b,c){function d(a,b){t.push(function(){h(a,b)})}function e(){if(0===t.length&&0===o)return c(null,n);for(;t.length&&b>o;){var a=t.shift();a()}}function f(a,b){var c=q[a];c||(c=q[a]=[]),c.push(b)}function g(a){var b=q[a]||[];S(b,function(a){a()}),e()}function h(a,b){if(!p){var d=J(i(function(b,d){if(o--,d.length<=1&&(d=d[0]),b){var e={};U(n,function(a,b){e[b]=a}),e[a]=d,p=!0,q=[],c(b,e)}else n[a]=d,g(a)}));o++;var e=b[b.length-1];b.length>1?e(n,d):e(d)}}function j(){for(var a,b=0;u.length;)a=u.pop(),b++,S(k(a),function(a){0===--v[a]&&u.push(a)});if(b!==m)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function k(b){var c=[];return U(a,function(a,d){Hb(a)&&Y(a,b,0)>=0&&c.push(d)}),c}"function"==typeof b&&(c=b,b=null),c=s(c||r);var l=E(a),m=l.length;if(!m)return c(null);b||(b=m);var n={},o=0,p=!1,q={},t=[],u=[],v={};U(a,function(b,c){if(!Hb(b))return d(c,[b]),void u.push(c);var e=b.slice(0,b.length-1),g=e.length;return 0===g?(d(c,b),void u.push(c)):(v[c]=g,void S(e,function(h){if(!a[h])throw new Error("async.auto task `"+c+"` has a non-existent dependency in "+e.join(", "));f(h,function(){g--,0===g&&d(c,b)})}))}),j(),e()},Mc="[object Symbol]",Nc=1/0,Oc=lb?lb.prototype:void 0,Pc=Oc?Oc.toString:void 0,Qc="\\ud800-\\udfff",Rc="\\u0300-\\u036f\\ufe20-\\ufe23",Sc="\\u20d0-\\u20f0",Tc="\\ufe0e\\ufe0f",Uc="\\u200d",Vc=RegExp("["+Uc+Qc+Rc+Sc+Tc+"]"),Wc="\\ud800-\\udfff",Xc="\\u0300-\\u036f\\ufe20-\\ufe23",Yc="\\u20d0-\\u20f0",Zc="\\ufe0e\\ufe0f",$c="["+Wc+"]",_c="["+Xc+Yc+"]",ad="\\ud83c[\\udffb-\\udfff]",bd="(?:"+_c+"|"+ad+")",cd="[^"+Wc+"]",dd="(?:\\ud83c[\\udde6-\\uddff]){2}",ed="[\\ud800-\\udbff][\\udc00-\\udfff]",fd="\\u200d",gd=bd+"?",hd="["+Zc+"]?",id="(?:"+fd+"(?:"+[cd,dd,ed].join("|")+")"+hd+gd+")*",jd=hd+gd+id,kd="(?:"+[cd+_c+"?",_c,dd,ed,$c].join("|")+")",ld=RegExp(ad+"(?="+ad+")|"+kd+jd,"g"),md=/^\s+|\s+$/g,nd=/^(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,od=/,/,pd=/(=.+)?(\s*)$/,qd=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,rd="function"==typeof d&&d,sd="object"==typeof e&&"function"==typeof e.nextTick;nc=rd?d:sd?e.nextTick:ma;var td=na(nc);oa.prototype.removeLink=function(a){return a.prev?a.prev.next=a.next:this.head=a.next,a.next?a.next.prev=a.prev:this.tail=a.prev,a.prev=a.next=null,this.length-=1,a},oa.prototype.empty=oa,oa.prototype.insertAfter=function(a,b){b.prev=a,b.next=a.next,a.next?a.next.prev=b:this.tail=b,a.next=b,this.length+=1},oa.prototype.insertBefore=function(a,b){b.prev=a.prev,b.next=a,a.prev?a.prev.next=b:this.head=b,a.prev=b,this.length+=1},oa.prototype.unshift=function(a){this.head?this.insertBefore(this.head,a):pa(this,a)},oa.prototype.push=function(a){this.tail?this.insertAfter(this.tail,a):pa(this,a)},oa.prototype.shift=function(){return this.head&&this.removeLink(this.head)},oa.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};var ud,vd=M(L,1),wd=i(function(a){return i(function(b){var c=this,d=b[b.length-1];"function"==typeof d?b.pop():d=r,sa(a,b,function(a,b,d){b.apply(c,a.concat([i(function(a,b){d(a,b)})]))},function(a,b){d.apply(c,[a].concat(b))})})}),xd=i(function(a){return wd.apply(null,a.reverse())}),yd=O(ta),zd=ua(ta),Ad=i(function(a){var b=[null].concat(a);return hb(function(a,c){return c.apply(this,b)})}),Bd=va(Dc,h,wa),Cd=va(L,h,wa),Dd=va(vd,h,wa),Ed=xa("dir"),Fd=M(Ea,1),Gd=va(Dc,Ga,Ga),Hd=va(L,Ga,Ga),Id=M(Hd,1),Jd=O(Ka),Kd=Q(Ka),Ld=M(Kd,1),Md=xa("log"),Nd=M(Ma,1/0),Od=M(Ma,1);ud=sd?e.nextTick:rd?d:ma;var Pd=na(ud),Qd=function(a,b){return qa(function(b,c){a(b[0],c)},b,1)},Rd=function(a,b){var c=Qd(a,b);return c.push=function(a,b,d){if(null==d&&(d=r),"function"!=typeof d)throw new Error("task callback must be a function");if(c.started=!0,Hb(a)||(a=[a]),0===a.length)return td(function(){c.drain()});b=b||0;for(var e=c._tasks.head;e&&b>=e.priority;)e=e.next;for(var f=0,g=a.length;g>f;f++){var h={data:a[f],priority:b,callback:d};e?c._tasks.insertBefore(e,h):c._tasks.push(h)}td(c.process)},delete c.unshift,c},Sd=Array.prototype.slice,Td=O(Va),Ud=Q(Va),Vd=M(Ud,1),Wd=function(a,b){return b||(b=a,a=null),hb(function(c,d){function e(a){b.apply(null,c.concat([a]))}a?Ya(a,e,d):Ya(e,d)})},Xd=va(Dc,Boolean,h),Yd=va(L,Boolean,h),Zd=M(Yd,1),$d=Math.ceil,_d=Math.max,ae=M(bb,1/0),be=M(bb,1),ce=function(a,b){function c(e){if(d===a.length)return b.apply(null,[null].concat(e));var f=J(i(function(a,d){return a?b.apply(null,[a].concat(d)):void c(d)}));e.push(f);var g=a[d++];g.apply(null,e)}if(b=s(b||r),!Hb(a))return b(new Error("First argument to waterfall must be an array of functions"));if(!a.length)return b();var d=0;c([])},de={applyEach:Fc,applyEachSeries:Ic,apply:Jc,asyncify:R,auto:Lc,autoInject:la,cargo:ra,compose:xd,concat:yd,concatSeries:zd,constant:Ad,detect:Bd,detectLimit:Cd,detectSeries:Dd,dir:Ed,doDuring:ya,doUntil:Aa,doWhilst:za,during:Ba,each:Da,eachLimit:Ea,eachOf:Dc,eachOfLimit:L,eachOfSeries:vd,eachSeries:Fd,ensureAsync:Fa,every:Gd,everyLimit:Hd,everySeries:Id,filter:Jd,filterLimit:Kd,filterSeries:Ld,forever:La,log:Md,map:Ec,mapLimit:Gc,mapSeries:Hc,mapValues:Nd,mapValuesLimit:Ma,mapValuesSeries:Od,memoize:Oa,nextTick:Pd,parallel:Qa,parallelLimit:Ra,priorityQueue:Rd,queue:Qd,race:Sa,reduce:sa,reduceRight:Ta,reflect:Ua,reflectAll:Wa,reject:Td,rejectLimit:Ud,rejectSeries:Vd,retry:Ya,retryable:Wd,seq:wd,series:Za,setImmediate:td,some:Xd,someLimit:Yd,someSeries:Zd,sortBy:$a,timeout:_a,times:ae,timesLimit:bb,timesSeries:be,transform:cb,unmemoize:db,until:fb,waterfall:ce,whilst:eb,all:Gd,any:Xd,forEach:Da,forEachSeries:Fd,forEachLimit:Ea,forEachOf:Dc,forEachOfSeries:vd,forEachOfLimit:L,inject:sa,foldl:sa,foldr:Ta,select:Jd,selectLimit:Kd,selectSeries:Ld,wrapSync:R};b["default"]=de,b.applyEach=Fc,b.applyEachSeries=Ic,b.apply=Jc,b.asyncify=R,b.auto=Lc,b.autoInject=la,b.cargo=ra,b.compose=xd,b.concat=yd,b.concatSeries=zd,b.constant=Ad,b.detect=Bd,b.detectLimit=Cd,b.detectSeries=Dd,b.dir=Ed,b.doDuring=ya,b.doUntil=Aa,b.doWhilst=za,b.during=Ba,b.each=Da,b.eachLimit=Ea,b.eachOf=Dc,b.eachOfLimit=L,b.eachOfSeries=vd,b.eachSeries=Fd,b.ensureAsync=Fa,b.every=Gd,b.everyLimit=Hd,b.everySeries=Id,b.filter=Jd,b.filterLimit=Kd,b.filterSeries=Ld,b.forever=La,b.log=Md,b.map=Ec,b.mapLimit=Gc,b.mapSeries=Hc,b.mapValues=Nd,b.mapValuesLimit=Ma,b.mapValuesSeries=Od,b.memoize=Oa,b.nextTick=Pd,b.parallel=Qa,b.parallelLimit=Ra,b.priorityQueue=Rd,b.queue=Qd,b.race=Sa,b.reduce=sa,b.reduceRight=Ta,b.reflect=Ua,b.reflectAll=Wa,b.reject=Td,b.rejectLimit=Ud,b.rejectSeries=Vd,b.retry=Ya,b.retryable=Wd,b.seq=wd,b.series=Za,b.setImmediate=td,b.some=Xd,b.someLimit=Yd,b.someSeries=Zd,b.sortBy=$a,b.timeout=_a,b.times=ae,b.timesLimit=bb,b.timesSeries=be,b.transform=cb,b.unmemoize=db,b.until=fb,b.waterfall=ce,b.whilst=eb,b.all=Gd,b.allLimit=Hd,b.allSeries=Id,b.any=Xd,b.anyLimit=Yd,b.anySeries=Zd,b.find=Bd,b.findLimit=Cd,b.findSeries=Dd,b.forEach=Da,b.forEachSeries=Fd,b.forEachLimit=Ea,b.forEachOf=Dc,b.forEachOfSeries=vd,b.forEachOfLimit=L,b.inject=sa,b.foldl=sa,b.foldr=Ta,b.select=Jd,b.selectLimit=Kd,b.selectSeries=Ld,b.wrapSync=R,Object.defineProperty(b,"__esModule",{value:!0})})}).call(b,function(){return this}(),c(193)(a),c(99).setImmediate,c(7))},function(a,b){"use strict";var c=function(){function a(a,b){this.sdk=a,this.collectionName=b}return a.prototype.buildDataQuery=function(a,b,c){return this.sdk.buildDataQuery(a,b,c)},a.prototype.processDataQuery=function(a,b,c){return this.sdk.processDataQuery(a,this,b,c)},a}();b.ProcessableObject=c},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(40),f=function(a){function b(b){a.call(this),this.config=b,this.data=b.data,this.query=b.query,this.originalParameters=b.originalParameters,this.operation=b.operation,this.additionalOptions=b.additionalOptions}return d(b,a),b}(e.EventEmitter);b.DataQuery=f},function(a,b,c){"use strict";var d=c(1),e=c(103),f=c(43),g=function(){function a(){}return a.prototype._getInitialDataQuery=function(a,b){return new e.DataQuery({meta:b,operation:a})},a.prototype.buildDataQuery=function(a,b,c){var e=this._getInitialDataQuery(b,c);return a instanceof f.Query&&(e.query=a),a&&(e.additionalOptions=a.additionalOptions),d.extend(e,c)},a}();b.DataQueryBuilder=g},function(a,b){"use strict";var c=function(){function a(){}return a.cancelled={code:3e3,message:"Query cancelled."},a}();b.Errors=c},function(){},function(){},function(){"use strict"},108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,function(a,b,c){"use strict";var d=c(1);b.requiredProp=function(a,b,c){if(d.isUndefined(b[c]))throw new Error("`"+c+"` property is not set in `"+a+"` clause")},b.atLeastOneOfProps=function(a,b,c){var e=d(b).chain().keys().intersection(c).value();if(!e.length)throw new Error("Neither `"+c.join("`, `")+"` properties are not set in `"+a+"` clause")},b.onlyOneOfProps=function(a,b,c){var e=d(b).chain().keys().intersection(c).value();if(e.length>1)throw new Error("Wrong using `"+e.join("`, `")+"` properties together in `"+a+"` clause")},b.propType=function(a,b,c,e){if(!d.isUndefined(b[c])){var f=b[c];d.isArray(e)||(e=[e]);var g=d(e).some(function(a){return d["is"+a.charAt(0).toUpperCase()+a.slice(1)](f)});if(!g)throw new Error("`"+c+"` property should have "+(e.length>1?"one of expected types:":"type")+' "'+e.join('", "')+'" in `'+a+"` clause")}},b.minPropLength=function(a,b,c,e){if(!d.isUndefined(b[c])&&b[c].length<e)throw new Error("`"+c+"` property should not have length less than "+e+" in `"+a+"` clause")},b.propMatch=function(a,b,c,e){if(!d.isUndefined(b[c])&&!b[c].match(e))throw new Error("Invalid `"+c+'` property value "'+b[c]+'" in `'+a+"` clause")},b.customProp=function(a,b,c,e){if(!d.isUndefined(b[c])&&!e(b[c]))throw new Error("Invalid `"+c+'` property value "'+b[c]+'" in `'+a+"` clause")}},function(a,b){/**
	 * This script gives you the zone info key representing your device's time zone setting.
	 *
	 * @name jsTimezoneDetect
	 * @version 1.0.5
	 * @author Jon Nylander
	 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
	 *
	 * For usage and examples, visit:
	 * http://pellepim.bitbucket.org/jstz/
	 *
	 * Copyright (c) Jon Nylander
	 */
!function(a){var c=function(){"use strict";var a="s",b=function(a){var b=-a.getTimezoneOffset();return null!==b?b:0},d=function(a,b,c){var d=new Date;return void 0!==a&&d.setFullYear(a),d.setMonth(b),d.setDate(c),d},e=function(a){return b(d(a,0,2))},f=function(a){return b(d(a,5,2))},g=function(a){var c=a.getMonth()>7,d=c?f(a.getFullYear()):e(a.getFullYear()),g=b(a),h=0>d,i=d-g;return h||c?0!==i:0>i},h=function(){var b=e(),c=f(),d=b-c;return 0>d?b+",1":d>0?c+",1,"+a:b+",0"},i=function(){var a=h();return new c.TimeZone(c.olson.timezones[a])},j=function(a){var b=new Date(2010,6,15,1,0,0,0),c={"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Europe/Helsinki":new Date(2013,2,31,5,0,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":b,"Asia/Amman":new Date(2013,2,29,1,0,0,0),"Asia/Beirut":new Date(2013,2,31,2,0,0,0),"Asia/Damascus":new Date(2013,3,6,2,0,0,0),"Asia/Jerusalem":new Date(2013,2,29,5,0,0,0),"Asia/Yekaterinburg":b,"Asia/Omsk":b,"Asia/Krasnoyarsk":b,"Asia/Irkutsk":b,"Asia/Yakutsk":b,"Asia/Vladivostok":b,"Asia/Baku":new Date(2013,2,31,4,0,0),"Asia/Yerevan":new Date(2013,2,31,3,0,0),"Asia/Kamchatka":b,"Asia/Gaza":new Date(2010,2,27,4,0,0),"Africa/Cairo":new Date(2010,4,1,3,0,0),"Europe/Minsk":b,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Pacific/Fiji":new Date(2010,11,1,0,0,0),"Australia/Perth":new Date(2008,10,1,1,0,0,0)};return c[a]};return{determine:i,date_is_dst:g,dst_start_for:j}}();c.TimeZone=function(a){"use strict";var b={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Asia/Beirut","Europe/Helsinki","Asia/Damascus"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk"],"Asia/Baku":["Asia/Yerevan","Asia/Baku"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]},d=a,e=function(){for(var a=b[d],e=a.length,f=0,g=a[0];e>f;f+=1)if(g=a[f],c.date_is_dst(c.dst_start_for(g)))return void(d=g)},f=function(){return"undefined"!=typeof b[d]};return f()&&e(),{name:function(){return d}}},c.olson={},c.olson.timezones={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},b.jstz=c}(this)},function(a,b,c){!function(d,e){"use strict";function f(a){for(var b=0;b<u.length;b++)if(u[b](a))return!0;return!1}function g(a){if(f(a))return p.isRegExp(a)?{$regex:a}:{$eq:a};if(p.isObject(a)){var b=p.keys(a),c=0===p.intersection(k(P),b).length;if(c)return{$eq:a};if(p.contains(b,"$regex")){var d=a.$regex,e=a.$options||"",g="";p.isString(d)&&(g+=d.ignoreCase||e.indexOf("i")>=0?"i":"",g+=d.multiline||e.indexOf("m")>=0?"m":"",g+=d.global||e.indexOf("g")>=0?"g":"",d=new RegExp(d,g)),a.$regex=d,delete a.$options}}return a}function h(a,b){return p.result(a,b)}function i(a,b){if(!b)return e;for(var c,d=b.split("."),f=a,g=0;g<d.length;g++){if(c=null===d[g].match(/^\d+$/),c&&p.isArray(f)){var j=[];p.each(f,function(a){j.push(i(a,d[g]))}),f=j}else f=h(f,d[g]);if(f===e)break}return f}function j(a,b){return new Array(Math.max(b-String(a).length+1,0)).join("0")+a}function k(a){return p.keys(U[a])}function l(a,b){var c={keys:[],groups:[]};if(p.each(a,function(a){var d=b(a),e=-1;if(p.isObject(d)){for(var f=0;f<c.keys.length;f++)if(p.isEqual(d,c.keys[f])){e=f;break}}else e=p.indexOf(c.keys,d);e>-1?c.groups[e].push(a):(c.keys.push(d),c.groups.push([a]))}),c.keys.length!==c.groups.length)throw new Error("assert groupBy(): keys.length !== groups.length");return c}function m(a,b,c){if(p.contains(k(Q),b))return D[b](a,c);if(p.isObject(c)){var d={};for(var f in c)if(c.hasOwnProperty(f)&&(d[f]=m(a,f,c[f]),p.contains(k(Q),f))){if(d=d[f],p.keys(c).length>1)throw new Error("Invalid $group expression '"+JSON.stringify(c)+"'");break}return d}return e}function n(a,b,c){if(p.contains(k(R),c))return O[c](a,b);if(p.isString(b)&&b.length>0&&"$"===b[0])return i(a,b.slice(1));var d;if(f(b))return b;if(p.isArray(b))d=p.map(b,function(b){return n(a,b,null)});else if(p.isObject(b)){d={};for(var e in b)if(b.hasOwnProperty(e)&&(d[e]=n(a,b[e],e),p.contains(k(R),e))){if(d=d[e],p.keys(b).length>1)throw new Error("Invalid aggregation expression '"+JSON.stringify(b)+"'");break}}return d}var o,p,q={};q.VERSION="0.6.2",null!=d&&(o=d.Mingo),q.noConflict=function(){return d.Mingo=o,q};var r=Boolean("undefined"!=typeof android&&android&&android.widget&&android.widget.Button||"undefined"!=typeof UIButton&&UIButton),s="undefined"!=typeof b&&!0&&"undefined"==typeof window&&!r,t="undefined"!=typeof b&&!0;s||r||t?(a.exports=q,p=c(1)):(d.Mingo=q,p=d._);var u=[p.isString,p.isBoolean,p.isNumber,p.isDate,p.isNull,p.isRegExp],v={key:"_id"};if(q.setup=function(a){p.extend(v,a||{})},q.Query=function(a,b){return this instanceof q.Query?(this._criteria=a,this._projection=b,this._compiled=[],void this._compile()):new q.Query(a,b)},q.Query.prototype={_compile:function(){if(!p.isEmpty(this._criteria)){if(p.isArray(this._criteria)||p.isFunction(this._criteria)||!p.isObject(this._criteria))throw new Error("Invalid type for criteria");for(var a in this._criteria)if(this._criteria.hasOwnProperty(a)){var b=this._criteria[a];if(p.contains(["$and","$or","$nor","$where"],a))this._processOperator(a,a,b);else{b=g(b);for(var c in b)b.hasOwnProperty(c)&&this._processOperator(a,c,b[c])}}}},_processOperator:function(a,b,c){if(!p.contains(k(P),b))throw new Error("Invalid query operator '"+b+"' detected");this._compiled.push(z[b](a,c))},test:function(a){for(var b=0;b<this._compiled.length;b++)if(!this._compiled[b].test(a))return!1;return!0},find:function(a,b){return new q.Cursor(a,this,b)},remove:function(a){for(var b=[],c=0;c<a.length;c++)this.test(a[c])||b.push(a[c]);return b}},s){var w=c(28).Transform,x=c(29);q.Query.prototype.stream=function(a){return new q.Stream(this,a)},q.Stream=function(a,b){return this instanceof q.Stream?(b=b||{},p.extend(b,{objectMode:!0}),w.call(this,b),void(this._query=a)):new q.Stream(a,b)},x.inherits(q.Stream,w),q.Stream.prototype._transform=function(a,b,c){if(p.isObject(a)&&this._query.test(a))if(p.isEmpty(this._query._projection))this.push(a);else{var d=new q.Cursor([a],this._query);d.hasNext()&&this.push(d.next())}c()}}q.Cursor=function(a,b,c){return this instanceof q.Cursor?(this._query=b,this._collection=a,this._projection=c||b._projection,this._operators={},this._result=!1,void(this._position=0)):new q.Cursor(a,b,c)},q.Cursor.prototype={_fetch:function(){var a=this;if(this._result!==!1)return this._result;p.isObject(this._projection)&&p.extend(this._operators,{$project:this._projection}),this._result=p.filter(this._collection,this._query.test,this._query);var b=[];if(p.each(["$sort","$skip","$limit","$project"],function(c){p.has(a._operators,c)&&b.push(p.pick(a._operators,c))}),b.length>0){var c=new q.Aggregator(b);this._result=c.run(this._result,this._query)}return this._result},all:function(){return this._fetch()},first:function(){return this.count()>0?this._fetch()[0]:null},last:function(){return this.count()>0?this._fetch()[this.count()-1]:null},count:function(){return this._fetch().length},skip:function(a){return p.extend(this._operators,{$skip:a}),this},limit:function(a){return p.extend(this._operators,{$limit:a}),this},sort:function(a){return p.extend(this._operators,{$sort:a}),this},next:function(){return this.hasNext()?this._fetch()[this._position++]:null},hasNext:function(){return this.count()>this._position},max:function(a){return D.$max(this._fetch(),a)},min:function(a){return D.$min(this._fetch(),a)},map:function(a){return p.map(this._fetch(),a)},forEach:function(a){p.each(this._fetch(),a)}},q.Aggregator=function(a){return this instanceof q.Aggregator?void(this._operators=a):new q.Aggregator(a)},q.Aggregator.prototype={run:function(a,b){if(!p.isEmpty(this._operators))for(var c=0;c<this._operators.length;c++){var d=this._operators[c],e=p.keys(d);if(1!=e.length||!p.contains(k(S),e[0]))throw new Error("Invalid aggregation operator '"+e+"'");e=e[0],a=b instanceof q.Query?y[e].call(b,a,d[e]):y[e](a,d[e])}return a}},q.find=function(a,b,c){return new q.Query(b).find(a,c)},q.remove=function(a,b){return new q.Query(b).remove(a)},q.aggregate=function(a,b){if(!p.isArray(b))throw new Error("Aggregation pipeline must be an array");return new q.Aggregator(b).run(a)},q.addOperators=function(a,b){var c=b({resolve:i,computeValue:n,ops:k,key:function(){return v.key}});if(!p.contains([R,Q,S,T,P],a))throw new Error("Could not identify type '"+a+"'");var d=k(a);p.each(p.keys(c),function(b){if(!/^\$\w+$/.test(b))throw new Error("Invalid operator name '"+b+"'");if(p.contains(d,b))throw new Error("Operator "+b+" is already defined for "+a+" operators")});var e={};switch(a){case P:p.each(p.keys(c),function(a){e[a]=function(b,c){return function(d,e){return{test:function(f){var g=i(f,d),h=b.call(c,d,g,e);if(p.isBoolean(h))return h;if(h instanceof q.Query)return h.test(f);throw new Error("Invalid return type for '"+a+"'. Must return a Boolean or Mingo.Query")}}}}(c[a],c)});break;case T:p.each(p.keys(c),function(a){e[a]=function(a,b){return function(c,d,e){var f=i(c,e);return a.call(b,e,f,d)}}(c[a],c)});break;default:p.each(p.keys(c),function(a){e[a]=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return a.apply(b,c)}}(c[a],c)})}p.extend(U[a],e)},q.CollectionMixin={query:function(a,b){return q.find(this.toJSON(),a,b)},aggregate:function(a){var b=[this.toJSON(),a];return q.aggregate.apply(null,b)}};var y={$group:function(a,b){var c=b[v.key],d=l(a,function(a){return n(a,c,c)}),e=[];return b=p.omit(b,v.key),p.each(d.keys,function(a,c){var f={};p.isUndefined(a)||(f[v.key]=a);for(var g in b)b.hasOwnProperty(g)&&(f[g]=m(d.groups[c],g,b[g]));e.push(f)}),e},$match:function(a,b){return new q.Query(b).find(a).all()},$project:function(a,b){if(p.isEmpty(b))return a;var c=!1;p.each(b,function(a,b){if(0===a&&b!==v.key&&(c=!0),0!==a&&c)throw new Error("You cannot mix including and excluding fields.")});var d=[],e=p.keys(b),f=!1;if(p.contains(e,v.key)){var g=b[v.key];(0===g||g===!1)&&(e=p.without(e,v.key),p.isEmpty(e)&&(f=!0))}else e.push(v.key);for(var h=0;h<a.length;h++){var i=a[h],j={},l=!1,m=!1,o=[];f&&o.push(v.key),p.each(e,function(a){var c,d=b[a];if(a!==v.key&&0===d&&(m=!0),a===v.key&&p.isEmpty(d))c=i[a];else if(p.isString(d))c=n(i,d,a);else if(1===d||d===!0)c=p.result(i,a);else if(p.isObject(d)){var e=p.keys(d);if(e=e.length>1?!1:e[0],e!==!1&&p.contains(k(T),e)){var f=C[e](i,d[e],a);p.isUndefined(f)||(c=f),"$slice"==e&&(l=!0)}else c=n(i,d,a)}else o.push(a);p.isUndefined(c)||(j[a]=c)}),(l||m||f)&&(j=p.defaults(j,p.omit(i,o))),d.push(j)}return d},$limit:function(a,b){return p.first(a,b)},$skip:function(a,b){return p.rest(a,b)},$unwind:function(a,b){for(var c=[],d=b.substr(1),e=0;e<a.length;e++){var f=a[e],g=h(f,d);if(!p.isArray(g))throw new Error("Target field '"+d+"' is not of type Array.");p.each(g,function(a){var b=p.clone(f);b[d]=a,c.push(b)})}return c},$sort:function(a,b){if(!p.isEmpty(b)&&p.isObject(b)){var c=p.keys(b);c.reverse().forEach(function(c){var d=[],e=p.groupBy(a,function(a){var b=i(a,c);return d.push(b),b});d=p.sortBy(p.uniq(d),function(a){return a}),-1===b[c]&&d.reverse(),a=[],p.each(d,function(b){Array.prototype.push.apply(a,e[b])})})}return a}},z={},A={$and:function(a,b){if(!p.isArray(b))throw new Error("Invalid expression for $and criteria");var c=[];return p.each(b,function(a){c.push(new q.Query(a))}),{test:function(a){for(var b=0;b<c.length;b++)if(!c[b].test(a))return!1;return!0}}},$or:function(a,b){if(!p.isArray(b))throw new Error("Invalid expression for $or criteria");var c=[];return p.each(b,function(a){c.push(new q.Query(a))}),{test:function(a){for(var b=0;b<c.length;b++)if(c[b].test(a))return!0;return!1}}},$nor:function(a,b){if(!p.isArray(b))throw new Error("Invalid expression for $nor criteria");var c=this.$or("$or",b);return{test:function(a){return!c.test(a)}}},$not:function(a,b){var c={};c[a]=g(b);var d=new q.Query(c);return{test:function(a){return!d.test(a)}}},$where:function(a,b){return p.isFunction(b)||(b=new Function("return "+b+";")),{test:function(a){return b.call(a)===!0}}}};p.extend(z,A);var B={$eq:function(a,b){return a=p.flatten(p.isArray(a)?a:[a]),a=p.find(a,function(a){return p.isEqual(a,b)}),a!==e},$ne:function(a,b){return!this.$eq(a,b)},$in:function(a,b){return a=p.isArray(a)?a:[a],p.intersection(a,b).length>0},$nin:function(a,b){return p.isUndefined(a)||!this.$in(a,b)},$lt:function(a,b){return a=p.isArray(a)?a:[a],a=p.find(a,function(a){return b>a}),a!==e},$lte:function(a,b){return a=p.isArray(a)?a:[a],a=p.find(a,function(a){return b>=a}),a!==e},$gt:function(a,b){return a=p.isArray(a)?a:[a],a=p.find(a,function(a){return a>b}),a!==e},$gte:function(a,b){return a=p.isArray(a)?a:[a],a=p.find(a,function(a){return a>=b}),a!==e},$mod:function(a,b){return a=p.isArray(a)?a:[a],a=p.find(a,function(a){return p.isNumber(a)&&p.isArray(b)&&2===b.length&&a%b[0]===b[1]}),a!==e},$regex:function(a,b){return a=p.isArray(a)?a:[a],a=p.find(a,function(a){return p.isString(a)&&p.isRegExp(b)&&!!a.match(b)}),a!==e},$exists:function(a,b){return b===!1&&p.isUndefined(a)||b===!0&&!p.isUndefined(a)},$all:function(a,b){var c=this,d=!1;if(p.isArray(a)&&p.isArray(b))for(var e=0;e<b.length;e++){if(!p.isObject(b[e])||!p.contains(p.keys(b[e]),"$elemMatch"))return p.intersection(b,a).length===b.length;d=d||c.$elemMatch(a,b[e].$elemMatch)}return d},$size:function(a,b){return p.isArray(a)&&p.isNumber(b)&&a.length===b},$elemMatch:function(a,b){if(p.isArray(a)&&!p.isEmpty(a))for(var c=new q.Query(b),d=0;d<a.length;d++)if(c.test(a[d]))return!0;return!1},$type:function(a,b){switch(b){case 1:return p.isNumeric(a)&&-1!==(a+"").indexOf(".");case 2:case 5:return p.isString(a);case 3:return p.isObject(a);case 4:return p.isArray(a);case 8:return p.isBoolean(a);case 9:return p.isDate(a);case 10:return p.isNull(a);case 11:return p.isRegExp(a);case 16:return p.isNumeric(a)&&2147483647>=a&&-1===(a+"").indexOf(".");case 18:return p.isNumeric(a)&&a>2147483647&&0x8000000000000000>=a&&-1===(a+"").indexOf(".");default:return!1}}};p.each(p.keys(B),function(a){z[a]=function(a,b){return function(c,d){return{test:function(e){var f=i(e,c);return a.call(b,f,d)}}}}(B[a],B)});var C={$:function(){throw new Error("$ not implemented")},$elemMatch:function(a,b,c){var d=i(a,c),f=new q.Query(b);if(p.isUndefined(d)||!p.isArray(d))return e;for(var g=0;g<d.length;g++)if(f.test(d[g]))return[d[g]];return e},$slice:function(a,b,c){var d=i(a,c);if(!p.isArray(d))return d;if(p.isArray(b)){var e=b[0]<0?d.length+b[0]:b,f=e+b[1];b=[e,f]}else{if(!p.isNumber(b))throw new Error("Invalid type for $slice operator");b=0>b?[b]:[0,b]}return Array.prototype.slice.apply(d,b)}},D={$addToSet:function(a,b){var c=p.map(a,function(a){return n(a,b,null)});return p.uniq(c)},$sum:function(a,b){return p.isArray(a)?p.isNumber(b)?a.length*b:p.reduce(a,function(a,c){return a+n(c,b,null)},0):0},$max:function(a,b){var c=p.max(a,function(a){return n(a,b,null)});return n(c,b,null)},$min:function(a,b){var c=p.min(a,function(a){return n(a,b,null)});return n(c,b,null)},$avg:function(a,b){return this.$sum(a,b)/(a.length||1)},$push:function(a,b){return p.map(a,function(a){return n(a,b,null)})},$first:function(a,b){return a.length>0?n(a[0],b):e},$last:function(a,b){return a.length>0?n(a[a.length-1],b):e}},E={$add:function(a,b){var c=n(a,b,null);return p.reduce(c,function(a,b){return a+b},0)},$subtract:function(a,b){var c=n(a,b,null);return c[0]-c[1]},$divide:function(a,b){var c=n(a,b,null);return c[0]/c[1]},$multiply:function(a,b){var c=n(a,b,null);return p.reduce(c,function(a,b){return a*b},1)},$mod:function(a,b){var c=n(a,b,null);return c[0]%c[1]}},F={$concat:function(a,b){var c=n(a,b,null);return p.contains(c,null)||p.contains(c,e)?null:c.join("")},$strcasecmp:function(a,b){var c=n(a,b,null);return c[0]=p.isEmpty(c[0])?"":c[0].toUpperCase(),c[1]=p.isEmpty(c[1])?"":c[1].toUpperCase(),c[0]>c[1]?1:c[0]<c[1]?-1:0},$substr:function(a,b){var c=n(a,b,null);return p.isString(c[0])?c[1]<0?"":c[2]<0?c[0].substr(c[1]):c[0].substr(c[1],c[2]):""},$toLower:function(a,b){var c=n(a,b,null);return p.isEmpty(c)?"":c.toLowerCase()},$toUpper:function(a,b){var c=n(a,b,null);return p.isEmpty(c)?"":c.toUpperCase()}},G={$dayOfYear:function(a,b){var c=n(a,b,null);if(p.isDate(c)){var d=new Date(c.getFullYear(),0,0),f=c-d,g=864e5;return Math.round(f/g)}return e},$dayOfMonth:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getDate():e},$dayOfWeek:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getDay()+1:e},$year:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getFullYear():e},$month:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getMonth()+1:e},$week:function(a,b){var c=n(a,b,null);c=new Date(+c),c.setHours(0,0,0),c.setDate(c.getDate()+4-(c.getDay()||7));var d=new Date(c.getFullYear(),0,1);return Math.floor(((c-d)/864e5+1)/7)},$hour:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getHours():e},$minute:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getMinutes():e},$second:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getSeconds():e},$millisecond:function(a,b){var c=n(a,b,null);return p.isDate(c)?c.getMilliseconds():e},$dateToString:function(a,b){for(var c=b.format,d=n(a,b.date,null),e=c.match(/(%%|%Y|%m|%d|%H|%M|%S|%L|%j|%w|%U)/g),f=0,g=e.length;g>f;f++){var h=V[e[f]],i=h;if(p.isArray(h)){var k=this[h[0]],l=h[1];i=j(k.call(this,a,d),l)}c=c.replace(e[f],i)}return c}},H={$setEquals:function(a,b){var c=n(a,b,null),d=p.uniq(c[0]),e=p.uniq(c[1]);return d.length!==e.length?!1:0==p.difference(d,e).length},$setIntersection:function(a,b){var c=n(a,b,null);return p.intersection(c[0],c[1])},$setDifference:function(a,b){var c=n(a,b,null);return p.difference(c[0],c[1])},$setUnion:function(a,b){var c=n(a,b,null);return p.union(c[0],c[1])},$setIsSubset:function(a,b){var c=n(a,b,null);return p.intersection(c[0],c[1]).length===c[0].length},$anyElementTrue:function(a,b){for(var c=n(a,b,null)[0],d=0;d<c.length;d++)if(c[d])return!0;return!1},$allElementsTrue:function(a,b){for(var c=n(a,b,null)[0],d=0;d<c.length;d++)if(!c[d])return!1;return!0}},I={$cond:function(a,b){var c,d,e;if(p.isArray(b)){if(3!=b.length)throw new Error("Invalid arguments for $cond operator");c=b[0],d=b[1],e=b[2]}else p.isObject(b)&&(c=b["if"],d=b.then,e=b["else"]);var f=n(a,c,null);return f?n(a,d,null):n(a,e,null)},$ifNull:function(a,b){if(!p.isArray(b)||2!=b.length)throw new Error("Invalid arguments for $ifNull operator");var c=n(a,b,null);return null===c[0]||c[0]===e?c[1]:c[0]}},J={$cmp:function(a,b){var c=n(a,b,null);return c[0]>c[1]?1:c[0]<c[1]?-1:0}};p.each(["$eq","$ne","$gt","$gte","$lt","$lte"],function(a){J[a]=function(b,c){var d=n(b,c,null);return B[a](d[0],d[1])}});var K={$size:function(a,b){var c=n(a,b,null);return p.isArray(c)?c.length:e}},L={$literal:function(a,b){return b}},M={$map:function(a,b){var c=n(a,b.input,null);if(!p.isArray(c))throw new Error("Input expression for $map must resolve to an array");var d=b.as,e=b["in"],f="$"+d,g=a[f];return p.map(c,function(b){a[f]=b;var c=n(a,e,null);return p.isUndefined(g)?delete a[f]:a[f]=g,c})},$let:function(a,b){var c=b.vars,d=b["in"],e={},f=p.keys(c);p.each(f,function(b){var d=n(a,c[b],null),f="$"+b;e[f]=a[f],a[f]=d});var g=n(a,d,null);return p.each(f,function(b){var c="$"+b;p.isUndefined(e[c])?delete a[c]:a[c]=e[c]}),g}},N={$and:function(a,b){var c=n(a,b,null);return p.every(c)},$or:function(a,b){var c=n(a,b,null);return p.some(c)},$not:function(a,b){return!n(a,b[0],null)}},O=p.extend({},K,E,N,J,I,G,L,H,F,M),P=q.OP_QUERY="query",Q=q.OP_GROUP="group",R=q.OP_AGGREGATE="aggregate",S=q.OP_PIPELINE="pipeline",T=q.OP_PROJECTION="projection",U={aggregate:O,group:D,pipeline:y,projection:C,query:z},V={"%Y":["$year",4],"%m":["$month",2],"%d":["$dayOfMonth",2],"%H":["$hour",2],"%M":["$minute",2],"%S":["$second",2],"%L":["$millisecond",3],"%j":["$dayOfYear",3],"%w":["$dayOfWeek",1],"%U":["$week",2],"%%":"%"}}(this)},function(a,b,c){var d=c(12).CryptoJS;c(187),c(190),c(188),c(186),c(185);var e=c(189).JsonFormatter;b.CryptoJS=d,b.JsonFormatter=e},function(a,b,c){function d(a){return this instanceof d?void e.call(this,a):new d(a)}
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
a.exports=d;var e=c(97),f=c(26);f.inherits=c(27),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},function(a,b,c){(function(b){function d(a,b){var d=c(13);a=a||{};var e=a.highWaterMark,f=a.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!a.objectMode,b instanceof d&&(this.objectMode=this.objectMode||!!a.readableObjectMode),this.defaultEncoding=a.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,a.encoding&&(C||(C=c(138).StringDecoder),this.decoder=new C(a.encoding),this.encoding=a.encoding)}function e(a){c(13);return this instanceof e?(this._readableState=new d(a,this),this.readable=!0,void A.call(this)):new e(a)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(B.isNullOrUndefined(c))b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),e||(b.reading=!1),b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a)),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=E)a=E;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:isNaN(a)||B.isNull(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||B.isString(b)||B.isNullOrUndefined(b)||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}function l(a){var c=a._readableState;c.needReadable=!1,c.emittedReadable||(D("emitReadable",c.flowing),c.emittedReadable=!0,c.sync?b.nextTick(function(){m(a)}):m(a))}function m(a){D("emit readable"),a.emit("readable"),s(a)}function n(a,c){c.readingMore||(c.readingMore=!0,b.nextTick(function(){o(a,c)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(D("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;D("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&z.listenerCount(a,"data")&&(b.flowing=!0,s(a))}}function q(a,c){c.resumeScheduled||(c.resumeScheduled=!0,b.nextTick(function(){r(a,c)}))}function r(a,b){b.resumeScheduled=!1,a.emit("resume"),s(a),b.flowing&&!b.reading&&a.read(0)}function s(a){var b=a._readableState;if(D("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var c=a._readableState;if(c.length>0)throw new Error("endReadable called on non-empty stream");c.endEmitted||(c.ended=!0,b.nextTick(function(){c.endEmitted||0!==c.length||(c.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
a.exports=e;var x=c(198),y=c(18).Buffer;e.ReadableState=d;var z=c(40).EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=c(28),B=c(26);B.inherits=c(27);var C,D=c(223);D=D&&D.debuglog?D.debuglog("stream"):function(){},B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return B.isString(a)&&!c.objectMode&&(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(a){return C||(C=c(138).StringDecoder),this._readableState.decoder=new C(a),this._readableState.encoding=a,this};var E=8388608;e.prototype.read=function(a){D("read",a);var b=this._readableState,c=a;if((!B.isNumber(a)||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return D("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?u(this):l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&u(this),null;var d=b.needReadable;D("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,D("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,D("reading or ended",d)),d&&(D("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?t(a,b):null,B.isNull(e)&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&u(this),B.isNull(e)||this.emit("data",e),e},e.prototype._read=function(){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,c){function d(a){D("onunpipe"),a===l&&f()}function e(){D("onend"),a.end()}function f(){D("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function g(b){D("ondata");var c=a.write(b);!1===c&&(D("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function h(b){D("onerror",b),k(),a.removeListener("error",h),0===z.listenerCount(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){D("onfinish"),a.removeListener("close",i),k()}function k(){D("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,D("pipe count=%d opts=%j",m.pipesCount,c);var n=(!c||c.end!==!1)&&a!==b.stdout&&a!==b.stderr,o=n?e:f;m.endEmitted?b.nextTick(o):l.once("end",o),a.on("unpipe",d);var q=p(l);return a.on("drain",q),l.on("data",g),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(D("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,c){var d=A.prototype.on.call(this,a,c);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&this.readable){var e=this._readableState;if(!e.readableListening)if(e.readableListening=!0,e.emittedReadable=!1,e.needReadable=!0,e.reading)e.length&&l(this,e);else{var f=this;b.nextTick(function(){D("readable nexttick read 0"),f.read(0)})}}return d},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(D("resume"),a.flowing=!0,a.reading||(D("resume read 0"),this.read(0)),q(this,a)),this},e.prototype.pause=function(){return D("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(D("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(D("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(D("wrapped data"),b.decoder&&(e=b.decoder.write(e)),e&&(b.objectMode||e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)B.isFunction(a[e])&&B.isUndefined(this[e])&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){D("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=t}).call(b,c(7))},function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
var h=c(18).Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=b.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&56319>=d)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&56319>=d){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},function(a){a.exports=__WEBPACK_EXTERNAL_MODULE_139__},function(a,b){"use strict";var c=function(){function a(){}return a}();b.CommonSetup=c},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(102),f=function(a){function b(b,c,d){a.call(this,b,c),this.collectionName=c,this.settings=d}return d(b,a),b}(e.ProcessableObject);Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=f},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(143),f=c(150),g=c(104),h=c(42),i=new Error("Method must be overriden"),j=function(a){function b(b){a.call(this),this.options=b,this.setup=this._getSetup(b),this.dataQueryProcessor=this._getDataQueryProcessor(),this.dataQueryBuilder=this._getDataQueryBuilder(),this.authentication=this._getAuthentication(),this.registerErrorProcessor(new f["default"])}return d(b,a),b.prototype.registerDataQueryPreProcessor=function(a){this.dataQueryProcessor.preProcessors.push(a)},b.prototype.registerDataQueryProcessor=function(a){this.dataQueryProcessor.processors.push(a)},b.prototype.registerDataQueryPostProcessor=function(a){this.dataQueryProcessor.postProcessors.push(a)},b.prototype.registerErrorProcessor=function(a){this.dataQueryProcessor.errorProcessors.push(a)},b.prototype.processDataQuery=function(a,b,c,d){return this.dataQueryProcessor.process(a,b,c,d)},b.prototype.buildDataQuery=function(a,b,c){return void 0===a&&(a={}),this.dataQueryBuilder.buildDataQuery(a,b,c)},b.prototype.data=function(a){return this._getData(a)},b.prototype._getDataQueryProcessor=function(){return new e.DataQueryProcessor(this)},b.prototype._getDataQueryBuilder=function(){return new g.DataQueryBuilder},b.prototype._getSetup=function(){throw i},b.prototype._getData=function(){throw i},b.prototype._getAuthentication=function(){throw i},b}(h.EventEmitterExtended);b.Sdk=j},function(a,b,c){"use strict";var d=c(144),e=c(105),f=c(44),g=function(){function a(a){this.sdk=a,this.preProcessors=[],this.processors=[],this.postProcessors=[],this.errorProcessors=[]}return a.prototype._iterate=function(a,b,c,f){var g=this;return new Promise(function(h,i){var j=new d.QueryProcessorIterator(b,a),k=null,l=function(b,d){clearTimeout(k),k=setTimeout(function(){return j.error(new Error("Iterator timed out. Processor: "+b.constructor.name+". Value - "+JSON.stringify(d)))},6e4);try{return b.processDataQuery(a,j,c,d)}catch(e){return j.error(e)}},m=function(){j.removeListener("next",l),clearTimeout(k)};j.on("next",l).once("end",function(a){return m(),h(a)}).once("error",function(b){m();var d=g._processError(a,c,b),e=d||b;return i(e)}).once("cancel",function(a){return m(),i({reason:a,error:e.Errors.cancelled})}).start(f)})},a.prototype._preProcess=function(a,b){return this._iterate(a,this.preProcessors,b)},a.prototype._process=function(a,b,c){return this._iterate(a,this.processors,b,c)},a.prototype._postProcess=function(a,b,c){return this._iterate(a,this.postProcessors,b,c)},a.prototype._processError=function(a,b,c){var d=c;return this.errorProcessors.forEach(function(c){d=c.processError(a,b,d)}),d},a.prototype.process=function(a,b,c,d){var e=this;return f.Utils.buildPromise(function(c,d){return e._preProcess(a,b).then(function(c){return e._process(a,b,c)}).then(function(c){return e._postProcess(a,b,c)}).then(function(a){c(a)})["catch"](function(a){d(a)})},c,d)},a}();b.DataQueryProcessor=g},function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=c(1),f=c(42),g=function(a){function b(b,c){a.call(this),this.done=!1,this.position=-1,this.processors=b,this.$id=e.random(0,5e3),this.$query=c,this.$operation=c.operation,this._initialValue=null}return d(b,a),b.prototype.restart=function(a){return void 0===a&&(a=this._initialValue),this.start(a)},b.prototype.start=function(a){return this._initialValue=a,this.position=-1,this.done=!1,this.next(a)},b.prototype.next=function(a){if(this.position++,this.position>=this.processors.length)return this.end(a);var b=this.processors[this.position];return this.emit("next",b,a)},b.prototype.end=function(a){return this.done=!0,this.emit("end",a)},b.prototype.cancel=function(a){return this.done=!0,this.emit("cancel",a)},b.prototype.error=function(a){return this.emit("error",a)},b}(f.EventEmitterExtended);b.QueryProcessorIterator=g},function(a,b,c){"use strict";c(146)},function(a,b,c){"use strict";var d=c(1),e=c(148),f=c(147),g=c(149);d.mixin({deepExtend:e.deepExtend}),d.mixin({compactObject:f.compactObject}),d.mixin({isEmptyObject:g.isEmpty})},function(a,b,c){"use strict";function d(a){var b={};return e.each(a,function(a,c){null!==a&&void 0!==a&&(b[c]=a)}),b}var e=c(1);b.compactObject=d},function(a,b,c){/*  Copyright (C) 2012-2014  Kurt Milam - http://xioup.com | Source: https://gist.github.com/1868955
	 *
	 *  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
	 *  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
	 *
	 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
	 **/
"use strict";function d(a){var b=/#{\s*?_\s*?}/,c=Array.prototype.slice;return e.each(c.call(arguments,1),function(c){for(var d in c)if(e.isUndefined(a[d])||e.isFunction(a[d])||e.isNull(c[d])||e.isDate(c[d]))a[d]=c[d];else if(e.isString(c[d])&&b.test(c[d]))e.isString(a[d])&&(a[d]=c[d].replace(b,a[d]));else if(e.isArray(a[d])||e.isArray(c[d])){if(!e.isArray(a[d])||!e.isArray(c[d]))throw new Error("Trying to combine an array with a non-array ("+d+")");a[d]=e.reject(e.deepExtend(e.clone(a[d]),c[d]),function(a){return e.isNull(a)})}else if(e.isObject(a[d])||e.isObject(c[d])){if(!e.isObject(a[d])||!e.isObject(c[d]))throw new Error("Trying to combine an object with a non-object ("+d+")");a[d]=e.deepExtend(e.clone(a[d]),c[d])}else a[d]=c[d]}),a}var e=c(1);b.deepExtend=d},function(a,b){"use strict";function c(a){if(null==a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;for(var b in a)if(d.call(a,b))return!1;return!0}var d=Object.prototype.hasOwnProperty;b.isEmpty=c},function(a,b,c){"use strict";var d=c(44),e=function(){function a(){}return a.prototype.processError=function(a,b,c){var e=b.sdk.setup,f=e&&e.parseOnlyCompleteDateTimeObjects,g=d.Utils.parseUtilities.getReviver(f);return d.Utils.parseUtilities.parseXhrError(g,c)},a}();Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e},function(a,b,c){"use strict";var d=c(154);d.polyfill(),c(145);var e=c(60);Object.defineProperty(b,"__esModule",{value:!0}),b["default"]=e.Everlive,a.exports=e.Everlive,a.exports["default"]=e.Everlive},function(a,b,c){function d(){return b.colors[k++%b.colors.length]}function e(a){function c(){}function e(){var a=e,c=+new Date,f=c-(j||c);a.diff=f,a.prev=j,a.curr=c,j=c,null==a.useColors&&(a.useColors=b.useColors()),null==a.color&&a.useColors&&(a.color=d());for(var g=new Array(arguments.length),h=0;h<g.length;h++)g[h]=arguments[h];g[0]=b.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var i=0;g[0]=g[0].replace(/%([a-z%])/g,function(c,d){if("%%"===c)return c;i++;var e=b.formatters[d];if("function"==typeof e){var f=g[i];c=e.call(a,f),g.splice(i,1),i--}return c}),g=b.formatArgs.apply(a,g);var k=e.log||b.log||console.log.bind(console);k.apply(a,g)}c.enabled=!1,e.enabled=!0;var f=b.enabled(a)?e:c;return f.namespace=a,f}function f(a){b.save(a);for(var c=(a||"").split(/[\s,]+/),d=c.length,e=0;d>e;e++)c[e]&&(a=c[e].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),"-"===a[0]?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+a+"$")))}function g(){b.enable("")}function h(a){var c,d;for(c=0,d=b.skips.length;d>c;c++)if(b.skips[c].test(a))return!1;for(c=0,d=b.names.length;d>c;c++)if(b.names[c].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}b=a.exports=e.debug=e,b.coerce=i,b.disable=g,b.enable=f,b.enabled=h,b.humanize=c(153),b.names=[],b.skips=[],b.formatters={};var j,k=0},function(a){function b(a){if(a=String(a),!(a.length>1e4)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return c*j;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*h;case"minutes":case"minute":case"mins":case"min":case"m":return c*g;case"seconds":case"second":case"secs":case"sec":case"s":return c*f;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return void 0}}}}function c(a){return a>=i?Math.round(a/i)+"d":a>=h?Math.round(a/h)+"h":a>=g?Math.round(a/g)+"m":a>=f?Math.round(a/f)+"s":a+"ms"}function d(a){return e(a,i,"day")||e(a,h,"hour")||e(a,g,"minute")||e(a,f,"second")||a+" ms"}function e(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var f=1e3,g=60*f,h=60*g,i=24*h,j=365.25*i;a.exports=function(a,e){e=e||{};var f=typeof a;if("string"===f&&a.length>0)return b(a);if("number"===f&&isNaN(a)===!1)return e["long"]?d(a):c(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}},function(a,b,c){(function(b,d){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.0.5
	 */
!function(b,c){a.exports=c()}(this,function(){"use strict";function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function e(a){return"function"==typeof a}function f(a){X=a}function g(a){Y=a}function h(){return function(){return b.nextTick(m)}}function i(){return"undefined"!=typeof W?function(){W(m)}:l()}function j(){var a=0,b=new _(m),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function k(){var a=new MessageChannel;return a.port1.onmessage=m,function(){return a.port2.postMessage(0)}}function l(){var a=setTimeout;return function(){return a(m,1)}}function m(){for(var a=0;V>a;a+=2){var b=ca[a],c=ca[a+1];b(c),ca[a]=void 0,ca[a+1]=void 0}V=0}function n(){try{var a=c(222);return W=a.runOnLoop||a.runOnContext,i()}catch(b){return l()}}function o(a,b){var c=arguments,d=this,e=new this.constructor(q);void 0===e[ea]&&J(e);var f=d._state;return f?!function(){var a=c[f-1];Y(function(){return G(f,e,a,d._result)})}():C(d,e,a,b),e}function p(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(q);return y(c,a),c}function q(){}function r(){return new TypeError("You cannot resolve a promise with itself")}function s(){return new TypeError("A promises callback cannot return that same promise.")}function t(a){try{return a.then}catch(b){return ia.error=b,ia}}function u(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function v(a,b,c){Y(function(a){var d=!1,e=u(c,b,function(c){d||(d=!0,b!==c?y(a,c):A(a,c))},function(b){d||(d=!0,B(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,B(a,e))},a)}function w(a,b){b._state===ga?A(a,b._result):b._state===ha?B(a,b._result):C(b,void 0,function(b){return y(a,b)},function(b){return B(a,b)})}function x(a,b,c){b.constructor===a.constructor&&c===o&&b.constructor.resolve===p?w(a,b):c===ia?B(a,ia.error):void 0===c?A(a,b):e(c)?v(a,b,c):A(a,b)}function y(b,c){b===c?B(b,r()):a(c)?x(b,c,t(c)):A(b,c)}function z(a){a._onerror&&a._onerror(a._result),D(a)}function A(a,b){a._state===fa&&(a._result=b,a._state=ga,0!==a._subscribers.length&&Y(D,a))}function B(a,b){a._state===fa&&(a._state=ha,a._result=b,Y(z,a))}function C(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ga]=c,e[f+ha]=d,0===f&&a._state&&Y(D,a)}function D(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d=void 0,e=void 0,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?G(c,d,e,f):e(f);a._subscribers.length=0}}function E(){this.error=null}function F(a,b){try{return a(b)}catch(c){return ja.error=c,ja}}function G(a,b,c,d){var f=e(c),g=void 0,h=void 0,i=void 0,j=void 0;if(f){if(g=F(c,d),g===ja?(j=!0,h=g.error,g=null):i=!0,b===g)return void B(b,s())}else g=d,i=!0;b._state!==fa||(f&&i?y(b,g):j?B(b,h):a===ga?A(b,g):a===ha&&B(b,g))}function H(a,b){try{b(function(b){y(a,b)},function(b){B(a,b)})}catch(c){B(a,c)}}function I(){return ka++}function J(a){a[ea]=ka++,a._state=void 0,a._result=void 0,a._subscribers=[]}function K(a,b){this._instanceConstructor=a,this.promise=new a(q),this.promise[ea]||J(this.promise),U(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&A(this.promise,this._result))):B(this.promise,L())}function L(){return new Error("Array Methods must be provided an Array")}function M(a){return new K(this,a).promise}function N(a){var b=this;return new b(U(a)?function(c,d){for(var e=a.length,f=0;e>f;f++)b.resolve(a[f]).then(c,d)}:function(a,b){return b(new TypeError("You must pass an array to race."))})}function O(a){var b=this,c=new b(q);return B(c,a),c}function P(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Q(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(a){this[ea]=I(),this._result=this._state=void 0,this._subscribers=[],q!==a&&("function"!=typeof a&&P(),this instanceof R?H(this,a):Q())}function S(){var a=void 0;if("undefined"!=typeof d)a=d;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;if(c){var e=null,f=null;try{f=c.resolve(),e=Object.prototype.toString.call(f)}catch(b){}if(!c.cast&&("[object Promise]"===e||"object"==typeof f))return}a.Promise=R}var T=void 0;T=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var U=T,V=0,W=void 0,X=void 0,Y=function(a,b){ca[V]=a,ca[V+1]=b,V+=2,2===V&&(X?X(m):da())},Z="undefined"!=typeof window?window:void 0,$=Z||{},_=$.MutationObserver||$.WebKitMutationObserver,aa="undefined"==typeof self&&"undefined"!=typeof b&&"[object process]"==={}.toString.call(b),ba="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ca=new Array(1e3),da=void 0;da=aa?h():_?j():ba?k():void 0===Z?n():l();var ea=Math.random().toString(36).substring(16),fa=void 0,ga=1,ha=2,ia=new E,ja=new E,ka=0;return K.prototype._enumerate=function(){for(var a=this.length,b=this._input,c=0;this._state===fa&&a>c;c++)this._eachEntry(b[c],c)},K.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;if(d===p){var e=t(a);if(e===o&&a._state!==fa)this._settledAt(a._state,b,a._result);else if("function"!=typeof e)this._remaining--,this._result[b]=a;else if(c===R){var f=new c(q);x(f,a,e),this._willSettleAt(f,b)}else this._willSettleAt(new c(function(b){return b(a)}),b)}else this._willSettleAt(d(a),b)},K.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===fa&&(this._remaining--,a===ha?B(d,c):this._result[b]=c),0===this._remaining&&A(d,this._result)},K.prototype._willSettleAt=function(a,b){var c=this;C(a,void 0,function(a){return c._settledAt(ga,b,a)},function(a){return c._settledAt(ha,b,a)})},R.all=M,R.race=N,R.resolve=p,R.reject=O,R._setScheduler=f,R._setAsap=g,R._asap=Y,R.prototype={constructor:R,then:o,"catch":function(a){return this.then(null,a)}},R.polyfill=S,R.Promise=R,R})}).call(b,c(7),function(){return this}())},function(a,b,c){"use strict";var d=c(1),e={base:c(24),mssql:c(164),postgresql:c(167),sqlite:c(173),mysql:c(165)},f=a.exports=function(a){this.configure(a)};f.prototype._reset=function(){this.options.separatedValues?(this._placeholderId=1,this._values=this.options.namedValues?{}:[]):(delete this._placeholderId,delete this._values),this._query=""},f.prototype._getPlaceholder=function(){return(this.options.namedValues?"p":"")+this._placeholderId++},f.prototype._wrapPlaceholder=function(a){return this.options.valuesPrefix+a},f.prototype._pushValue=function(a){if(d.isUndefined(a)||d.isNull(a))return"null";if(d.isNumber(a)||d.isBoolean(a))return String(a);if(d.isString(a)){if(this.options.separatedValues){var b=this._getPlaceholder();return this.options.namedValues?this._values[b]=a:this._values.push(a),this._wrapPlaceholder(b)}return"'"+a+"'"}throw new Error('Wrong value type "'+typeof a+'"')},f.prototype.configure=function(a){a=a||{},this.options=d.defaults({},a,{separatedValues:!0,namedValues:!0,valuesPrefix:"$",dialect:"base",wrappedIdentifiers:!0}),this.setDialect(this.options.dialect),this._reset()},f.prototype.build=function(a){var b=this;return this._reset(),this._query=this.dialect.buildTemplate("query",{queryBody:a})+";",this.options.separatedValues?{query:this._query,values:this._values,prefixValues:function(){var a={};return d(this.getValuesObject()).each(function(c,d){a[b._wrapPlaceholder(d)]=c}),a},getValuesArray:function(){return d.isArray(this.values)?this.values:d(this.values).values()},getValuesObject:function(){return d.isArray(this.values)?d(d.range(1,this.values.length+1)).object(this.values):this.values}}:{query:this._query}},f.prototype.setDialect=function(a){if(!e[a])throw new Error('Unknown dialect "'+a+'"');this.dialect=new e[a](this)}},function(a,b,c){"use strict";var d=c(1),e=function(a){return a.length&&"("===a[0]&&")"===a[a.length-1]&&(a=a.slice(1,a.length-1)),a},f=function(a,b){var c=d(a).keys();return d(b).some(function(a){return d(c).contains(a)})},g=["select","query","field","value","func","expression"],h=function(a){return d.isObject(a)&&!d.isArray(a)&&f(a,g)},i=function(a){return d.isString(a)||d.isNumber(a)||d.isBoolean(a)||d.isNull(a)||d.isUndefined(a)||d.isRegExp(a)||d.isDate(a)};a.exports=function(a){function b(b){var c="";return d.isArray(b)?c=d(b).map(function(b){return a.buildTemplate("withItem",b)}).join(", "):d.isObject(b)&&(c=d(b).map(function(b,c){return b.name||(b=d.clone(b),b.name=c),a.buildTemplate("withItem",b)}).join(", ")),c}a.blocks.add("distinct",function(){return"distinct"}),a.blocks.add("fields",function(b){var c=b.fields||{};if(!d.isObject(c))throw new Error('Invalid `fields` property type "'+typeof c+'"');return d.isObject(b.count)?"":d.isEmpty(c)?"*":(c=d(c).map(d.isArray(c)?function(b){return i(b)||h(b)||d.has(b,"name")?a.buildBlock("term",{term:b,type:"field"}):a.buildBlock("fields",{fields:b})}:function(b,c){return d.isString(b)&&(b={alias:b}),d.has(b,"name")||(b=d.defaults({name:c},b)),a.buildBlock("term",{term:b,type:"field"})}),d(c).compact().join(", "))}),a.blocks.add("count",function(){return"COUNT(*) as Count"}),a.blocks.add("term",function(b){var c=b.term,e=b.type||"field",f=i(c)||d.isArray(c);f&&!d.isString(c)&&(e="value"),(f||!h(c))&&(c=d(c).chain().pick("cast","alias").extend(d.object([e],[c])).value()),e=d(g).find(function(a){return d.has(c,a)});var j=a.buildBlock(e,d(c).pick(e));return d.has(c,"cast")&&(j="cast("+j+" as "+c.cast+")"),d.has(c,"alias")&&(j+=" "+a.buildBlock("alias",{alias:c.alias})),j}),a.blocks.add("table",function(b){return a.buildBlock("name",{name:b.table})}),a.blocks.add("func",function(b){var c=b.func;if(d.isString(c)&&(c={name:c}),!d.isObject(c))throw new Error('Invalid `func` property type "'+typeof c+'"');if(!d.has(c,"name"))throw new Error("`func.name` property is required");var e="";return d.isArray(c.args)&&(e=d(c.args).map(function(b){return a.buildBlock("term",{term:b,type:"value"})}).join(", ")),c.name+"("+e+")"}),a.blocks.add("expression",function(b){var c=b.expression;if(d.isString(c)&&(c={pattern:c}),!d.isObject(c))throw new Error('Invalid `expression` property type "'+typeof c+'"');if(!d.has(c,"pattern"))throw new Error("`expression.pattern` property is required");var e=c.values||{};return c.pattern.replace(/\{([a-z0-9]+)\}/gi,function(b,c){if(!d.has(e,c))throw new Error("Field `"+c+"` is required in `expression.values` property");return a.buildBlock("term",{term:e[c],type:"value"})}).trim()}),a.blocks.add("field",function(b){var c=b.field;if(d.isString(c)&&(c={name:c}),!d.isObject(c))throw new Error('Invalid `field` property type "'+typeof c+'"');if(!d.has(c,"name"))throw new Error("`field.name` property is required");var e=a.buildBlock("name",{name:c.name});return d.has(c,"table")&&(e=a.buildBlock("table",{table:c.table})+"."+e),e}),a.blocks.add("value",function(b){var c=b.value;return d.isRegExp(c)&&(c=c.source),a.builder._pushValue(c)}),a.blocks.add("name",function(b){return a._wrapIdentifier(b.name)}),a.blocks.add("alias",function(b){var c=b.alias;if(d.isString(c)&&(c={name:c}),!d.isObject(c))throw new Error('Invalid `alias` property type "'+typeof c+'"');if(!d.has(c,"name"))throw new Error("`alias.name` property is required");var e="as "+a._wrapIdentifier(c.name);return d.isArray(c.columns)&&(e+="("+d(c.columns).map(function(b){return a._wrapIdentifier(b)}).join(", ")+")"),e}),a.blocks.add("condition",function(b){var c=a.buildCondition({value:b.condition,defaultFetchingOperator:"$value"});return c&&(c="where "+e(c)),c}),a.blocks.add("modifier",function(b){var c=a.buildModifier({modifier:b.modifier});return c&&(c="set "+c),c}),a.blocks.add("join",function(b){var c=b.join,e="";return d.isArray(c)?e=d(c).map(function(b){return a.buildTemplate("joinItem",b)}).join(" "):d.isObject(c)&&(e=d(c).map(function(b,c){return f(b,["table","query","select","expression"])||(b=d.defaults({table:c},b)),a.buildTemplate("joinItem",b)}).join(" ")),e}),a.blocks.add("joinItem:type",function(a){return a.type.toLowerCase()}),a.blocks.add("joinItem:on",function(b){var c=a.buildCondition({value:b.on,defaultFetchingOperator:"$field"});return c&&(c="on "+e(c)),c}),a.blocks.add("group",function(b){var c=b.group,e="";return d.isString(c)&&(c=[c]),d.isArray(c)&&(e=d(c).map(function(b){return a._wrapIdentifier(b)}).join(", ")),e&&(e="group by "+e),e}),a.blocks.add("having",function(b){var c=a.buildCondition({value:b.having,defaultFetchingOperator:"$value"});return c&&(c="having "+e(c)),c}),a.blocks.add("sort",function(b){var c=b.sort,e="";return d.isString(c)&&(c=[c]),d.isArray(c)?e=d(c).map(function(b){return a._wrapIdentifier(b)}).join(", "):d.isObject(c)&&(e=d(c).map(function(b,c){return a._wrapIdentifier(c)+" "+(b>0?"asc":"desc")}).join(", ")),e&&(e="order by "+e),e}),a.blocks.add("limit",function(b){return"limit "+a.builder._pushValue(b.limit)}),a.blocks.add("offset",function(b){return"offset "+a.builder._pushValue(b.offset)}),a.blocks.add("or",function(a){return"or "+a.or}),a.blocks.add("insert:values",function(b){var c=b.values;d.isArray(c)||(c=[c]);var e=b.fields||d(c).chain().map(function(a){return d(a).keys()}).flatten().uniq().value();return a.buildTemplate("insertValues",{fields:e,values:d(c).map(function(b){return d(e).map(function(c){return a.buildBlock("value",{value:b[c]})})})})}),a.blocks.add("insertValues:values",function(a){return d(a.values).map(function(a){return"("+a.join(", ")+")"}).join(", ")}),a.blocks.add("queryBody",function(b){var c=b.queryBody||{};return a.buildTemplate(c.type||"select",c)}),a.blocks.add("query",function(b){return a.buildTemplate("subQuery",{queryBody:b.query})}),a.blocks.add("select",function(b){return a.buildTemplate("subQuery",{queryBody:b.select})}),a.blocks.add("queries",function(b){return d(b.queries).map(function(b){return a.buildTemplate("subQuery",{queryBody:b})}).join(" "+b.type+(b.all?" all":"")+" ")}),a.blocks.add("with",function(a){var c=b(a["with"]);return c&&(c="with "+c),c}),a.blocks.add("withRecursive",function(a){var c=b(a.withRecursive);return c&&(c="with recursive "+c),c}),a.blocks.add("returning",function(b){var c=a.buildBlock("fields",{fields:b.returning});return c&&(c="returning "+c),c})}},function(a){"use strict";a.exports=function(a){a.modifiers.add("$set",function(a,b){return[a,"=",b].join(" ")}),a.modifiers.add("$inc",function(a,b){return[a,"=",a,"+",b].join(" ")}),a.modifiers.add("$dec",function(a,b){return[a,"=",a,"-",b].join(" ")}),a.modifiers.add("$mul",function(a,b){return[a,"=",a,"*",b].join(" ")}),a.modifiers.add("$div",function(a,b){return[a,"=",a,"/",b].join(" ")}),a.modifiers.add("$default",function(a){return[a,"=","default"].join(" ")})}},function(a){"use strict";var b=function(a,b,c){return[a,b,c].join(" ")},c=function(a,c,d){return b(a,"is"+(d?"":" not"),c)};a.exports=function(a){a.operators.comparison.add("$eq",{inversedOperator:"$ne",fn:function(a,c){return b(a,"=",c)}}),a.operators.comparison.add("$ne",{inversedOperator:"$eq",fn:function(a,c){return b(a,"!=",c)}}),a.operators.comparison.add("$gt",{inversedOperator:"$lte",fn:function(a,c){return b(a,">",c)}}),a.operators.comparison.add("$lt",{inversedOperator:"$gte",fn:function(a,c){return b(a,"<",c)}}),a.operators.comparison.add("$gte",{inversedOperator:"$lt",fn:function(a,c){return b(a,">=",c)}}),a.operators.comparison.add("$lte",{inversedOperator:"$gt",fn:function(a,c){return b(a,"<=",c)}}),a.operators.comparison.add("$is",{inversedOperator:"$isNot",fn:function(a,c){return b(a,"is",c)}}),a.operators.comparison.add("$isNot",{inversedOperator:"$is",fn:function(a,c){return b(a,"is not",c)}}),a.operators.comparison.add("$isDistinct",{inversedOperator:"$isNotDistinct",fn:function(a,c){return b(a,"is distinct from",c)}}),a.operators.comparison.add("$isNotDistinct",{inversedOperator:"$isDistinct",fn:function(a,c){return b(a,"is not distinct from",c)}}),a.operators.comparison.add("$like",{inversedOperator:"$nlike",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"like",c)}}),a.operators.comparison.add("$nlike",{inversedOperator:"$like",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"not like",c)}}),a.operators.comparison.add("$similarTo",{inversedOperator:"$nsimilarTo",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"similar to",c)}}),a.operators.comparison.add("$nsimilarTo",{inversedOperator:"$similarTo",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"not similar to",c)}}),a.operators.comparison.add("$match",{inversedOperator:"$nmatch",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"~",c)}}),a.operators.comparison.add("$nmatch",{inversedOperator:"$match",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"!~",c)}}),a.operators.comparison.add("$imatch",{inversedOperator:"$nimatch",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"~*",c)}}),a.operators.comparison.add("$nimatch",{inversedOperator:"$imatch",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"!~*",c)}}),a.operators.comparison.add("$null",{inversedOperator:"$nnull",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"null",b)}}),a.operators.comparison.add("$nnull",{inversedOperator:"$null",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"null",!b)}}),a.operators.comparison.add("$true",{inversedOperator:"$ntrue",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"true",b)}}),a.operators.comparison.add("$ntrue",{inversedOperator:"$true",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"true",!b)}}),a.operators.comparison.add("$false",{inversedOperator:"$nfalse",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"false",b)}}),a.operators.comparison.add("$nfalse",{inversedOperator:"$false",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"false",!b)}}),a.operators.comparison.add("$unknown",{inversedOperator:"$nunknown",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"unknown",b)}}),a.operators.comparison.add("$nunknown",{inversedOperator:"$unknown",defaultFetchingOperator:"$boolean",fn:function(a,b){return c(a,"unknown",!b)}}),a.operators.comparison.add("$in",{inversedOperator:"$nin",defaultFetchingOperator:"$inValues",fn:function(a,c){return b(a,"in",c)}}),a.operators.comparison.add("$nin",{inversedOperator:"$in",defaultFetchingOperator:"$inValues",fn:function(a,c){return b(a,"not in",c)}}),a.operators.comparison.add("$between",{inversedOperator:"$nbetween",defaultFetchingOperator:"$betweenValues",fn:function(a,c){return b(a,"between",c)}}),a.operators.comparison.add("$nbetween",{inversedOperator:"$between",defaultFetchingOperator:"$betweenValues",fn:function(a,c){return b(a,"not between",c)}})}},function(a,b,c){"use strict";var d=c(1);a.exports=function(a){a.operators.fetching.add("$field",{fn:function(b){return a.buildBlock("term",{term:b,type:"field"})}}),a.operators.fetching.add("$value",{fn:function(b){return a.buildBlock("term",{term:b,type:"value"})}}),a.operators.fetching.add("$func",{fn:function(b){return a.buildBlock("term",{term:b,type:"func"})}}),a.operators.fetching.add("$expression",{fn:function(b){return a.buildBlock("term",{term:b,type:"expression"})}}),a.operators.fetching.add("$select",{fn:function(b){return a.buildTemplate("subQuery",{queryBody:b})}}),a.operators.fetching.add("$query",{fn:function(b){return a.buildTemplate("subQuery",{queryBody:b})}}),a.operators.fetching.add("$boolean",{fn:function(a){return Boolean(a)}}),a.operators.fetching.add("$inValues",{fn:function(b){if(!d.isObject(b))throw new Error('Invalid `$in/$nin` value type "'+typeof b+'"');return d.isArray(b)?(b.length||(b=[null]),"("+d(b).map(function(b){return a.builder._pushValue(b)}).join(", ")+")"):a.buildTemplate("subQuery",{queryBody:b})}}),a.operators.fetching.add("$betweenValues",{fn:function(b){if(!d.isArray(b))throw new Error('Invalid `$between` value type "'+typeof b+'"');if(b.length<2)throw new Error("`$between` array length should be 2 or greater");return a.builder._pushValue(b[0])+" and "+a.builder._pushValue(b[1])}})}},function(a,b,c){"use strict";var d=c(158),e=c(161),f=c(159),g=c(162);a.exports=function(a){d(a),e(a),f(a),g(a)}},function(a){"use strict";function b(a,b){if(!b.length)return"";var c=b.join(" "+a+" ");return b.length>1&&(c="("+c+")"),c}a.exports=function(a){a.operators.logical.add("$and",{fn:function(a){return b("and",a)}}),a.operators.logical.add("$or",{fn:function(a){return b("or",a)}}),a.operators.logical.add("$not",{fn:function(a){return"not "+b("and",a)}}),a.operators.logical.add("$nor",{fn:function(a){return"not "+b("or",a)}})}},function(a){"use strict";a.exports=function(a){a.operators.state.add("$not",{getOperator:function(b){var c=a.operators.comparison.get(b);if(!c||!c.inversedOperator)throw new Error("Cannot get inversed operator for operator `"+b+"`");return c.inversedOperator}})}},function(a,b,c){"use strict";var d=c(1),e=c(132);a.exports=function(a){var b=["natural","cross","inner","outer","left","right","full","self"],c=/^(rollback|abort|replace|fail|ignore)$/i;a.templates.add("query",{pattern:"{queryBody}",validate:function(a,b){e.requiredProp(a,b,"queryBody"),e.propType(a,b,"queryBody","object")}}),a.templates.add("subQuery",{pattern:"({queryBody})",validate:function(a,b){e.requiredProp(a,b,"queryBody"),e.propType(a,b,"queryBody","object")}}),a.templates.add("queriesCombination",{pattern:"{with} {withRecursive} {queries} {sort} {limit} {offset}",validate:function(a,b){e.onlyOneOfProps(a,b,["with","withRecursive"]),e.propType(a,b,"with","object"),e.propType(a,b,"withRecursive","object"),e.requiredProp(a,b,"queries"),e.propType(a,b,"queries","array"),e.minPropLength(a,b,"queries",2),e.propType(a,b,"sort",["string","array","object"]),e.propType(a,b,"limit",["number","string"]),e.propType(a,b,"offset",["number","string"])}}),a.templates.add("insertValues",{pattern:"({fields}) values {values}",validate:function(a,b){e.requiredProp("values",b,"fields"),e.propType("values",b,"fields","array"),e.minPropLength("values",b,"fields",1),e.requiredProp("values",b,"values"),e.propType("values",b,"values","array"),e.minPropLength("values",b,"values",1)}}),a.templates.add("joinItem",{pattern:"{type} join {table} {query} {select} {expression} {alias} {on}",validate:function(a,c){e.propType("join",c,"type","string"),e.customProp("join",c,"type",function(a){var c=d(a.toLowerCase().split(" ")).compact();return!d.difference(c,b).length}),e.atLeastOneOfProps("join",c,["table","query","select","expression"]),e.onlyOneOfProps("join",c,["table","query","select","expression"]),e.propType("join",c,"table","string"),e.propType("join",c,"query","object"),e.propType("join",c,"select","object"),e.propType("join",c,"expression",["string","object"]),e.propType("join",c,"alias",["string","object"]),e.propType("join",c,"on",["array","object"])}}),a.templates.add("withItem",{pattern:"{name} {fields} as {query} {select} {expression}",validate:function(a,b){e.requiredProp("with",b,"name"),e.propType("with",b,"name","string"),e.propType(a,b,"fields",["array","object"]),e.atLeastOneOfProps("with",b,["query","select","expression"]),e.onlyOneOfProps("with",b,["query","select","expression"]),e.propType("with",b,"query","object"),e.propType("with",b,"select","object"),e.propType("with",b,"expression",["string","object"])}}),a.templates.add("fromItem",{pattern:"{table} {query} {select} {expression} {alias}",validate:function(a,b){e.atLeastOneOfProps("from",b,["table","query","select","expression"]),e.onlyOneOfProps("from",b,["table","query","select","expression"]),e.propType("from",b,"table","string"),e.propType("from",b,"query","object"),e.propType("from",b,"select","object"),e.propType("from",b,"expression",["string","object"]),e.propType("from",b,"alias",["string","object"])}}),a.templates.add("select",{pattern:"{with} {withRecursive} select {distinct} {fields} {count} from {from} {table} {query} {select} {expression} {alias} {join} {condition} {group} {having} {sort} {limit} {offset}",defaults:{fields:{}},validate:function(a,b){e.onlyOneOfProps(a,b,["with","withRecursive"]),e.propType(a,b,"with","object"),e.propType(a,b,"withRecursive","object"),e.propType(a,b,"distinct","boolean"),e.propType(a,b,"fields",["array","object"]),e.propType(a,b,"count","object"),e.propType(a,b,"from",["string","array","object"]),e.atLeastOneOfProps(a,b,["table","query","select","expression"]),e.onlyOneOfProps(a,b,["table","query","select","expression"]),e.propType(a,b,"table","string"),e.propType(a,b,"query","object"),e.propType(a,b,"select","object"),e.propType(a,b,"expression",["string","object"]),e.propType(a,b,"alias",["string","object"]),e.propType(a,b,"join",["array","object"]),e.propType(a,b,"condition",["array","object"]),e.propType(a,b,"having",["array","object"]),e.propType(a,b,"group",["string","array"]),e.propType(a,b,"sort",["string","array","object"]),e.propType(a,b,"limit",["number","string"]),e.propType(a,b,"offset",["number","string"])}}),a.templates.add("insert",{pattern:"{with} {withRecursive} insert {or} into {table} {values} {condition} {returning}",validate:function(a,b){e.onlyOneOfProps(a,b,["with","withRecursive"]),e.propType(a,b,"with","object"),e.propType(a,b,"withRecursive","object"),e.propType(a,b,"or","string"),e.propMatch(a,b,"or",c),e.requiredProp(a,b,"table"),e.propType(a,b,"table","string"),e.requiredProp(a,b,"values"),e.propType(a,b,"values",["array","object"]),e.propType(a,b,"condition",["array","object"]),e.propType(a,b,"returning",["array","object"])}}),a.templates.add("update",{pattern:"{with} {withRecursive} update {or} {table} {alias} {modifier} {condition} {returning}",validate:function(a,b){e.onlyOneOfProps(a,b,["with","withRecursive"]),e.propType(a,b,"with","object"),e.propType(a,b,"withRecursive","object"),e.propType(a,b,"or","string"),e.propMatch(a,b,"or",c),e.requiredProp(a,b,"table"),e.propType(a,b,"table","string"),e.propType(a,b,"alias","string"),e.requiredProp(a,b,"modifier"),e.propType(a,b,"modifier","object"),e.propType(a,b,"condition",["array","object"]),e.propType(a,b,"returning",["array","object"])}}),a.templates.add("remove",{pattern:"{with} {withRecursive} delete from {table} {alias} {condition} {returning}",validate:function(a,b){e.onlyOneOfProps(a,b,["with","withRecursive"]),e.propType(a,b,"with","object"),e.propType(a,b,"withRecursive","object"),e.requiredProp(a,b,"table"),e.propType(a,b,"table","string"),e.propType(a,b,"alias","string"),e.propType(a,b,"condition",["array","object"]),e.propType(a,b,"returning",["array","object"])}}),a.templates.add("union",a.templates.get("queriesCombination")),a.templates.add("intersect",a.templates.get("queriesCombination")),a.templates.add("except",a.templates.get("queriesCombination"))}},function(a,b,c){"use strict";var d=c(24),e=c(1),f=c(29),g=a.exports=function(a){d.call(this,a)};f.inherits(g,d),g.prototype.config=e({}).extend(d.prototype.config,{})},function(a,b,c){"use strict";var d=c(24),e=c(1),f=c(29),g=a.exports=function(a){d.call(this,a)};f.inherits(g,d),g.prototype.config=e({}).extend(d.prototype.config,{identifierPrefix:"`",identifierSuffix:"`"})},function(a,b,c){"use strict";var d=c(1);a.exports=function(a){var b=a.blocks.get("value");a.blocks.set("value",function(c){var e,f=c.value;return e=d.isArray(f)?"array["+d(f).map(function(b){return a.builder._pushValue(b)}).join(", ")+"]":d.isObject(f)?a.builder._pushValue(JSON.stringify(f)):b(c)}),a.blocks.add("explain:options",function(a){return"("+d(a.options).chain().pick(["analyze","verbose","costs","buffers","timing","format"]).map(function(a,b){return b+" "+a}).value().join(", ")+")"}),a.blocks.add("explain:analyze",function(){return"analyze"}),a.blocks.add("explain:verbose",function(){return"verbose"}),a.blocks.add("distinctOn",function(b){var c=b.distinctOn,e="";return d.isString(c)&&(c=[c]),d.isArray(c)&&(e=d(c).map(function(b){return a._wrapIdentifier(b)}).join(", ")),e&&(e="distinct on ("+e+")"),e})}},function(a,b,c){"use strict";var d=c(24),e=c(1),f=c(29),g=c(171),h=c(166),i=c(170),j=a.exports=function(a){d.call(this,a),g(this),h(this),i(this)};f.inherits(j,d),j.prototype.config=e({jsonSeparatorRegexp:/->>?/g}).extend(d.prototype.config),j.prototype._wrapIdentifier=function(a){var b=a.split(this.config.jsonSeparatorRegexp),c=a.match(this.config.jsonSeparatorRegexp),f=d.prototype._wrapIdentifier.call(this,b[0]);return f+=e(c).reduce(function(a,c,d){return a+c+"'"+b[d+1]+"'"},"")}},function(a){"use strict";a.exports=function(a){var b=function(a,b,c){return[a,b,c].join(" ")};a.operators.comparison.add("$jsonContains",{defaultFetchingOperator:"$json",fn:function(a,c){return b(a,"@>",c)}}),a.operators.comparison.add("$jsonIn",{defaultFetchingOperator:"$json",fn:function(a,c){return b(a,"<@",c)}}),a.operators.comparison.add("$jsonHas",{defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"?",c)}}),a.operators.comparison.add("$jsonHasAny",{defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"?|",c)}}),a.operators.comparison.add("$jsonHasAll",{defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"?&",c)}}),a.operators.comparison.add("$ilike",{inversedOperator:"$nilike",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"ilike",c)}}),a.operators.comparison.add("$nilike",{inversedOperator:"$ilike",defaultFetchingOperator:"$value",fn:function(a,c){return b(a,"not ilike",c)}})}},function(a){"use strict";a.exports=function(a){a.operators.fetching.add("$json",{fn:function(b,c){return c&&(b={value:b}),a.buildBlock("term",{term:b,type:"value"})}})}},function(a,b,c){"use strict";var d=c(168),e=c(169);a.exports=function(a){d(a),e(a)}},function(a,b,c){"use strict";var d=c(1),e=c(132);a.exports=function(a){var b=/^(text|xml|json|yaml)$/i;a.templates.add("explain",{pattern:"explain {options} {analyze} {verbose} {query} {select} {expression}",validate:function(a,c){e.atLeastOneOfProps(a,c,["query","select","expression"]),e.onlyOneOfProps(a,c,["query","select","expression"]),e.propType(a,c,"options","object"),d.isUndefined(c.options)||(e.atLeastOneOfProps("explain:options",c.options,["analyze","verbose","costs","buffers","timing","format"]),e.propType("explain:options",c.options,"analyze","boolean"),e.propType("explain:options",c.options,"verbose","boolean"),e.propType("explain:options",c.options,"costs","boolean"),e.propType("explain:options",c.options,"buffers","boolean"),e.propType("explain:options",c.options,"timing","boolean"),e.propType("explain:options",c.options,"format","string"),e.propMatch("explain:options",c.options,"format",b)),e.propType(a,c,"analyze","boolean"),e.propType(a,c,"verbose","boolean")}});var c=a.templates.get("select");c.pattern=c.pattern.replace("{distinct}","{distinct} {distinctOn}");var f=c.validate;c.validate=function(a,b){f(a,b),e.propType(a,b,"distinctOn",["string","array"])},a.templates.set("select",c)}},function(a,b,c){"use strict";var d=c(1);a.exports=function(a){a.blocks.add("offset",function(b){var c="";return d.isUndefined(b.limit)&&(c=a.buildBlock("limit",{limit:-1})+" "),c+"offset "+a.builder._pushValue(b.offset)})}},function(a,b,c){"use strict";var d=c(24),e=c(1),f=c(29),g=c(172),h=a.exports=function(a){d.call(this,a),g(this)};f.inherits(h,d),h.prototype.config=e({}).extend(d.prototype.config)},function(a,b,c){"use strict";var d=c(155);a.exports=function(a){return new d(a)},a.exports.Builder=d},function(a){"use strict";function b(a){a=a||{},this._values=a.values||{}}a.exports=b,b.prototype.add=b.prototype.set=function(a,b){this._values[a]=b},b.prototype.get=function(a){return this._values[a]||null},b.prototype.remove=function(a){delete this._values[a]},b.prototype.has=function(a){return this._values.hasOwnProperty(a)}},function(a,b,c){var d="undefined"!=typeof JSON?JSON:c(177);a.exports=function(a,b){b||(b={}),"function"==typeof b&&(b={
cmp:b});var c=b.space||"";"number"==typeof c&&(c=Array(c+1).join(" "));var g="boolean"==typeof b.cycles?b.cycles:!1,h=b.replacer||function(a,b){return b},i=b.cmp&&function(a){return function(b){return function(c,d){var e={key:c,value:b[c]},f={key:d,value:b[d]};return a(e,f)}}}(b.cmp),j=[];return function k(a,b,l,m){var n=c?"\n"+new Array(m+1).join(c):"",o=c?": ":":";if(l&&l.toJSON&&"function"==typeof l.toJSON&&(l=l.toJSON()),l=h.call(a,b,l),void 0!==l){if("object"!=typeof l||null===l)return d.stringify(l);if(e(l)){for(var p=[],q=0;q<l.length;q++){var r=k(l,q,l[q],m+1)||d.stringify(null);p.push(n+c+r)}return"["+p.join(",")+n+"]"}if(-1!==j.indexOf(l)){if(g)return d.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}j.push(l);for(var s=f(l).sort(i&&i(l)),p=[],q=0;q<s.length;q++){var b=s[q],t=k(l,b,l[b],m+1);if(t){var u=d.stringify(b)+o+t;p.push(n+c+u)}}return"{"+p.join(",")+n+"}"}}({"":a},"",a,0)};var e=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},f=Object.keys||function(a){var b=Object.prototype.hasOwnProperty||function(){return!0},c=[];for(var d in a)b.call(a,d)&&c.push(d);return c}},function(a,b,c){b.parse=c(178),b.stringify=c(179)},function(a){var b,c,d,e,f={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},g=function(a){throw{name:"SyntaxError",message:a,at:b,text:d}},h=function(a){return a&&a!==c&&g("Expected '"+a+"' instead of '"+c+"'"),c=d.charAt(b),b+=1,c},i=function(){var a,b="";for("-"===c&&(b="-",h("-"));c>="0"&&"9">=c;)b+=c,h();if("."===c)for(b+=".";h()&&c>="0"&&"9">=c;)b+=c;if("e"===c||"E"===c)for(b+=c,h(),("-"===c||"+"===c)&&(b+=c,h());c>="0"&&"9">=c;)b+=c,h();return a=+b,isFinite(a)?a:void g("Bad number")},j=function(){var a,b,d,e="";if('"'===c)for(;h();){if('"'===c)return h(),e;if("\\"===c)if(h(),"u"===c){for(d=0,b=0;4>b&&(a=parseInt(h(),16),isFinite(a));b+=1)d=16*d+a;e+=String.fromCharCode(d)}else{if("string"!=typeof f[c])break;e+=f[c]}else e+=c}g("Bad string")},k=function(){for(;c&&" ">=c;)h()},l=function(){switch(c){case"t":return h("t"),h("r"),h("u"),h("e"),!0;case"f":return h("f"),h("a"),h("l"),h("s"),h("e"),!1;case"n":return h("n"),h("u"),h("l"),h("l"),null}g("Unexpected '"+c+"'")},m=function(){var a=[];if("["===c){if(h("["),k(),"]"===c)return h("]"),a;for(;c;){if(a.push(e()),k(),"]"===c)return h("]"),a;h(","),k()}}g("Bad array")},n=function(){var a,b={};if("{"===c){if(h("{"),k(),"}"===c)return h("}"),b;for(;c;){if(a=j(),k(),h(":"),Object.hasOwnProperty.call(b,a)&&g('Duplicate key "'+a+'"'),b[a]=e(),k(),"}"===c)return h("}"),b;h(","),k()}}g("Bad object")};e=function(){switch(k(),c){case"{":return n();case"[":return m();case'"':return j();case"-":return i();default:return c>="0"&&"9">=c?i():l()}},a.exports=function(a,f){var h;return d=a,b=0,c=" ",h=e(),k(),c&&g("Syntax error"),"function"==typeof f?function i(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=i(e,c),void 0!==d?e[c]=d:delete e[c]);return f.call(a,b,e)}({"":h},""):h}},function(a){function b(a){return g.lastIndex=0,g.test(a)?'"'+a.replace(g,function(a){var b=h[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,g){var h,i,j,k,l,m=d,n=g[a];switch(n&&"object"==typeof n&&"function"==typeof n.toJSON&&(n=n.toJSON(a)),"function"==typeof f&&(n=f.call(g,a,n)),typeof n){case"string":return b(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";if(d+=e,l=[],"[object Array]"===Object.prototype.toString.apply(n)){for(k=n.length,h=0;k>h;h+=1)l[h]=c(h,n)||"null";return j=0===l.length?"[]":d?"[\n"+d+l.join(",\n"+d)+"\n"+m+"]":"["+l.join(",")+"]",d=m,j}if(f&&"object"==typeof f)for(k=f.length,h=0;k>h;h+=1)i=f[h],"string"==typeof i&&(j=c(i,n),j&&l.push(b(i)+(d?": ":":")+j));else for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(j=c(i,n),j&&l.push(b(i)+(d?": ":":")+j));return j=0===l.length?"{}":d?"{\n"+d+l.join(",\n"+d)+"\n"+m+"}":"{"+l.join(",")+"}",d=m,j}}var d,e,f,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};a.exports=function(a,b,g){var h;if(d="",e="","number"==typeof g)for(h=0;g>h;h+=1)e+=" ";else"string"==typeof g&&(e=g);if(f=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return c("",{"":a})}},function(a,b,c){function d(a,b){a=a||{};var c={};for(var f in b)if(b.hasOwnProperty(f)){var g,i,k=b[f],l=f.split("."),m=a,n=[];a:for(var o=0;o<l.length;o++)switch(m=m[l[o]],h(m)){case"array":if(g=l.slice(0,o+1).join("."),i=l.slice(o+1).join("."),j('searching array "%s"',g),k.$size&&!i.length)return e(k,m);for(var p=c[g]||m,q=0;q<p.length;q++)if(i.length){var r={};r[i]=k,"object"==h(p[q])&&(j("attempting subdoc search with query %j",r),d(p[q],r)&&(c[g]&&~c[g].indexOf(p[q])||n.push(p[q])))}else j("performing simple array item search"),e(k,p[q])&&(c[g]&&~c[g].indexOf(p[q])||n.push(p[q]));n.length&&(c[g]=c[g]||[],c[g].push.apply(c[g],n));break a;case"undefined":return!1;case"object":if(null!=l[o+1])continue;if(!e(k,m))return!1;break;default:if(!e(k,m))return!1}}return c}function e(a,b){if("object"!=h(a))return g(a,b);var c=i.keys(a);if("$"==c[0][0]){for(var e=0;e<c.length;e++){if("$elemMatch"==c[e])return!1!==d(b,a.$elemMatch);if(!f[c[e]](a[c[e]],b))return!1}return!0}return g(a,b)}var f=c(184),g=c(95),h=(c(94),c(25)),i=c(96),j=c(93)("mongo-query");a.exports=b=d,b.ops=f},function(a,b,c){function d(a,b,c,d){a=a||{},d=d||{},b=b||{},c=c||{};var j,k=!!d.strict,l=[];if(h.length(b)&&(j=f(a,b)),k&&!1===j)i("no matches for query %j",b);else{for(var m=h.keys(c),n=[],o=0,p=m.length;p>o;o++)if(e[m[o]]){i('found modifier "%s"',m[o]);for(var q in c[m[o]]){var r=q.indexOf(".$.");if(~r){var s=q.substr(0,r),t=q.substr(r+3);if(j[s]){i('executing "%s" %s on first match within "%s"',q,m[o],s);var u=e[m[o]](j[s][0],t,c[m[o]][q]);if(u){var v=g.get(a,s).indexOf(j[s][0]);u.key=s+"."+v+"."+t,u.op=m[o],n.push(u)}}else i('ignoring "%s" %s - no matches within "%s"',q,m[o],s)}else{var u=e[m[o]](a,q,c[m[o]][q]);u&&(u.key=q,u.op=m[o],n.push(u))}}}else i('skipping unknown modifier "%s"',m[o]);if(n.length)for(var o=0;o<n.length;o++){var u=n[o],w=u();l.push({op:u.op,key:u.key,value:w})}}return l}var e=c(182),f=c(180),g=c(94),h=(c(25),c(96)),i=c(93)("mongo-query");a.exports=b=d,b.filter=f,b.mods=e},function(a,b,c){function d(a,b){for(var c=0,d=a.length;d>c;c++)if(g(b,a[c]))return!0;return!1}function e(a,b,c){for(var d=[],e=0;e<a.length;e++)for(var f=a[e],h=0;h<b.length;h++){var l=b[h];if("object"==i(l))if("object"==i(f)){var m=!1;if(j(l).length){for(var h in l)if(l.hasOwnProperty(h)){if(!g(l[h],f[h])){m=!1;break}m=!0}}else j(f).length||(m=!0);if(m){d.push(e),c.push(f);continue}}else k("ignoring pull match against object");else if(g(l,f)){d.push(e),c.push(f);continue}}return function(){for(var b=0;b<d.length;b++){var c=d[b];a.splice(c-b,1)}}}function f(a){return"number"==i(a)||Number(a)==a}var g=c(95),h=c(94),i=c(25),j=c(96).keys,k=c(93)("mongo-query");b.$set=function(a,b,c){var d=b.split(".").pop();switch(a=h.parent(a,b,!0),i(a)){case"object":if(!g(a[d],c))return function(){return a[d]=c,c};break;case"array":if(!f(d))throw new Error("can't append to array using string field name ["+d+"]");if(!g(a[d],c))return function(){return a[d]=c,c};break;default:throw new Error("$set only supports object not "+i(a))}},b.$unset=function(a,b){var c=b.split(".").pop();switch(a=h.parent(a,b),i(a)){case"array":case"object":if(a.hasOwnProperty(c))return function(){delete a[c]};k("ignoring unset of inexisting key")}},b.$rename=function(a,b,c){if(b==c)throw new Error("$rename source must differ from target");if(0===b.indexOf(c+"."))throw new Error("$rename target may not be a parent of source");var d=h.parent(a,b),e=i(d);if("object"==e){var f=b.split(".").pop();if(d.hasOwnProperty(f))return function(){var b=d[f];delete d[f];var e=h.parent(a,c,!0);return"object"==i(e)?e[c.split(".").pop()]=b:k("invalid $rename target path type"),c};k("ignoring rename from inexisting source")}else if("undefined"!=e)throw new Error("$rename source field invalid")},b.$inc=function(a,b,c){if("number"!=i(c))throw new Error("Modifier $inc allowed for numbers only");a=h.parent(a,b,!0);var d=b.split(".").pop();switch(i(a)){case"array":case"object":if(a.hasOwnProperty(d)){if("number"!=i(a[d]))throw new Error("Cannot apply $inc modifier to non-number");return function(){return a[d]+=c,c}}if("object"==i(a)||f(d))return function(){return a[d]=c,c};throw new Error("can't append to array using string field name ["+d+"]");default:throw new Error("Cannot apply $inc modifier to non-number")}},b.$pop=function(a,b,c){a=h.parent(a,b);var d=b.split(".").pop();switch(i(a)){case"array":case"object":if(a.hasOwnProperty(d))switch(i(a[d])){case"array":if(a[d].length)return function(){return-1==c?a[d].shift():a[d].pop()};break;case"undefined":k("ignoring pop to inexisting key");break;default:throw new Error("Cannot apply $pop modifier to non-array")}else k("ignoring pop to inexisting key");break;case"undefined":k("ignoring pop to inexisting key")}},b.$push=function(a,b,c){a=h.parent(a,b,!0);var d=b.split(".").pop();switch(i(a)){case"object":if(a.hasOwnProperty(d)){if("array"==i(a[d]))return function(){return a[d].push(c),c};throw new Error("Cannot apply $push/$pushAll modifier to non-array")}return function(){return a[d]=[c],c};case"array":if(a.hasOwnProperty(d)){if("array"==i(a[d]))return function(){return a[d].push(c),c};throw new Error("Cannot apply $push/$pushAll modifier to non-array")}if(f(d))return function(){return a[d]=[c],c};throw new Error("can't append to array using string field name ["+d+"]")}},b.$pushAll=function(a,b,c){if("array"!=i(c))throw new Error("Modifier $pushAll/pullAll allowed for arrays only");a=h.parent(a,b,!0);var d=b.split(".").pop();switch(i(a)){case"object":if(a.hasOwnProperty(d)){if("array"==i(a[d]))return function(){return a[d].push.apply(a[d],c),c};throw new Error("Cannot apply $push/$pushAll modifier to non-array")}return function(){return a[d]=c,c};case"array":if(a.hasOwnProperty(d)){if("array"==i(a[d]))return function(){return a[d].push.apply(a[d],c),c};throw new Error("Cannot apply $push/$pushAll modifier to non-array")}if(f(d))return function(){return a[d]=c,c};throw new Error("can't append to array using string field name ["+d+"]")}},b.$pull=function(a,b,c){a=h.parent(a,b,!0);var d=b.split(".").pop(),f=i(a);switch(f){case"object":if(a.hasOwnProperty(d)){if("array"!=i(a[d]))throw new Error("Cannot apply $pull/$pullAll modifier to non-array");var g=[],j=e(a[d],[c],g);if(g.length)return function(){return j(),g}}break;case"array":if(a.hasOwnProperty(d)){if("array"!=i(a[d]))throw new Error("Cannot apply $pull/$pullAll modifier to non-array");var g=[],j=e(a[d],[c],g);if(g.length)return function(){return j(),g}}else k("ignoring pull to non array");break;default:if("undefined"!=f)throw new Error("LEFT_SUBFIELD only supports Object: hello not: "+f)}},b.$pullAll=function(a,b,c){if("array"!=i(c))throw new Error("Modifier $pushAll/pullAll allowed for arrays only");a=h.parent(a,b,!0);var d=b.split(".").pop(),f=i(a);switch(f){case"object":if(a.hasOwnProperty(d)){if("array"!=i(a[d]))throw new Error("Cannot apply $pull/$pullAll modifier to non-array");var g=[],j=e(a[d],c,g);if(g.length)return function(){return j(),g}}break;case"array":if(a.hasOwnProperty(d)){if("array"!=i(a[d]))throw new Error("Cannot apply $pull/$pullAll modifier to non-array");var g=[],j=e(a[d],c,g);if(g.length)return function(){return j(),g}}else k("ignoring pull to non array");break;default:if("undefined"!=f)throw new Error("LEFT_SUBFIELD only supports Object: hello not: "+f)}},b.$addToSet=function l(a,b,c,e){if(!e&&"array"==i(c.$each)){for(var g=[],j=0,k=c.$each.length;k>j;j++){var m=l(a,b,c.$each[j],!0);m&&g.push(m)}return g.length?function(){for(var a=[],b=0;b<g.length;b++)a.push(g[b]());return a}:void 0}a=h.parent(a,b,!0);var n=b.split(".").pop();switch(i(a)){case"object":if(!a.hasOwnProperty(n))return function(){return a[n]=[c],c};if("array"!=i(a[n]))throw new Error("Cannot apply $addToSet modifier to non-array");if(!d(a[n],c))return function(){return a[n].push(c),c};break;case"array":if(!a.hasOwnProperty(n)){if(f(n))return function(){return a[n]=[c],c};throw new Error("can't append to array using string field name ["+n+"]")}if("array"!=i(a[n]))throw new Error("Cannot apply $addToSet modifier to non-array");if(!d(a[n],c))return function(){return a[n].push(c),c}}}},function(a){var b=Object.prototype.toString;a.exports=function(a){switch(b.call(a)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array"}return null===a?"null":void 0===a?"undefined":a===Object(a)?"object":typeof a}},function(a,b,c){var d=c(95),e=c(25);b.$ne=function(a,b){return!d(a,b)},b.$gt=function(a,b){return"number"===e(a)&&b>a},b.$gte=function(a,b){return"number"===e(a)&&b>=a},b.$lt=function(a,b){return"number"===e(a)&&a>b},b.$lte=function(a,b){return"number"===e(a)&&a>=b},b.$regex=function(a,b){return"regexp"!=e("matcher")&&(a=new RegExp(a)),a.test(b)},b.$exists=function(a,b){return a?void 0!==b:void 0===b},b.$in=function(a,b){if("array"!=e(a))return!1;for(var c=0;c<a.length;c++)if(d(a[c],b))return!0;return!1},b.$nin=function(a,c){return!b.$in(a,c)},b.$size=function(a,b){return Array.isArray(b)&&a==b.length}},function(a,b,c){var d=c(12).CryptoJS;/*
	CryptoJS v3.1.2
	code.google.com/p/crypto-js
	(c) 2009-2013 by Jeff Mott. All rights reserved.
	code.google.com/p/crypto-js/wiki/License
	*/
!function(){var a=d,b=a.lib,c=b.BlockCipher,e=a.algo,f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[];!function(){for(var a=[],b=0;256>b;b++)a[b]=128>b?b<<1:b<<1^283;for(var c=0,d=0,b=0;256>b;b++){var e=d^d<<1^d<<2^d<<3^d<<4;e=e>>>8^255&e^99,f[c]=e,g[e]=c;var p=a[c],q=a[p],r=a[q],s=257*a[e]^16843008*e;h[c]=s<<24|s>>>8,i[c]=s<<16|s>>>16,j[c]=s<<8|s>>>24,k[c]=s;var s=16843009*r^65537*q^257*p^16843008*c;l[e]=s<<24|s>>>8,m[e]=s<<16|s>>>16,n[e]=s<<8|s>>>24,o[e]=s,c?(c=p^a[a[a[r^p]]],d^=a[a[d]]):c=d=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],q=e.AES=c.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,d=this._nRounds=c+6,e=4*(d+1),g=this._keySchedule=[],h=0;e>h;h++)if(c>h)g[h]=b[h];else{var i=g[h-1];h%c?c>6&&h%c==4&&(i=f[i>>>24]<<24|f[i>>>16&255]<<16|f[i>>>8&255]<<8|f[255&i]):(i=i<<8|i>>>24,i=f[i>>>24]<<24|f[i>>>16&255]<<16|f[i>>>8&255]<<8|f[255&i],i^=p[h/c|0]<<24),g[h]=g[h-c]^i}for(var j=this._invKeySchedule=[],k=0;e>k;k++){var h=e-k;if(k%4)var i=g[h];else var i=g[h-4];j[k]=4>k||4>=h?i:l[f[i>>>24]]^m[f[i>>>16&255]]^n[f[i>>>8&255]]^o[f[255&i]]}},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,h,i,j,k,f)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,l,m,n,o,g);var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++){var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],s=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++];j=p,k=q,l=r,m=s}var p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],s=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++];a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=s},keySize:8});a.AES=c._createHelper(q)}()},function(a,b,c){var d=c(12).CryptoJS;/*
	CryptoJS v3.1.2
	code.google.com/p/crypto-js
	(c) 2009-2013 by Jeff Mott. All rights reserved.
	code.google.com/p/crypto-js/wiki/License
	*/
d.lib.Cipher||function(a){var b=d,c=b.lib,e=c.Base,f=c.WordArray,g=c.BufferedBlockAlgorithm,h=b.enc,i=(h.Utf8,h.Base64),j=b.algo,k=j.EvpKDF,l=c.Cipher=g.extend({cfg:e.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function a(a){return"string"==typeof a?x:u}return function(b){return{encrypt:function(c,d,e){return a(d).encrypt(b,c,d,e)},decrypt:function(c,d,e){return a(d).decrypt(b,c,d,e)}}}}()}),m=(c.StreamCipher=l.extend({_doFinalize:function(){var a=this._process(!0);return a},blockSize:1}),b.mode={}),n=c.BlockCipherMode=e.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}}),o=m.CBC=function(){function b(b,c,d){var e=this._iv;if(e){var f=e;this._iv=a}else var f=this._prevBlock;for(var g=0;d>g;g++)b[c+g]^=f[g]}var c=n.extend();return c.Encryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize;b.call(this,a,c,e),d.encryptBlock(a,c),this._prevBlock=a.slice(c,c+e)}}),c.Decryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize,f=a.slice(c,c+e);d.decryptBlock(a,c),b.call(this,a,c,e),this._prevBlock=f}}),c}(),p=b.pad={},q=p.Pkcs7={pad:function(a,b){for(var c=4*b,d=c-a.sigBytes%c,e=d<<24|d<<16|d<<8|d,g=[],h=0;d>h;h+=4)g.push(e);var i=f.create(g,d);a.concat(i)},unpad:function(a){var b=255&a.words[a.sigBytes-1>>>2];a.sigBytes-=b}},r=(c.BlockCipher=l.extend({cfg:l.cfg.extend({mode:o,padding:q}),reset:function(){l.reset.call(this);var a=this.cfg,b=a.iv,c=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var d=c.createEncryptor;else{var d=c.createDecryptor;this._minBufferSize=1}this._mode=d.call(c,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else{var b=this._process(!0);a.unpad(b)}return b},blockSize:4}),c.CipherParams=e.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}})),s=b.format={},t=s.OpenSSL={stringify:function(a){var b=a.ciphertext,c=a.salt;if(c)var d=f.create([1398893684,1701076831]).concat(c).concat(b);else var d=b;return d.toString(i)},parse:function(a){var b=i.parse(a),c=b.words;if(1398893684==c[0]&&1701076831==c[1]){var d=f.create(c.slice(2,4));c.splice(0,4),b.sigBytes-=16}return r.create({ciphertext:b,salt:d})}},u=c.SerializableCipher=e.extend({cfg:e.extend({format:t}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d),f=e.finalize(b),g=e.cfg;return r.create({ciphertext:f,key:c,iv:g.iv,algorithm:a,mode:g.mode,padding:g.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d),b=this._parse(b,d.format);var e=a.createDecryptor(c,d).finalize(b.ciphertext);return e},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),v=b.kdf={},w=v.OpenSSL={execute:function(a,b,c,d){d||(d=f.random(8));var e=k.create({keySize:b+c}).compute(a,d),g=f.create(e.words.slice(b),4*c);return e.sigBytes=4*b,r.create({key:e,iv:g,salt:d})}},x=c.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:w}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=d.kdf.execute(c,a.keySize,a.ivSize);d.iv=e.iv;var f=u.encrypt.call(this,a,b,e.key,d);return f.mixIn(e),f},decrypt:function(a,b,c,d){d=this.cfg.extend(d),b=this._parse(b,d.format);var e=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);d.iv=e.iv;var f=u.decrypt.call(this,a,b,e.key,d);return f}})}()},function(a,b,c){var d=c(12).CryptoJS;/*
	CryptoJS v3.1.2
	code.google.com/p/crypto-js
	(c) 2009-2013 by Jeff Mott. All rights reserved.
	code.google.com/p/crypto-js/wiki/License
	*/
!function(){{var a=d,b=a.lib,c=b.WordArray,e=a.enc;e.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp();for(var e=[],f=0;c>f;f+=3)for(var g=b[f>>>2]>>>24-f%4*8&255,h=b[f+1>>>2]>>>24-(f+1)%4*8&255,i=b[f+2>>>2]>>>24-(f+2)%4*8&255,j=g<<16|h<<8|i,k=0;4>k&&c>f+.75*k;k++)e.push(d.charAt(j>>>6*(3-k)&63));var l=d.charAt(64);if(l)for(;e.length%4;)e.push(l);return e.join("")},parse:function(a){var b=a.length,d=this._map,e=d.charAt(64);if(e){var f=a.indexOf(e);-1!=f&&(b=f)}for(var g=[],h=0,i=0;b>i;i++)if(i%4){var j=d.indexOf(a.charAt(i-1))<<i%4*2,k=d.indexOf(a.charAt(i))>>>6-i%4*2;g[h>>>2]|=(j|k)<<24-h%4*8,h++}return c.create(g,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}}()},function(a,b,c){var d=c(12).CryptoJS;/*
	CryptoJS v3.1.2
	code.google.com/p/crypto-js
	(c) 2009-2013 by Jeff Mott. All rights reserved.
	code.google.com/p/crypto-js/wiki/License
	*/
!function(){var a=d,b=a.lib,c=b.Base,e=b.WordArray,f=a.algo,g=f.MD5,h=f.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:g,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=c.hasher.create(),f=e.create(),g=f.words,h=c.keySize,i=c.iterations;g.length<h;){j&&d.update(j);var j=d.update(a).finalize(b);d.reset();for(var k=1;i>k;k++)j=d.finalize(j),d.reset();f.concat(j)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return h.create(c).compute(a,b)}}()},function(a,b,c){var d=c(12).CryptoJS,e={stringify:function(a){var b={ct:a.ciphertext.toString(d.enc.Base64)};return a.iv&&(b.iv=a.iv.toString()),a.salt&&(b.s=a.salt.toString()),JSON.stringify(b)},parse:function(a){var b=JSON.parse(a),c=d.lib.CipherParams.create({ciphertext:d.enc.Base64.parse(b.ct)});return b.iv&&(c.iv=d.enc.Hex.parse(b.iv)),b.s&&(c.salt=d.enc.Hex.parse(b.s)),c}};b.JsonFormatter=e},function(a,b,c){var d=c(12).CryptoJS;/*
	CryptoJS v3.1.2
	code.google.com/p/crypto-js
	(c) 2009-2013 by Jeff Mott. All rights reserved.
	code.google.com/p/crypto-js/wiki/License
	*/
!function(a){function b(a,b,c,d,e,f,g){var h=a+(b&c|~b&d)+e+g;return(h<<f|h>>>32-f)+b}function c(a,b,c,d,e,f,g){var h=a+(b&d|c&~d)+e+g;return(h<<f|h>>>32-f)+b}function e(a,b,c,d,e,f,g){var h=a+(b^c^d)+e+g;return(h<<f|h>>>32-f)+b}function f(a,b,c,d,e,f,g){var h=a+(c^(b|~d))+e+g;return(h<<f|h>>>32-f)+b}var g=d,h=g.lib,i=h.WordArray,j=h.Hasher,k=g.algo,l=[];!function(){for(var b=0;64>b;b++)l[b]=4294967296*a.abs(a.sin(b+1))|0}();var m=k.MD5=j.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,d){for(var g=0;16>g;g++){var h=d+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var j=this._hash.words,k=a[d+0],m=a[d+1],n=a[d+2],o=a[d+3],p=a[d+4],q=a[d+5],r=a[d+6],s=a[d+7],t=a[d+8],u=a[d+9],v=a[d+10],w=a[d+11],x=a[d+12],y=a[d+13],z=a[d+14],A=a[d+15],B=j[0],C=j[1],D=j[2],E=j[3];B=b(B,C,D,E,k,7,l[0]),E=b(E,B,C,D,m,12,l[1]),D=b(D,E,B,C,n,17,l[2]),C=b(C,D,E,B,o,22,l[3]),B=b(B,C,D,E,p,7,l[4]),E=b(E,B,C,D,q,12,l[5]),D=b(D,E,B,C,r,17,l[6]),C=b(C,D,E,B,s,22,l[7]),B=b(B,C,D,E,t,7,l[8]),E=b(E,B,C,D,u,12,l[9]),D=b(D,E,B,C,v,17,l[10]),C=b(C,D,E,B,w,22,l[11]),B=b(B,C,D,E,x,7,l[12]),E=b(E,B,C,D,y,12,l[13]),D=b(D,E,B,C,z,17,l[14]),C=b(C,D,E,B,A,22,l[15]),B=c(B,C,D,E,m,5,l[16]),E=c(E,B,C,D,r,9,l[17]),D=c(D,E,B,C,w,14,l[18]),C=c(C,D,E,B,k,20,l[19]),B=c(B,C,D,E,q,5,l[20]),E=c(E,B,C,D,v,9,l[21]),D=c(D,E,B,C,A,14,l[22]),C=c(C,D,E,B,p,20,l[23]),B=c(B,C,D,E,u,5,l[24]),E=c(E,B,C,D,z,9,l[25]),D=c(D,E,B,C,o,14,l[26]),C=c(C,D,E,B,t,20,l[27]),B=c(B,C,D,E,y,5,l[28]),E=c(E,B,C,D,n,9,l[29]),D=c(D,E,B,C,s,14,l[30]),C=c(C,D,E,B,x,20,l[31]),B=e(B,C,D,E,q,4,l[32]),E=e(E,B,C,D,t,11,l[33]),D=e(D,E,B,C,w,16,l[34]),C=e(C,D,E,B,z,23,l[35]),B=e(B,C,D,E,m,4,l[36]),E=e(E,B,C,D,p,11,l[37]),D=e(D,E,B,C,s,16,l[38]),C=e(C,D,E,B,v,23,l[39]),B=e(B,C,D,E,y,4,l[40]),E=e(E,B,C,D,k,11,l[41]),D=e(D,E,B,C,o,16,l[42]),C=e(C,D,E,B,r,23,l[43]),B=e(B,C,D,E,u,4,l[44]),E=e(E,B,C,D,x,11,l[45]),D=e(D,E,B,C,A,16,l[46]),C=e(C,D,E,B,n,23,l[47]),B=f(B,C,D,E,k,6,l[48]),E=f(E,B,C,D,s,10,l[49]),D=f(D,E,B,C,z,15,l[50]),C=f(C,D,E,B,q,21,l[51]),B=f(B,C,D,E,x,6,l[52]),E=f(E,B,C,D,o,10,l[53]),D=f(D,E,B,C,v,15,l[54]),C=f(C,D,E,B,m,21,l[55]),B=f(B,C,D,E,t,6,l[56]),E=f(E,B,C,D,A,10,l[57]),D=f(D,E,B,C,r,15,l[58]),C=f(C,D,E,B,y,21,l[59]),B=f(B,C,D,E,p,6,l[60]),E=f(E,B,C,D,w,10,l[61]),D=f(D,E,B,C,n,15,l[62]),C=f(C,D,E,B,u,21,l[63]),j[0]=j[0]+B|0,j[1]=j[1]+C|0,j[2]=j[2]+D|0,j[3]=j[3]+E|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296),g=d;c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8),b.sigBytes=4*(c.length+1),this._process();for(var h=this._hash,i=h.words,j=0;4>j;j++){var k=i[j];i[j]=16711935&(k<<8|k>>>24)|4278255360&(k<<24|k>>>8)}return h},clone:function(){var a=j.clone.call(this);return a._hash=this._hash.clone(),a}});g.MD5=j._createHelper(m),g.HmacMD5=j._createHmacHelper(m)}(Math)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;/*!
	  * Reqwest! A general purpose XHR connection manager
	  * license MIT (c) Dustin Diaz 2014
	  * https://github.com/ded/reqwest
	  */
!function(a,b,c){"undefined"!=typeof module&&module.exports?module.exports=c():(__WEBPACK_AMD_DEFINE_FACTORY__=c,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}("reqwest",this,function(){function succeed(a){var b=protocolRe.exec(a.url);return b=b&&b[1]||window.location.protocol,httpsRe.test(b)?twoHundo.test(a.request.status):!!a.request.response}function handleReadyState(a,b,c){return function(){return a._aborted?c(a.request):a._timedOut?c(a.request,"Request is aborted: timeout"):void(a.request&&4==a.request[readyState]&&(a.request.onreadystatechange=noop,succeed(a)?b(a.request):c(a.request)))}}function setHeaders(a,b){var c,d=b.headers||{};d.Accept=d.Accept||defaultHeaders.accept[b.type]||defaultHeaders.accept["*"];var e="function"==typeof FormData&&b.data instanceof FormData;b.crossOrigin||d[requestedWith]||(d[requestedWith]=defaultHeaders.requestedWith),d[contentType]||e||(d[contentType]=b.contentType||defaultHeaders.contentType);for(c in d)d.hasOwnProperty(c)&&"setRequestHeader"in a&&a.setRequestHeader(c,d[c])}function setCredentials(a,b){"undefined"!=typeof b.withCredentials&&"undefined"!=typeof a.withCredentials&&(a.withCredentials=!!b.withCredentials)}function generalCallback(a){lastValue=a}function urlappend(a,b){return a+(/\?/.test(a)?"&":"?")+b}function handleJsonp(a,b,c,d){var e=uniqid++,f=a.jsonpCallback||"callback",g=a.jsonpCallbackName||reqwest.getcallbackPrefix(e),h=new RegExp("((^|\\?|&)"+f+")=([^&]+)"),i=d.match(h),j=doc.createElement("script"),k=0,l=-1!==navigator.userAgent.indexOf("MSIE 10.0");return i?"?"===i[3]?d=d.replace(h,"$1="+g):g=i[3]:d=urlappend(d,f+"="+g),win[g]=generalCallback,j.type="text/javascript",j.src=d,j.async=!0,"undefined"==typeof j.onreadystatechange||l||(j.htmlFor=j.id="_reqwest_"+e),j.onload=j.onreadystatechange=function(){return j[readyState]&&"complete"!==j[readyState]&&"loaded"!==j[readyState]||k?!1:(j.onload=j.onreadystatechange=null,j.onclick&&j.onclick(),b(lastValue),lastValue=void 0,head.removeChild(j),void(k=1))},head.appendChild(j),{abort:function(){j.onload=j.onreadystatechange=null,c({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(j),k=1}}}function getRequest(a,b){var c,d=this.o,e=(d.method||"GET").toUpperCase(),f="string"==typeof d?d:d.url,g=d.processData!==!1&&d.data&&"string"!=typeof d.data?reqwest.toQueryString(d.data):d.data||null,h=!1;return"jsonp"!=d.type&&"GET"!=e||!g||(f=urlappend(f,g),g=null),"jsonp"==d.type?handleJsonp(d,a,b,f):(c=d.xhr&&d.xhr(d)||xhr(d),c.open(e,f,d.async===!1?!1:!0),setHeaders(c,d),setCredentials(c,d),win[xDomainRequest]&&c instanceof win[xDomainRequest]?(c.onload=a,c.onerror=b,c.onprogress=function(){},h=!0):c.onreadystatechange=handleReadyState(this,a,b),d.before&&d.before(c),h?setTimeout(function(){c.send(g)},200):c.send(g),c)}function Reqwest(a,b){this.o=a,this.fn=b,init.apply(this,arguments)}function setType(a){return a.match("json")?"json":a.match("javascript")?"js":a.match("text")?"html":a.match("xml")?"xml":void 0}function init(o,fn){function complete(a){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(a)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(a,b,c){for(a=self.request,self._responseArgs.resp=a,self._responseArgs.msg=b,self._responseArgs.t=c,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(a,b,c);complete(a)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(a,b){return new Reqwest(a,b)}function normalize(a){return a?a.replace(/\r?\n/g,"\r\n"):""}function serial(a,b){var c,d,e,f,g=a.name,h=a.tagName.toLowerCase(),i=function(a){a&&!a.disabled&&b(g,normalize(a.attributes.value&&a.attributes.value.specified?a.value:a.text))};if(!a.disabled&&g)switch(h){case"input":/reset|button|image|file/i.test(a.type)||(c=/checkbox/i.test(a.type),d=/radio/i.test(a.type),e=a.value,(!(c||d)||a.checked)&&b(g,normalize(c&&""===e?"on":e)));break;case"textarea":b(g,normalize(a.value));break;case"select":if("select-one"===a.type.toLowerCase())i(a.selectedIndex>=0?a.options[a.selectedIndex]:null);else for(f=0;a.length&&f<a.length;f++)a.options[f].selected&&i(a.options[f])}}function eachFormElement(){var a,b,c=this,d=function(a,b){var d,e,f;for(d=0;d<b.length;d++)for(f=a[byTag](b[d]),e=0;e<f.length;e++)serial(f[e],c)};for(b=0;b<arguments.length;b++)a=arguments[b],/input|select|textarea/i.test(a.tagName)&&serial(a,c),d(a,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var a={};return eachFormElement.apply(function(b,c){b in a?(a[b]&&!isArray(a[b])&&(a[b]=[a[b]]),a[b].push(c)):a[b]=c},arguments),a}function buildParams(a,b,c,d){var e,f,g,h=/\[\]$/;if(isArray(b))for(f=0;b&&f<b.length;f++)g=b[f],c||h.test(a)?d(a,g):buildParams(a+"["+("object"==typeof g?f:"")+"]",g,c,d);else if(b&&"[object Object]"===b.toString())for(e in b)buildParams(a+"["+e+"]",b[e],c,d);else d(a,b)}var win=window,doc=document,httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(a){return a instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(a){if(a.crossOrigin===!0){var b=win[xmlHttpRequest]?new XMLHttpRequest:null;if(b&&"withCredentials"in b)return b;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(a){return a}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(a,b){return a=a||function(){},b=b||function(){},this._fulfilled?this._responseArgs.resp=a(this._responseArgs.resp):this._erred?b(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(a),this._errorHandlers.push(b)),this},always:function(a){return this._fulfilled||this._erred?a(this._responseArgs.resp):this._completeHandlers.push(a),this},fail:function(a){return this._erred?a(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(a),this},"catch":function(a){return this.fail(a)}},reqwest.serializeArray=function(){var a=[];return eachFormElement.apply(function(b,c){a.push({name:b,value:c})},arguments),a},reqwest.serialize=function(){if(0===arguments.length)return"";var a,b,c=Array.prototype.slice.call(arguments,0);return a=c.pop(),a&&a.nodeType&&c.push(a)&&(a=null),a&&(a=a.type),b="map"==a?serializeHash:"array"==a?reqwest.serializeArray:serializeQueryString,b.apply(null,c)},reqwest.toQueryString=function(a,b){var c,d,e=b||!1,f=[],g=encodeURIComponent,h=function(a,b){b="function"==typeof b?b():null==b?"":b,f[f.length]=g(a)+"="+g(b)};if(isArray(a))for(d=0;a&&d<a.length;d++)h(a[d].name,a[d].value);else for(c in a)a.hasOwnProperty(c)&&buildParams(c,a[c],e,h);return f.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(a,b){return a&&(a.type&&(a.method=a.type)&&delete a.type,a.dataType&&(a.type=a.dataType),a.jsonpCallback&&(a.jsonpCallbackName=a.jsonpCallback)&&delete a.jsonpCallback,a.jsonp&&(a.jsonpCallback=a.jsonp)),new Reqwest(a,b)},reqwest.ajaxSetup=function(a){a=a||{};for(var b in a)globalSetupOptions[b]=a[b]},reqwest})},function(a,b){(function(b){a.exports=b}).call(b,{})},function(a){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a,b){"use strict";function c(a){var b=a.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===a[b-2]?2:"="===a[b-1]?1:0}function d(a){return 3*a.length/4-c(a)}function e(a){var b,d,e,f,g,h,i=a.length;g=c(a),h=new k(3*i/4-g),e=g>0?i-4:i;var l=0;for(b=0,d=0;e>b;b+=4,d+=3)f=j[a.charCodeAt(b)]<<18|j[a.charCodeAt(b+1)]<<12|j[a.charCodeAt(b+2)]<<6|j[a.charCodeAt(b+3)],h[l++]=f>>16&255,h[l++]=f>>8&255,h[l++]=255&f;return 2===g?(f=j[a.charCodeAt(b)]<<2|j[a.charCodeAt(b+1)]>>4,h[l++]=255&f):1===g&&(f=j[a.charCodeAt(b)]<<10|j[a.charCodeAt(b+1)]<<4|j[a.charCodeAt(b+2)]>>2,h[l++]=f>>8&255,h[l++]=255&f),h}function f(a){return i[a>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]}function g(a,b,c){for(var d,e=[],g=b;c>g;g+=3)d=(a[g]<<16)+(a[g+1]<<8)+a[g+2],e.push(f(d));return e.join("")}function h(a){for(var b,c=a.length,d=c%3,e="",f=[],h=16383,j=0,k=c-d;k>j;j+=h)f.push(g(a,j,j+h>k?k:j+h));return 1===d?(b=a[c-1],e+=i[b>>2],e+=i[b<<4&63],e+="=="):2===d&&(b=(a[c-2]<<8)+a[c-1],e+=i[b>>10],e+=i[b>>4&63],e+=i[b<<2&63],e+="="),f.push(e),f.join("")}b.byteLength=d,b.toByteArray=e,b.fromByteArray=h;for(var i=[],j=[],k="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,n=l.length;n>m;++m)i[m]=l[m],j[l.charCodeAt(m)]=m;j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63},function(a,b){b.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?0/0:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},b.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},function(a){var b={}.toString;a.exports=Array.isArray||function(a){return"[object Array]"==b.call(a)}},function(a,b,c){a.exports=c(13)},function(a){a.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},function(a,b,c){a.exports=c(136)},function(a,b,c){(function(d){b=a.exports=c(137),b.Stream=c(28),b.Readable=b,b.Writable=c(98),b.Duplex=c(13),b.Transform=c(97),b.PassThrough=c(136),d.browser||"disable"!==d.env.READABLE_STREAM||(a.exports=c(28))}).call(b,c(7))},function(a,b,c){a.exports=c(97)},function(a,b,c){a.exports=c(98)},27,27,function(a){a.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},function(a,b,c){function d(a){return c(e(a))}function e(a){return f[a]||function(){throw new Error("Cannot find module '"+a+"'.")}()}var f={"./AutoQueue":45,"./AutoQueue.ts":45,"./Everlive":30,"./Everlive.ts":30,"./EverliveError":3,"./EverliveError.ts":3,"./ExpandProcessor":46,"./ExpandProcessor.ts":46,"./Expression":19,"./Expression.ts":19,"./GeoPoint":31,"./GeoPoint.ts":31,"./Push":47,"./Push.ts":47,"./Request":10,"./Request.ts":10,"./Setup":48,"./Setup.ts":48,"./auth/Authentication":49,"./auth/Authentication.ts":49,"./auth/AuthenticationSetup":50,"./auth/AuthenticationSetup.ts":50,"./business-logic/BusinessLogic":51,"./business-logic/BusinessLogic.ts":51,"./caching/CacheModule":52,"./caching/CacheModule.ts":52,"./caching/caching":53,"./caching/caching.ts":53,"./constants":2,"./constants.ts":2,"./dataQuery/DataQuery":14,"./dataQuery/DataQuery.ts":14,"./dataQuery/DataQueryBuilder":54,"./dataQuery/DataQueryBuilder.ts":54,"./docs/callbacks":106,"./docs/callbacks.ts":106,"./docs/resultTypes":107,"./docs/resultTypes.ts":107,"./encryption/CryptographicProvider":55,"./encryption/CryptographicProvider.ts":55,"./helpers/helpers":56,"./helpers/helpers.ts":56,"./helpers/html/htmlHelper":57,"./helpers/html/htmlHelper.ts":57,"./helpers/html/htmlHelperOfflineModule":58,"./helpers/html/htmlHelperOfflineModule.ts":58,"./helpers/html/htmlHelperResponsiveModule":59,"./helpers/html/htmlHelperResponsiveModule.ts":59,"./index":60,"./index.ts":60,"./interfaces/AuthInfoResult":108,"./interfaces/AuthInfoResult.ts":108,"./interfaces/CloudFunctionInvocationParameters":109,"./interfaces/CloudFunctionInvocationParameters.ts":109,"./interfaces/CordovaFileEntry":110,"./interfaces/CordovaFileEntry.ts":110,"./interfaces/CordovaFileUploadOptions":111,"./interfaces/CordovaFileUploadOptions.ts":111,"./interfaces/CreateItemResult":112,"./interfaces/CreateItemResult.ts":112,"./interfaces/ErrorCallback":113,"./interfaces/ErrorCallback.ts":113,"./interfaces/File":114,"./interfaces/File.ts":114,"./interfaces/FileContent":115,"./interfaces/FileContent.ts":115,"./interfaces/Item":116,"./interfaces/Item.ts":116,"./interfaces/MultipleResult":117,"./interfaces/MultipleResult.ts":117,"./interfaces/RequestOptions":118,"./interfaces/RequestOptions.ts":118,"./interfaces/SQLiteStore":119,"./interfaces/SQLiteStore.ts":119,"./interfaces/SaveItemResult":120,"./interfaces/SaveItemResult.ts":120,"./interfaces/SetUserPasswordByResetCodePayload":121,"./interfaces/SetUserPasswordByResetCodePayload.ts":121,"./interfaces/SetUserPasswordBySecretAnswerPayload":122,"./interfaces/SetUserPasswordBySecretAnswerPayload.ts":122,"./interfaces/SingleResult":123,"./interfaces/SingleResult.ts":123,"./interfaces/SocialLoginResult":124,"./interfaces/SocialLoginResult.ts":124,"./interfaces/SuccessCallback":125,"./interfaces/SuccessCallback.ts":125,"./interfaces/UpdateItemResult":126,"./interfaces/UpdateItemResult.ts":126,"./interfaces/User":127,"./interfaces/User.ts":127,"./interfaces/UserInfo":128,"./interfaces/UserInfo.ts":128,"./interfaces/UserLoginResult":129,"./interfaces/UserLoginResult.ts":129,"./interfaces/UserSocialIdentity":130,"./interfaces/UserSocialIdentity.ts":130,"./kendo/kendo.everlive":61,"./kendo/kendo.everlive.ts":61,"./offline/OfflineFilesModule":62,"./offline/OfflineFilesModule.ts":62,"./offline/OfflineFilesProcessor":63,"./offline/OfflineFilesProcessor.ts":63,"./offline/OfflineStorageModule":64,"./offline/OfflineStorageModule.ts":64,"./offline/offline":32,"./offline/offline.ts":32,"./offline/offlinePersisters":20,"./offline/offlinePersisters.ts":20,"./offline/offlineTransformations":15,"./offline/offlineTransformations.ts":15,"./offline/persisters/BasePersister":16,"./offline/persisters/BasePersister.ts":16,"./offline/persisters/FileSystemPersister":65,"./offline/persisters/FileSystemPersister.ts":65,"./offline/persisters/LocalStoragePersister":66,"./offline/persisters/LocalStoragePersister.ts":66,"./offline/persisters/Persister":131,"./offline/persisters/Persister.ts":131,"./offline/persisters/SQLitePersister":67,"./offline/persisters/SQLitePersister.ts":67,"./offline/persisters/sqlite/FieldDefinition":68,"./offline/persisters/sqlite/FieldDefinition.ts":68,"./offline/persisters/sqlite/SystemDefinitions":69,"./offline/persisters/sqlite/SystemDefinitions.ts":69,"./offline/processors/OfflineInMemoryQueryProcessor":70,"./offline/processors/OfflineInMemoryQueryProcessor.ts":70,"./offline/processors/OfflineQueryProcessor":33,"./offline/processors/OfflineQueryProcessor.ts":33,"./offline/processors/OfflineSQLiteQueryProcessor":71,"./offline/processors/OfflineSQLiteQueryProcessor.ts":71,"./push/CordovaCurrentDevice":34,"./push/CordovaCurrentDevice.ts":34,"./push/CurrentDevice":72,"./push/CurrentDevice.ts":72,"./push/NativeScriptCurrentDevice":35,"./push/NativeScriptCurrentDevice.ts":35,"./query/AggregateQuery":21,"./query/AggregateQuery.ts":21,"./query/EventQuery":73,"./query/EventQuery.ts":73,"./query/Query":6,"./query/Query.ts":6,"./query/QueryBuilder":22,"./query/QueryBuilder.ts":22,"./query/RequestOptionsBuilder":36,"./query/RequestOptionsBuilder.ts":36,"./query/WhereQuery":74,"./query/WhereQuery.ts":74,"./reqwest.everlive":23,"./reqwest.everlive.ts":23,"./reqwest.nativescript":75,"./reqwest.nativescript.ts":75,"./reqwest.nodejs":76,"./reqwest.nodejs.ts":76,"./response/ResponseParserProcessor":77,"./response/ResponseParserProcessor.ts":77,"./response/ResponseTransformProcessor":78,"./response/ResponseTransformProcessor.ts":78,"./services/RequestService":11,"./services/RequestService.ts":11,"./storages/CordovaSQLiteStore":79,"./storages/CordovaSQLiteStore.ts":79,"./storages/FileStore":37,"./storages/FileStore.ts":37,"./storages/LocalStore":38,"./storages/LocalStore.ts":38,"./storages/NativeScriptFileStore":80,"./storages/NativeScriptFileStore.ts":80,"./storages/NativeScriptSQLiteStore":81,"./storages/NativeScriptSQLiteStore.ts":81,"./storages/SQLiteStore":39,"./storages/SQLiteStore.ts":39,"./storages/WebFileStore":82,"./storages/WebFileStore.ts":82,"./types/Data":17,"./types/Data.ts":17,"./types/Files":83,"./types/Files.ts":83,"./types/Users":84,"./types/Users.ts":84,"./types/preProcessors/DataPreprocessor":85,"./types/preProcessors/DataPreprocessor.ts":85,"./types/preProcessors/OfflineQueryPreprocessor":86,"./types/preProcessors/OfflineQueryPreprocessor.ts":86,"./types/processors/AuthenticationProcessor":87,"./types/processors/AuthenticationProcessor.ts":87,"./types/processors/BusinessLogicQueryProcessor":88,"./types/processors/BusinessLogicQueryProcessor.ts":88,"./types/processors/CacheQueryProcessor":89,"./types/processors/CacheQueryProcessor.ts":89,"./types/processors/EventQueryProcessor":90,"./types/processors/EventQueryProcessor.ts":90,"./types/processors/OfflineQueryProcessor":91,"./types/processors/OfflineQueryProcessor.ts":91,"./types/processors/OnlineQueryProcessor":92,"./types/processors/OnlineQueryProcessor.ts":92,"./utils":4,"./utils.ts":4};d.keys=function(){return Object.keys(f)},d.resolve=e,a.exports=d,d.id=206},function(a){"use strict";function b(a){var b;if(a.hasOwnProperty("count"))b={$sum:1};else if(a.min)b={$min:"$"+a.min};else if(a.max)b={$max:"$"+a.max};else if(a.avg)b={$avg:"$"+a.avg};else{if(!a.sum)throw new Error("The aggregating function was not recognized or is not supported: "+JSON.stringify(a));b={$sum:"$"+a.sum}}return b}function c(a,b,c){b[a]="$"+a,c[a]="$_id."+a}var d={};d.translate=function(a,d){var e,f,g;d=d||{},a.Filter&&(e=a.Filter);var h,i=a.GroupBy;if(i)if(g={_id:0},h={},Array.isArray(i))for(var j=i,k=0;k<j.length;k++){var l=j[k];c(l,h,g)}else{var l=i;c(l,h,g)}else h=null,g={_id:0};f={_id:h};var a=a.Aggregate;if(a)for(var m in a)if(a.hasOwnProperty(m)){var n=a[m];f[m]=b(n),g[m]=1}var o=[];return e&&o.push({$match:e}),d.maxDocumentsCount&&o.push({$limit:d.maxDocumentsCount}),f&&o.push({$group:f}),g&&o.push({$project:g}),o},a.exports=d},function(a,b,c){"use strict";var d=c(41),e=function(a,b){var c="";a&&(c=a.path),this.parent=c,this.relations=[b.path],this.name=b.path,this.targetTypeName=b.targetTypeName,this.canAddOtherRelations=!(b.filterExpression||b.sortExpression||b.aggregateExpression||b.take||b.skip),this.children=[];var d="";c&&(d+=c+"."),d+=b.targetTypeName,this.path=d};e.prototype._insertRelationNode=function(a){this.relations.push(a.path)},e.prototype._insertChildNode=function(a){this.children.push(a.name)},e.prototype.canCombineWithRelation=function(a){return this.canAddOtherRelations?!(this.targetTypeName!==a.targetTypeName||a.filterExpression||a.sortExpression||a.aggregateExpression||a.take||a.skip):!1};var f=function(a){this._relationTree=a,this._map={}};f.prototype.addExecutionNode=function(a){this._map[a.name]=a},f.prototype.getExecutionNodeOfRelation=function(a){for(var b in this._map)if(this._map.hasOwnProperty(b)&&this._map[b].relations.indexOf(a)>-1)return this._map[b];return null},f.prototype.getRelationTree=function(){return this._relationTree},f.prototype.getRelationNode=function(a){return a?this._relationTree.map[a]||null:null},f.prototype.getRootRelationNode=function(){return this._relationTree.map[this._relationTree.map.$root]||null},f.prototype.getRootNode=function(){var a=this._map,b=null;for(var c in a)if(a.hasOwnProperty(c)&&""===a[c].parent){b=a[c];break}return b},f.prototype.getNode=function(a){return this._map[a]},f.prototype.build=function(){var a=this.getRelationNode(this._relationTree.map.$root),b=new e(null,a);this.addExecutionNode(b),this.buildInternal(a)},f.prototype.buildInternal=function(a){a.children.forEach(function(a){var b=this.getRelationNode(a);this.insertRelationNodeInExecutionTree(b),this.buildInternal(b)},this)},f.prototype.insertRelationNodeInExecutionTree=function(a){var b=this.getExecutionNodeOfRelation(a.parentPath),c=this.tryGetChildNodeToCombine(b,a);if(c)c._insertRelationNode(a);else{var d=new e(b,a);b._insertChildNode(d),this.addExecutionNode(d)}},f.prototype.tryGetChildNodeToCombine=function(a,b){if(a.canCombineWithRelation(b))return a;for(var c=a.children,d=0;d<c.length;d++){var e=this._map[c[d]],f=this.tryGetChildNodeToCombine(e,b);if(f)return f}return null},f.prototype.getFilterFromExecutionNode=function(a,b){for(var c={},d=[],e=0;e<a.relations.length;e++){var f=this.getFilterFromSingleRelation(this._relationTree.map[a.relations[e]],b);f&&d.push(f)}return d.length>1?c.$or=d:c=d.length>0?d[0]:null,c},f.prototype.getFilterFromSingleRelation=function(a,b){var c=a.filterExpression,e={},f=this.getRelationFieldValues(a,b),g=a.isInvertedRelation?a.relationField:d.IdFieldNameClient;if(!(f.length>0))return null;if(e[g]={$in:f},void 0!==c){var h=[];return h.push(e),h.push(c),{$and:h}}return e},f.prototype.getRelationFieldValues=function(a,b){var c=[],d=this._relationTree.map[a.parentPath],e=Array.isArray(d.result)?d.result:[d.result];if(a.isInvertedRelation)for(var f=0;f<e.length;f++)c.push(e[f][a.parentRelationField]);else if(d&&d.result){a.parentRelationIds=a.parentRelationIds||{};for(var g=0;g<e.length;g++){var h=e[g],i=h[a.relationField];if(Array.isArray(i)){if(a.hasArrayValues=!0,b)for(var j=0;j<i.length;j++){var k=i[j];void 0!==k&&null!==k&&(c.push(k),a.parentRelationIds[k]=1)}}else void 0!==i&&null!==i&&(c.push(i),a.parentRelationIds[i]=1)}}return c},a.exports=f},function(a,b,c){"use strict";function d(a){this._executionNodeFunction=a.executionNodeFunction,this._metadataProviderFunction=a.metadataProviderFunction}var e=c(101),f=c(211),g=c(208),h=c(41),i=c(100);d.prototype._createExecuteNodeExecutor=function(a,b,c,d){var g=this;return function(h){var j=b.getRelationNode(c.relations[0]),k=b.getRelationNode(j.parentPath),l=!(k.parentPath&&k.hasArrayValues),m=b.getFilterFromExecutionNode(c,l),n=f.validateSingleRelation(j);if(n)return h(new i(n));var o={};o.select=j.fieldsExpression,o.sort=j.sortExpression,o.skip=j.skip,o.take=j.take,o.filter=m,o.targetTypeName=j.targetTypeName,o.returnItemsCount=j.returnItemsCount,o.aggregate=j.aggregateExpression,g._executionNodeFunction.call(null,o,d,function(f,i){if(f)return h(f);for(var j,k=0;k<c.relations.length;k++)j=b.getRelationNode(c.relations[k]),j.result=g._extractResultForRelation(j,i);c.result=j.result;for(var l=[],m=0;m<c.children.length;m++){var n=b._map;l.push(g._createExecuteNodeExecutor(a,b,n[c.children[m]],d))}e.parallel(l,h)})}},d.prototype._getSingleResult=function(a,b,c,d){if(!c)return null;var e,f;if(b.singleFieldName)return b.children&&b.children.length>0?(e=a[b.children[0]],f=this._getObjectByIdFromArray(e.result,c[b.singleFieldName]),this._getSingleResult(a,e,f,0)):c[b.singleFieldName];var g={},h={};if(b.children&&b.children.length>0)for(var i=0;i<b.children.length;i++){e=a[b.children[i]];var j=e.relationField,k=e.userDefinedName;e.isInvertedRelation||j!==k||(h[j]=1);var l=e.result;if(e.isInvertedRelation)if(e.aggregateExpression)g[k]=l[d];else if(e.returnItemsCount)g[k]=l;else for(var m=0;m<l.length;m++){var n=this._getSingleResult(a,e,l[m],m);n&&(g[k]=g[k]||[],Array.isArray(b.result)?n[e.relationField]===c.Id&&g[k].push(n):g[k].push(n))}else if(g[k]=e.isArray()?[]:null,c[j])if(Array.isArray(c[j]))if(e.aggregateExpression)g[k]=l[d];else if(e.sortExpression)for(var o=0;o<l.length;o++)c[j].indexOf(l[o].Id)>-1&&(f=l[o],this._addSingleResultToParentArray(a,e,f,g,k));else for(var p=0;p<c[j].length;p++)f=this._getObjectByIdFromArray(l,c[j][p]),this._addSingleResultToParentArray(a,e,f,g,k);else f=this._getObjectByIdFromArray(l,c[j]),g[k]=this._getSingleResult(a,e,f,0)}for(var q in c)if(c.hasOwnProperty(q)){var r=!h[q]&&this._fieldExistInFieldsExpression(q,b.originalFieldsExpression);r&&(g[q]=c[q])}return g},d.prototype._addSingleResultToParentArray=function(a,b,c,d,e){var f=this._getSingleResult(a,b,c,0);d[e]=d[e]||[],f&&d[e].push(f)},d.prototype._fieldExistInFieldsExpression=function(a,b){if(void 0===b||0===Object.keys(b).length)return!0;if(a===h.IdFieldNameClient)return void 0===b[a]?!0:b[a];var c=f.getIsFieldsExpressionExclusive(b);return void 0===c?!0:c?!b.hasOwnProperty(a):b.hasOwnProperty(a)},d.prototype._extractResultForRelation=function(a,b){if(a.returnItemsCount||a.aggregateExpression)return b;for(var c=[],d=0;d<b.length;d++)a.parentRelationIds&&a.parentRelationIds.hasOwnProperty(b[d].Id)&&c.push(b[d]),a.isInvertedRelation&&c.push(b[d]);return c},d.prototype._getObjectByIdFromArray=function(a,b){if(a)for(var c=0;c<a.length;c++)if(a[c].Id===b)return a[c];return null},d.prototype.prepare=function(a,b,c,d,e,g,h){var i=new f(a,b,c,d,e,this._metadataProviderFunction,g);i.build(function(a,b){var c;if(b){c=b[b.$root].fieldsExpression;var d={relationsTree:i,mainQueryFieldsExpression:c}}h(a,d)})},d.prototype.expand=function(a,b,c,d){var h=a.map,j=this,k=new g(a);k.build(),h[h.$root].result=b;var l=(k._map,k.getRootNode());if(l){var m=this._getExecutionList(k,l,c),n=25;m.length>n&&d(new i("Expand expression results in more than "+n+" inner queries!")),e.forEachSeries(m,function(b,d){var e=b.executeOptions,g=b.relationNode;j._adjustFilterForExecuteDefinition(k,b);var h=f.validateSingleRelation(g,a);return h?d(new i(h)):void j._executionNodeFunction.call(null,e,c,function(a,c){if(a)return d(a);var e;if(b.dataItem)e=j._extractResultForRelation(g,c),g.result||(g.result=[]),g.result.push(e);else{for(var f,h=b.executionNode,i=0;i<h.relations.length;i++)f=k.getRelationNode(h.relations[i]),f.result=j._extractResultForRelation(f,c);h.result=f.result}d()})},function(a){if(a)d(a);else{var c,e=h[h.$root];if(Array.isArray(b)){c=[];for(var f=0;f<b.length;f++){var g=j._getSingleResult(h,e,b[f],f);g&&c.push(g)}}else c=j._getSingleResult(h,e,b,0);d(null,c)}})}},d.prototype._getExecutionList=function(a,b,c){for(var d=a.getRelationTree(),e=a.getRelationNode(b.name),f=e.result,g=[],h=0;h<b.children.length;h++){var i,j=b.children[h],k=a.getNode(j),l=a.getRelationNode(j);if(l.aggregateExpression){var f=f;Array.isArray(f)||(f=[f]);for(var m=0;m<f.length;m++)i=this._getExecuteDefinitionForItem(f[m],l,d,c),g.push(i)}else i=this._getExecuteDefinitionForNode(a,k,c),g.push(i);var n=this._getExecutionList(a,k,c);g=g.concat(n)}return g},d.prototype._adjustFilterForExecuteDefinition=function(a,b){var c,d=b.relationNode;if(b.dataItem)c=this._getFilterFromSingleItem(b.dataItem,d);else{var e=b.executionNode,f=a.getRelationNode(d.parentPath),g=!(f.parentPath&&f.hasArrayValues);c=a.getFilterFromExecutionNode(e,g)}b.executeOptions.filter=c},d.prototype._getExecuteDefinitionForItem=function(a,b){var c={};return c.select=b.fieldsExpression,c.sort=b.sortExpression,c.skip=b.skip,c.take=b.take,c.targetTypeName=b.targetTypeName,c.returnItemsCount=b.returnItemsCount,c.aggregate=b.aggregateExpression,{executeOptions:c,relationNode:b,dataItem:a}},d.prototype._getExecuteDefinitionForNode=function(a,b){var c=a.getRelationNode(b.relations[0]),d={};return d.select=c.fieldsExpression,d.sort=c.sortExpression,d.skip=c.skip,d.take=c.take,d.targetTypeName=c.targetTypeName,d.returnItemsCount=c.returnItemsCount,d.aggregate=c.aggregateExpression,{executeOptions:d,relationNode:c,executionNode:b}},d.prototype._getFilterFromSingleItem=function(a,b){var c,d=b.filterExpression,e=b.relationField;if(b.isInvertedRelation)c={},c[b.relationField]=a.Id;else{var f=a[e];f&&(c=Array.isArray(f)?{Id:{$in:f}}:{Id:f})}return c&&d?{$and:[c,d]}:c?c:d?d:null},d.Constants=h,a.exports=d},function(a,b,c){"use strict";function d(a){this.parentPath=a.parent,this.relationField=a.relationField,this.path=a.path||a.parent+"."+a.relationField,this.fieldsExpression=a.fieldsExpression||{},this.targetTypeName=a.targetTypeName,this.children=[],this.isInvertedRelation=a.isInvertedRelation,this.isArrayRoot=a.isArrayRoot,this.hasArrayValues=!1;var b=a.expandExpression||{};this.parentRelationField=b[e.ParentRelationFieldName]||e.IdFieldNameClient;var c=this.isInvertedRelation?this.path:this.relationField;this.userDefinedName=b[e.ReturnAsFieldName]||c,f.extend(this.fieldsExpression,b[e.FieldsExpressionName]),this.originalFieldsExpression={},f.extend(this.originalFieldsExpression,this.fieldsExpression),this.singleFieldName=b[e.SingleFieldExpressionName],this.filterExpression=b[e.FilterExpressionName],this.sortExpression=b[e.SortExpressionName],this.skip=b[e.SkipExpressionName],this.take=this._getTakeLimit(b[e.TakeExpressionName],a.maxTakeValue),this.returnItemsCount=b[e.ReturnItemsCountFieldName],this.aggregateExpression=b[e.AggregateExpressionFieldName]}var e=c(41),f=c(1),g=c(100);d.prototype._getTakeLimit=function(a,b){if(b=b||e.DefaultTakeItemsCount,a){if(a>b)throw new g("The maximum allowed take value when expanding relations is "+b+"!");return a}return b},d.prototype.setIsArrayFromMetadata=function(){this.isArrayFromMetadata=!0},d.prototype.isArray=function(){return this.isArrayFromMetadata||this.isInvertedRelation||this.hasArrayValues},d.createInverted=function(a,b,c,e){var f=a.split("."),g=f[0],h=f[1];return d._create(a,g,h,c,e,b,!0)},d.createRegular=function(a,b,c,f){var g=c+"."+a,h=b[e.TargetTypeNameFieldName];return d._create(g,h,a,c,f,b,!1)},d._create=function(a,b,c,e,f,g,h){var i={};return i.parent=e,i.path=a,i.maxTakeValue=f,i.validated=!1,i.expandExpression=g,i.relationField=c,i.targetTypeName=b,i.isInvertedRelation=h,new d(i)},a.exports=d},function(a,b,c){"use strict";var d=c(210),e=c(1),f=c(41),g=c(100),h=[f.ExpandExpressionName,f.ReturnAsFieldName,f.FieldsExpressionName,f.SingleFieldExpressionName,f.SortExpressionName,f.FilterExpressionName,f.SkipExpressionName,f.TakeExpressionName,f.ParentRelationFieldName,f.TargetTypeNameFieldName,f.ReturnItemsCountFieldName,f.AggregateExpressionFieldName],i=function(a,b,c,f,g,h,i){
this.maxTakeValue=g,this._metadataProviderFunction=h,this.context=i,this.expandExpression=this._processExpandExpression(a),this.map={},this.map[b]=new d({targetTypeName:b,isArrayRoot:c,fieldsExpression:f,validated:!0,path:b,maxTakeValue:g}),this.map[b].originalFieldsExpression={},e.extend(this.map[b].originalFieldsExpression,f),this.map.$root=b};i.prototype._processExpandExpression=function(a){for(var b in a)if(a.hasOwnProperty(b)&&("boolean"==typeof a[b]&&(a[b]={},a[b][f.ReturnAsFieldName]=b),"string"==typeof a[b])){var c=a[b];a[b]={},a[b][f.ReturnAsFieldName]=c}return a},i.prototype.build=function(a){try{this.buildMapInternal(this.expandExpression,this.map.$root)}catch(b){return a(b)}var d=this;c(101).series([this.configureRelationTree.bind(this),this.validateRelationTree.bind(this)],function(b){a(b,d.map)})},i.prototype.buildMapInternal=function(a,b){for(var c in a)if(a.hasOwnProperty(c)){var e=a[c];for(var j in e)if(e.hasOwnProperty(j)&&-1===h.indexOf(j))throw new g('"'+j+'" is not a valid option for Expand expression');if(c.indexOf(".")>-1){var k=d.createInverted(c,e,b,this.maxTakeValue);if(this.map[k.path]=k,this.map[b].children.push(k.path),i.addFieldToFieldsExpression(this.map[k.parentPath].originalFieldsExpression,k.userDefinedName),a[c][f.ExpandExpressionName]){var l=this._processExpandExpression(a[c][f.ExpandExpressionName]);this.buildMapInternal(l,k.path)}}else{var m=d.createRegular(c,e,b,this.maxTakeValue);if(this.map[m.path]=m,this.map[b].children.push(m.path),e.hasOwnProperty(f.ExpandExpressionName)){if("object"!=typeof e[f.ExpandExpressionName])throw new g(m.path+".Expand must be a valid expand expression!");this.buildMapInternal(this._processExpandExpression(e.Expand),m.path)}}}},i.prototype.configureRelationTree=function(a){if(!this._metadataProviderFunction)return a();var b=[];for(var c in this.map)this.map.hasOwnProperty(c)&&null!==this.map[c].parentPath&&b.push(this.map[c].relationField);this._metadataProviderFunction(b,this.map,this.context,function(b){a(b)})},i.prototype.validateRelationTree=function(a){var b="",c="\r\n";for(var d in this.map)if("$root"!==d&&this.map.hasOwnProperty(d)){var e=this.map[d];b+=i.validateSingleRelation(e,this),this.configureFieldsExpressionsForRelation(e)}if(""!==b){var f=b.substr(0,b.lastIndexOf(c)),h=new g(f);return a(h)}a()},i.prototype.configureFieldsExpressionsForRelation=function(a){if(a.parentPath){var b=this.map[a.parentPath].fieldsExpression;a.isInvertedRelation?i.addFieldToFieldsExpression(b,a.parentRelationField):i.addFieldToFieldsExpression(b,a.relationField)}a.isInvertedRelation?i.addFieldToFieldsExpression(a.fieldsExpression,a.relationField):i.addFieldToFieldsExpression(a.fieldsExpression,f.IdFieldNameClient),i.adjustParentRelationFieldsExpression(this.map[a.parentPath],a)},i.validateSingleRelation=function(a,b){var c="",d=b.map,e=d[d.$root],f="\r\n",g=e.isArrayRoot;if(a.path===a.parentPath)return c+=a.path+" has same parent which will cause an infinite loop."+f;if(a.isArray()){var h=i._getParentMultipleRelationsCount(a,b);h>0&&(c+='Expand expression has multiple relation "'+a.path+'" inside a multiple relation.',c+=f),d[a.parentPath]===e&&g&&(a.filterExpression||a.sortExpression)&&(c+="Filter and Sort are not allowed when expanding multiple items.",c+=f),d[a.parentPath]===e&&g&&a.isInvertedRelation&&a.skip&&(c+="Skip and Take are not supported when expanding multiple items with external relation.",c+=f)}return a.targetTypeName||(c+='Expanding relation "'+a.relationField+'" has no target type name specified. You should use "TargetTypeName" to specify it.',c+=f),a.fieldsExpression&&Object.keys(a.fieldsExpression).length&&a.singleFieldName&&(c+=a.path+" ",c+='expand expression contains both "Fields" and "SingleField" expressions.',c+=f),a.singleFieldName&&a.children&&(a.children.length>1&&(c+=a.path+" has multiple expand expressions with a single field option."+f),1===a.children.length&&d[a.children[0]].relationField!==a.singleFieldName&&(c+="Expand expression "+a.path,c+=' single field "'+a.singleFieldName+'"',c+=' does not match child relation field "'+d[a.children[0]].relationField+'".',c+=f)),c},i._getParentMultipleRelationsCount=function(a,b){for(var c=0,d=a;d.parentPath;){var e=b.map[d.parentPath];e.isArray()&&e.parentPath&&(c+=1),d=e}return c},i.adjustParentRelationFieldsExpression=function(a,b){if(!b.isInvertedRelation&&b.take&&"number"==typeof b.take){var c=b.isArray()&&!b.filterExpression&&!b.sortExpression&&a;c&&(void 0===a.fieldsExpression&&(a.fieldsExpression={}),a.fieldsExpression[b.relationField]=b.skip&&"number"==typeof b.skip?{$slice:[b.skip,b.take]}:{$slice:b.take},b.take=null,b.skip=null,b.movedSkipTakeAsSlice=!0)}},i.addFieldToFieldsExpression=function(a,b){if(void 0!==a&&0!==Object.keys(a).length){var c=i.getIsFieldsExpressionExclusive(a);void 0!==c&&(c?delete a[b]:a[b]=1)}},i.getIsFieldsExpressionExclusive=function(a){var b;for(var c in a)if(c!==f.IdFieldNameClient&&a.hasOwnProperty(c)&&void 0===b){if(0===a[c]){b=!0;break}if("object"==typeof a[c])continue;b=!1;break}return b},a.exports=i},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_212__){var b=new Error('Cannot find module "application-settings"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_212__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_213__){var b=new Error('Cannot find module "file-system"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_213__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_214__){var b=new Error('Cannot find module "https"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_214__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_215__){var b=new Error('Cannot find module "local-settings"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_215__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_216__){var b=new Error('Cannot find module "nativescript-push-notifications"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_216__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_217__){var b=new Error('Cannot find module "nativescript-sqlite"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_217__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_218__){var b=new Error('Cannot find module "node-localstorage"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_218__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_219__){var b=new Error('Cannot find module "platform"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_219__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_220__){var b=new Error('Cannot find module "url"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_220__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_221__){var b=new Error('Cannot find module "zlib"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_221__},function(){},222]))});